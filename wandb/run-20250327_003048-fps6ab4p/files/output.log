Estimating norm scaling factor: 100%|██████████| 1000/1000 [00:01<00:00, 524.73it/s]
4700| l0_loss: 11218.29102 | mse_loss: 0.35248:  59%|█████▉    | 2406400/4096000 [02:52<02:00, 14039.40it/s]
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.04048111370645652, 'ce_loss_with_ablation': 7.993437767028809, 'ce_loss_with_sae': 7.76271390914917, 'ce_loss_without_sae': 2.2938945293426514}, 'reconstruction_quality': {'explained_variance': -0.007419086992740631, 'mse': 21.32967185974121, 'cossim': 0.1942630261182785}, 'shrinkage': {'l2_norm_in': 43.947296142578125, 'l2_norm_out': 0.2654120624065399, 'l2_ratio': 0.003630600171163678, 'relative_reconstruction_bias': 0.14311698079109192}, 'sparsity': {'l0': 1584.0330810546875, 'l1': 97.4682388305664}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': -0.1682577644147814, 'ce_loss_with_ablation': 8.472864151000977, 'ce_loss_with_sae': 9.491064071655273, 'ce_loss_without_sae': 2.4214351177215576}, 'reconstruction_quality': {'explained_variance': -0.024597173556685448, 'mse': 20.45318031311035, 'cossim': 0.27990424633026123}, 'shrinkage': {'l2_norm_in': 43.2778205871582, 'l2_norm_out': 0.12227761745452881, 'l2_ratio': 0.0012728696456179023, 'relative_reconstruction_bias': 0.03759811446070671}, 'sparsity': {'l0': 741.7546997070312, 'l1': 49.60039520263672}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.3404674398611836, 'ce_loss_with_ablation': 8.208343505859375, 'ce_loss_with_sae': 6.284494876861572, 'ce_loss_without_sae': 2.5577337741851807}, 'reconstruction_quality': {'explained_variance': -0.01970498636364937, 'mse': 20.321578979492188, 'cossim': 0.28717130422592163}, 'shrinkage': {'l2_norm_in': 43.391605377197266, 'l2_norm_out': 0.16610664129257202, 'l2_ratio': 0.0014314318541437387, 'relative_reconstruction_bias': 0.018427206203341484}, 'sparsity': {'l0': 508.8662109375, 'l1': 100.90214538574219}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5401630464968059, 'ce_loss_with_ablation': 8.418126106262207, 'ce_loss_with_sae': 5.197415351867676, 'ce_loss_without_sae': 2.4556472301483154}, 'reconstruction_quality': {'explained_variance': -0.004727104213088751, 'mse': 20.3415470123291, 'cossim': 0.3985978066921234}, 'shrinkage': {'l2_norm_in': 43.88267135620117, 'l2_norm_out': 0.555336594581604, 'l2_ratio': 0.008533275686204433, 'relative_reconstruction_bias': 0.02833263948559761}, 'sparsity': {'l0': 536.7572631835938, 'l1': 295.7604675292969}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5974917675878084, 'ce_loss_with_ablation': 8.324442863464355, 'ce_loss_with_sae': 4.819227695465088, 'ce_loss_without_sae': 2.457893133163452}, 'reconstruction_quality': {'explained_variance': -0.007249135058373213, 'mse': 19.394824981689453, 'cossim': 0.4614626467227936}, 'shrinkage': {'l2_norm_in': 43.677711486816406, 'l2_norm_out': 0.7424713373184204, 'l2_ratio': 0.012039187364280224, 'relative_reconstruction_bias': 0.03542998433113098}, 'sparsity': {'l0': 567.3933715820312, 'l1': 397.9307861328125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.6983926965807633, 'ce_loss_with_ablation': 8.514806747436523, 'ce_loss_with_sae': 4.290338039398193, 'ce_loss_without_sae': 2.4659624099731445}, 'reconstruction_quality': {'explained_variance': -0.0028861630707979202, 'mse': 19.489261627197266, 'cossim': 0.5147332549095154}, 'shrinkage': {'l2_norm_in': 43.729248046875, 'l2_norm_out': 0.8530916571617126, 'l2_ratio': 0.014631024561822414, 'relative_reconstruction_bias': 0.03685513883829117}, 'sparsity': {'l0': 655.3265991210938, 'l1': 479.3206481933594}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.7586291111153957, 'ce_loss_with_ablation': 8.2409029006958, 'ce_loss_with_sae': 3.8224782943725586, 'ce_loss_without_sae': 2.4166805744171143}, 'reconstruction_quality': {'explained_variance': 0.012976758182048798, 'mse': 20.269500732421875, 'cossim': 0.550226628780365}, 'shrinkage': {'l2_norm_in': 44.08547592163086, 'l2_norm_out': 0.9397884607315063, 'l2_ratio': 0.016556745395064354, 'relative_reconstruction_bias': 0.03757518157362938}, 'sparsity': {'l0': 771.2123413085938, 'l1': 563.0316772460938}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.7955292585559882, 'ce_loss_with_ablation': 8.194169998168945, 'ce_loss_with_sae': 3.6695804595947266, 'ce_loss_without_sae': 2.5066487789154053}, 'reconstruction_quality': {'explained_variance': 0.007125169038772583, 'mse': 19.91489601135254, 'cossim': 0.586574375629425}, 'shrinkage': {'l2_norm_in': 43.867271423339844, 'l2_norm_out': 0.9961153268814087, 'l2_ratio': 0.018367905169725418, 'relative_reconstruction_bias': 0.0380878709256649}, 'sparsity': {'l0': 823.9130859375, 'l1': 625.1331787109375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.826625218428472, 'ce_loss_with_ablation': 8.161482810974121, 'ce_loss_with_sae': 3.528294563293457, 'ce_loss_without_sae': 2.5565385818481445}, 'reconstruction_quality': {'explained_variance': 0.006583719979971647, 'mse': 19.531518936157227, 'cossim': 0.6146200895309448}, 'shrinkage': {'l2_norm_in': 43.576934814453125, 'l2_norm_out': 1.0321725606918335, 'l2_ratio': 0.019470538944005966, 'relative_reconstruction_bias': 0.038777828216552734}, 'sparsity': {'l0': 921.8353881835938, 'l1': 683.1968994140625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.8568140214634676, 'ce_loss_with_ablation': 8.346538543701172, 'ce_loss_with_sae': 3.3085951805114746, 'ce_loss_without_sae': 2.466682195663452}, 'reconstruction_quality': {'explained_variance': 0.020795034244656563, 'mse': 20.290367126464844, 'cossim': 0.6495186686515808}, 'shrinkage': {'l2_norm_in': 44.17072296142578, 'l2_norm_out': 1.100232481956482, 'l2_ratio': 0.02078295312821865, 'relative_reconstruction_bias': 0.0391114316880703}, 'sparsity': {'l0': 1008.5111694335938, 'l1': 766.9798583984375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.8861580408189195, 'ce_loss_with_ablation': 8.018692016601562, 'ce_loss_with_sae': 3.1232404708862305, 'ce_loss_without_sae': 2.4943370819091797}, 'reconstruction_quality': {'explained_variance': 0.025328416377305984, 'mse': 20.496673583984375, 'cossim': 0.6617556214332581}, 'shrinkage': {'l2_norm_in': 44.32414627075195, 'l2_norm_out': 1.1280399560928345, 'l2_ratio': 0.021468600258231163, 'relative_reconstruction_bias': 0.03930802270770073}, 'sparsity': {'l0': 1109.5316162109375, 'l1': 836.2939453125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9060832791044053, 'ce_loss_with_ablation': 8.227436065673828, 'ce_loss_with_sae': 2.9996073246002197, 'ce_loss_without_sae': 2.457736015319824}, 'reconstruction_quality': {'explained_variance': 0.02801520936191082, 'mse': 20.354068756103516, 'cossim': 0.6915745139122009}, 'shrinkage': {'l2_norm_in': 44.182472229003906, 'l2_norm_out': 1.1714719533920288, 'l2_ratio': 0.022831114009022713, 'relative_reconstruction_bias': 0.03935972973704338}, 'sparsity': {'l0': 1188.9967041015625, 'l1': 897.8668823242188}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9308886235321816, 'ce_loss_with_ablation': 8.218037605285645, 'ce_loss_with_sae': 2.448819637298584, 'ce_loss_without_sae': 2.0204992294311523}, 'reconstruction_quality': {'explained_variance': 0.0058340150862932205, 'mse': 18.057266235351562, 'cossim': 0.7226722240447998}, 'shrinkage': {'l2_norm_in': 42.48115158081055, 'l2_norm_out': 1.1624336242675781, 'l2_ratio': 0.02434774674475193, 'relative_reconstruction_bias': 0.0394153855741024}, 'sparsity': {'l0': 1281.584228515625, 'l1': 911.2601928710938}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9412768200866392, 'ce_loss_with_ablation': 7.762081623077393, 'ce_loss_with_sae': 2.5799028873443604, 'ce_loss_without_sae': 2.256603717803955}, 'reconstruction_quality': {'explained_variance': -0.015157053247094154, 'mse': 16.682024002075195, 'cossim': 0.7301527261734009}, 'shrinkage': {'l2_norm_in': 41.11886215209961, 'l2_norm_out': 1.128420114517212, 'l2_ratio': 0.024886643514037132, 'relative_reconstruction_bias': 0.03945283219218254}, 'sparsity': {'l0': 1365.6839599609375, 'l1': 926.1923828125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9475954734416199, 'ce_loss_with_ablation': 7.718745231628418, 'ce_loss_with_sae': 2.5762109756469727, 'ce_loss_without_sae': 2.2918152809143066}, 'reconstruction_quality': {'explained_variance': -0.018858639523386955, 'mse': 16.212873458862305, 'cossim': 0.739311158657074}, 'shrinkage': {'l2_norm_in': 40.893245697021484, 'l2_norm_out': 1.1343071460723877, 'l2_ratio': 0.025293201208114624, 'relative_reconstruction_bias': 0.039519280195236206}, 'sparsity': {'l0': 1436.7685546875, 'l1': 970.5863647460938}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9582158248714197, 'ce_loss_with_ablation': 7.9982428550720215, 'ce_loss_with_sae': 2.5399038791656494, 'ce_loss_without_sae': 2.3018863201141357}, 'reconstruction_quality': {'explained_variance': -0.014155402779579163, 'mse': 16.319475173950195, 'cossim': 0.7583238482475281}, 'shrinkage': {'l2_norm_in': 40.79425048828125, 'l2_norm_out': 1.1660088300704956, 'l2_ratio': 0.026272589340806007, 'relative_reconstruction_bias': 0.03955352306365967}, 'sparsity': {'l0': 1496.2281494140625, 'l1': 1027.879638671875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9531434454538992, 'ce_loss_with_ablation': 7.808859825134277, 'ce_loss_with_sae': 2.6306300163269043, 'ce_loss_without_sae': 2.376068115234375}, 'reconstruction_quality': {'explained_variance': 0.03452520817518234, 'mse': 19.668590545654297, 'cossim': 0.7821595072746277}, 'shrinkage': {'l2_norm_in': 43.972408294677734, 'l2_norm_out': 1.3213385343551636, 'l2_ratio': 0.02729897014796734, 'relative_reconstruction_bias': 0.039586104452610016}, 'sparsity': {'l0': 1597.5140380859375, 'l1': 1192.6900634765625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9501978121340003, 'ce_loss_with_ablation': 8.106575965881348, 'ce_loss_with_sae': 2.353973388671875, 'ce_loss_without_sae': 2.0524654388427734}, 'reconstruction_quality': {'explained_variance': 0.04476221650838852, 'mse': 20.37723731994629, 'cossim': 0.789425790309906}, 'shrinkage': {'l2_norm_in': 44.59519958496094, 'l2_norm_out': 1.3569310903549194, 'l2_ratio': 0.027662698179483414, 'relative_reconstruction_bias': 0.03961915895342827}, 'sparsity': {'l0': 1661.328125, 'l1': 1260.2373046875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9601351942860676, 'ce_loss_with_ablation': 8.093259811401367, 'ce_loss_with_sae': 2.392855405807495, 'ce_loss_without_sae': 2.156174659729004}, 'reconstruction_quality': {'explained_variance': -0.01181934867054224, 'mse': 16.368240356445312, 'cossim': 0.7852908372879028}, 'shrinkage': {'l2_norm_in': 41.030555725097656, 'l2_norm_out': 1.2176803350448608, 'l2_ratio': 0.02765067294239998, 'relative_reconstruction_bias': 0.039596688002347946}, 'sparsity': {'l0': 1715.8387451171875, 'l1': 1200.5064697265625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9631660335998143, 'ce_loss_with_ablation': 7.865519046783447, 'ce_loss_with_sae': 2.515392303466797, 'ce_loss_without_sae': 2.3107895851135254}, 'reconstruction_quality': {'explained_variance': -0.009400795213878155, 'mse': 16.721412658691406, 'cossim': 0.7978007197380066}, 'shrinkage': {'l2_norm_in': 41.04484939575195, 'l2_norm_out': 1.2415310144424438, 'l2_ratio': 0.02825409732758999, 'relative_reconstruction_bias': 0.03957104682922363}, 'sparsity': {'l0': 1803.03515625, 'l1': 1265.0306396484375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9705009266432253, 'ce_loss_with_ablation': 7.900069236755371, 'ce_loss_with_sae': 2.451178550720215, 'ce_loss_without_sae': 2.285555601119995}, 'reconstruction_quality': {'explained_variance': -0.014181616716086864, 'mse': 16.05010986328125, 'cossim': 0.794283390045166}, 'shrinkage': {'l2_norm_in': 40.614837646484375, 'l2_norm_out': 1.2169935703277588, 'l2_ratio': 0.02800193428993225, 'relative_reconstruction_bias': 0.039637740701436996}, 'sparsity': {'l0': 1834.3211669921875, 'l1': 1284.6080322265625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9725236212990482, 'ce_loss_with_ablation': 7.851823806762695, 'ce_loss_with_sae': 2.5407798290252686, 'ce_loss_without_sae': 2.390728712081909}, 'reconstruction_quality': {'explained_variance': -0.00869373045861721, 'mse': 16.202770233154297, 'cossim': 0.8079332709312439}, 'shrinkage': {'l2_norm_in': 40.85794448852539, 'l2_norm_out': 1.2495195865631104, 'l2_ratio': 0.028705427423119545, 'relative_reconstruction_bias': 0.03960816189646721}, 'sparsity': {'l0': 1910.2840576171875, 'l1': 1350.085205078125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9703636134043351, 'ce_loss_with_ablation': 8.002524375915527, 'ce_loss_with_sae': 2.361435651779175, 'ce_loss_without_sae': 2.189148187637329}, 'reconstruction_quality': {'explained_variance': 0.047788314521312714, 'mse': 20.254018783569336, 'cossim': 0.8290104269981384}, 'shrinkage': {'l2_norm_in': 44.59531784057617, 'l2_norm_out': 1.426099181175232, 'l2_ratio': 0.029672497883439064, 'relative_reconstruction_bias': 0.03961425647139549}, 'sparsity': {'l0': 1962.2021484375, 'l1': 1523.8792724609375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.965325578222258, 'ce_loss_with_ablation': 8.148221969604492, 'ce_loss_with_sae': 2.575043201446533, 'ce_loss_without_sae': 2.3748550415039062}, 'reconstruction_quality': {'explained_variance': 0.04551483318209648, 'mse': 20.623920440673828, 'cossim': 0.818682849407196}, 'shrinkage': {'l2_norm_in': 44.28951644897461, 'l2_norm_out': 1.393879771232605, 'l2_ratio': 0.029187453910708427, 'relative_reconstruction_bias': 0.03954045847058296}, 'sparsity': {'l0': 2023.4617919921875, 'l1': 1569.7952880859375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9663119754414472, 'ce_loss_with_ablation': 8.11966323852539, 'ce_loss_with_sae': 2.67290997505188, 'ce_loss_without_sae': 2.483022689819336}, 'reconstruction_quality': {'explained_variance': 0.04646088555455208, 'mse': 20.315614700317383, 'cossim': 0.8178146481513977}, 'shrinkage': {'l2_norm_in': 44.40424346923828, 'l2_norm_out': 1.3960589170455933, 'l2_ratio': 0.029136663302779198, 'relative_reconstruction_bias': 0.03960210829973221}, 'sparsity': {'l0': 2092.0322265625, 'l1': 1610.8909912109375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9619305742876699, 'ce_loss_with_ablation': 8.117958068847656, 'ce_loss_with_sae': 2.667497396469116, 'ce_loss_without_sae': 2.451789617538452}, 'reconstruction_quality': {'explained_variance': 0.040105145424604416, 'mse': 20.124858856201172, 'cossim': 0.8294210433959961}, 'shrinkage': {'l2_norm_in': 43.96875762939453, 'l2_norm_out': 1.4009519815444946, 'l2_ratio': 0.0297305379062891, 'relative_reconstruction_bias': 0.03953307494521141}, 'sparsity': {'l0': 2140.952392578125, 'l1': 1647.2799072265625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9713429673535721, 'ce_loss_with_ablation': 8.239028930664062, 'ce_loss_with_sae': 2.5993692874908447, 'ce_loss_without_sae': 2.432985305786133}, 'reconstruction_quality': {'explained_variance': 0.04233815148472786, 'mse': 20.206253051757812, 'cossim': 0.8314029574394226}, 'shrinkage': {'l2_norm_in': 44.14777374267578, 'l2_norm_out': 1.4095348119735718, 'l2_ratio': 0.02983933500945568, 'relative_reconstruction_bias': 0.03954577445983887}, 'sparsity': {'l0': 2198.354248046875, 'l1': 1700.453369140625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.96644197134114, 'ce_loss_with_ablation': 8.300178527832031, 'ce_loss_with_sae': 2.684274911880493, 'ce_loss_without_sae': 2.489272356033325}, 'reconstruction_quality': {'explained_variance': 0.042297519743442535, 'mse': 20.253076553344727, 'cossim': 0.8377802968025208}, 'shrinkage': {'l2_norm_in': 44.1669921875, 'l2_norm_out': 1.4208439588546753, 'l2_ratio': 0.030142614617943764, 'relative_reconstruction_bias': 0.039531346410512924}, 'sparsity': {'l0': 2255.122802734375, 'l1': 1736.578125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.981482691102099, 'ce_loss_with_ablation': 7.968987464904785, 'ce_loss_with_sae': 2.3696224689483643, 'ce_loss_without_sae': 2.2639811038970947}, 'reconstruction_quality': {'explained_variance': 0.05398617312312126, 'mse': 20.00597381591797, 'cossim': 0.854159951210022}, 'shrinkage': {'l2_norm_in': 44.222328186035156, 'l2_norm_out': 1.4539598226547241, 'l2_ratio': 0.030909204855561256, 'relative_reconstruction_bias': 0.03962025046348572}, 'sparsity': {'l0': 2310.80615234375, 'l1': 1787.890625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9814250772361087, 'ce_loss_with_ablation': 8.015522003173828, 'ce_loss_with_sae': 2.3823931217193604, 'ce_loss_without_sae': 2.275777816772461}, 'reconstruction_quality': {'explained_variance': 0.05652443319559097, 'mse': 20.226327896118164, 'cossim': 0.8628986477851868}, 'shrinkage': {'l2_norm_in': 44.145565032958984, 'l2_norm_out': 1.466511607170105, 'l2_ratio': 0.031289514154195786, 'relative_reconstruction_bias': 0.03961307927966118}, 'sparsity': {'l0': 2349.3525390625, 'l1': 1833.8277587890625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9829145602247334, 'ce_loss_with_ablation': 8.02662181854248, 'ce_loss_with_sae': 2.361967086791992, 'ce_loss_without_sae': 2.2635016441345215}, 'reconstruction_quality': {'explained_variance': 0.04645799845457077, 'mse': 20.23880386352539, 'cossim': 0.8454303741455078}, 'shrinkage': {'l2_norm_in': 44.08870315551758, 'l2_norm_out': 1.4324043989181519, 'l2_ratio': 0.0305193904787302, 'relative_reconstruction_bias': 0.03955404832959175}, 'sparsity': {'l0': 2405.570556640625, 'l1': 1853.3538818359375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9690992984772683, 'ce_loss_with_ablation': 8.207812309265137, 'ce_loss_with_sae': 2.60383939743042, 'ce_loss_without_sae': 2.4251511096954346}, 'reconstruction_quality': {'explained_variance': 0.04476494342088699, 'mse': 20.047727584838867, 'cossim': 0.8412257432937622}, 'shrinkage': {'l2_norm_in': 44.04659652709961, 'l2_norm_out': 1.4238529205322266, 'l2_ratio': 0.030332554131746292, 'relative_reconstruction_bias': 0.03953012451529503}, 'sparsity': {'l0': 2448.54736328125, 'l1': 1879.9495849609375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9742865288535824, 'ce_loss_with_ablation': 7.968865394592285, 'ce_loss_with_sae': 2.572687864303589, 'ce_loss_without_sae': 2.4302713871002197}, 'reconstruction_quality': {'explained_variance': 0.036823879927396774, 'mse': 19.5219669342041, 'cossim': 0.8490545153617859}, 'shrinkage': {'l2_norm_in': 43.6329460144043, 'l2_norm_out': 1.4211472272872925, 'l2_ratio': 0.030693644657731056, 'relative_reconstruction_bias': 0.03953760862350464}, 'sparsity': {'l0': 2485.677490234375, 'l1': 1913.6429443359375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9789495949951366, 'ce_loss_with_ablation': 8.31395149230957, 'ce_loss_with_sae': 2.6258368492126465, 'ce_loss_without_sae': 2.5035250186920166}, 'reconstruction_quality': {'explained_variance': 0.042028408497571945, 'mse': 19.99908447265625, 'cossim': 0.8540846109390259}, 'shrinkage': {'l2_norm_in': 43.941444396972656, 'l2_norm_out': 1.4427076578140259, 'l2_ratio': 0.03096209280192852, 'relative_reconstruction_bias': 0.039563752710819244}, 'sparsity': {'l0': 2537.23388671875, 'l1': 1954.2679443359375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9761897389696853, 'ce_loss_with_ablation': 8.183964729309082, 'ce_loss_with_sae': 2.553953170776367, 'ce_loss_without_sae': 2.4166314601898193}, 'reconstruction_quality': {'explained_variance': 0.042975232005119324, 'mse': 19.89202308654785, 'cossim': 0.8533211946487427}, 'shrinkage': {'l2_norm_in': 44.116085052490234, 'l2_norm_out': 1.4474098682403564, 'l2_ratio': 0.03095744550228119, 'relative_reconstruction_bias': 0.03957011178135872}, 'sparsity': {'l0': 2574.96044921875, 'l1': 1984.2635498046875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9764170136824792, 'ce_loss_with_ablation': 8.27078914642334, 'ce_loss_with_sae': 2.630831718444824, 'ce_loss_without_sae': 2.494612216949463}, 'reconstruction_quality': {'explained_variance': 0.04142996668815613, 'mse': 19.87871742248535, 'cossim': 0.8559888005256653}, 'shrinkage': {'l2_norm_in': 43.91341018676758, 'l2_norm_out': 1.4448360204696655, 'l2_ratio': 0.03109097294509411, 'relative_reconstruction_bias': 0.0395294725894928}, 'sparsity': {'l0': 2614.743408203125, 'l1': 2002.841064453125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9747755733218397, 'ce_loss_with_ablation': 8.307905197143555, 'ce_loss_with_sae': 2.585803270339966, 'ce_loss_without_sae': 2.4377315044403076}, 'reconstruction_quality': {'explained_variance': 0.04097578302025795, 'mse': 19.796558380126953, 'cossim': 0.853868305683136}, 'shrinkage': {'l2_norm_in': 43.9552001953125, 'l2_norm_out': 1.4396847486495972, 'l2_ratio': 0.03094690479338169, 'relative_reconstruction_bias': 0.039538946002721786}, 'sparsity': {'l0': 2652.3212890625, 'l1': 2020.2738037109375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9773194319494503, 'ce_loss_with_ablation': 8.298147201538086, 'ce_loss_with_sae': 2.5951170921325684, 'ce_loss_without_sae': 2.4627673625946045}, 'reconstruction_quality': {'explained_variance': 0.04784170910716057, 'mse': 20.154603958129883, 'cossim': 0.8607279658317566}, 'shrinkage': {'l2_norm_in': 44.16630935668945, 'l2_norm_out': 1.4616420269012451, 'l2_ratio': 0.03129200637340546, 'relative_reconstruction_bias': 0.03956693038344383}, 'sparsity': {'l0': 2679.351806640625, 'l1': 2055.190673828125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9757440493829393, 'ce_loss_with_ablation': 8.28319263458252, 'ce_loss_with_sae': 2.5719869136810303, 'ce_loss_without_sae': 2.4300124645233154}, 'reconstruction_quality': {'explained_variance': 0.04485549405217171, 'mse': 20.113428115844727, 'cossim': 0.8636889457702637}, 'shrinkage': {'l2_norm_in': 43.7884407043457, 'l2_norm_out': 1.455398440361023, 'l2_ratio': 0.03145812079310417, 'relative_reconstruction_bias': 0.039528828114271164}, 'sparsity': {'l0': 2724.725830078125, 'l1': 2080.857421875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9744274574776439, 'ce_loss_with_ablation': 8.250324249267578, 'ce_loss_with_sae': 2.594423294067383, 'ce_loss_without_sae': 2.4459917545318604}, 'reconstruction_quality': {'explained_variance': 0.041704535484313965, 'mse': 19.72897720336914, 'cossim': 0.8589469790458679}, 'shrinkage': {'l2_norm_in': 44.13230514526367, 'l2_norm_out': 1.457290530204773, 'l2_ratio': 0.03127139434218407, 'relative_reconstruction_bias': 0.0395551435649395}, 'sparsity': {'l0': 2768.72998046875, 'l1': 2112.02490234375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9789930603444197, 'ce_loss_with_ablation': 8.394744873046875, 'ce_loss_with_sae': 2.598385810852051, 'ce_loss_without_sae': 2.4740092754364014}, 'reconstruction_quality': {'explained_variance': 0.03991347551345825, 'mse': 19.729856491088867, 'cossim': 0.8629207015037537}, 'shrinkage': {'l2_norm_in': 44.220821380615234, 'l2_norm_out': 1.4659134149551392, 'l2_ratio': 0.0314142070710659, 'relative_reconstruction_bias': 0.03952756151556969}, 'sparsity': {'l0': 2786.08447265625, 'l1': 2127.85595703125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9767977445577822, 'ce_loss_with_ablation': 8.180709838867188, 'ce_loss_with_sae': 2.557995557785034, 'ce_loss_without_sae': 2.4244370460510254}, 'reconstruction_quality': {'explained_variance': 0.0073586017824709415, 'mse': 17.352750778198242, 'cossim': 0.8751760721206665}, 'shrinkage': {'l2_norm_in': 41.53786849975586, 'l2_norm_out': 1.38910710811615, 'l2_ratio': 0.03201617673039436, 'relative_reconstruction_bias': 0.03956758975982666}, 'sparsity': {'l0': 2827.607421875, 'l1': 2092.479736328125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9793494157670869, 'ce_loss_with_ablation': 7.890441417694092, 'ce_loss_with_sae': 2.5035510063171387, 'ce_loss_without_sae': 2.389962911605835}, 'reconstruction_quality': {'explained_variance': 0.0036714524030685425, 'mse': 16.633195877075195, 'cossim': 0.8774296045303345}, 'shrinkage': {'l2_norm_in': 41.24538803100586, 'l2_norm_out': 1.3830143213272095, 'l2_ratio': 0.03212662786245346, 'relative_reconstruction_bias': 0.03960145264863968}, 'sparsity': {'l0': 2837.05712890625, 'l1': 2090.04296875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9757114748957468, 'ce_loss_with_ablation': 7.853931427001953, 'ce_loss_with_sae': 2.4416797161102295, 'ce_loss_without_sae': 2.3069517612457275}, 'reconstruction_quality': {'explained_variance': 0.001134852645918727, 'mse': 16.139476776123047, 'cossim': 0.874106228351593}, 'shrinkage': {'l2_norm_in': 40.774288177490234, 'l2_norm_out': 1.3595033884048462, 'l2_ratio': 0.031945016235113144, 'relative_reconstruction_bias': 0.03961293399333954}, 'sparsity': {'l0': 2873.10888671875, 'l1': 2088.12109375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9799337516114303, 'ce_loss_with_ablation': 7.938239097595215, 'ce_loss_with_sae': 2.3816604614257812, 'ce_loss_without_sae': 2.2678775787353516}, 'reconstruction_quality': {'explained_variance': 0.006150207947939634, 'mse': 16.67460060119629, 'cossim': 0.8779342770576477}, 'shrinkage': {'l2_norm_in': 41.09651184082031, 'l2_norm_out': 1.3770030736923218, 'l2_ratio': 0.03213917836546898, 'relative_reconstruction_bias': 0.039609361439943314}, 'sparsity': {'l0': 2902.73193359375, 'l1': 2116.134521484375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9860998054020704, 'ce_loss_with_ablation': 8.071582794189453, 'ce_loss_with_sae': 2.2856063842773438, 'ce_loss_without_sae': 2.2040464878082275}, 'reconstruction_quality': {'explained_variance': 0.05622124299407005, 'mse': 20.28957176208496, 'cossim': 0.8851707577705383}, 'shrinkage': {'l2_norm_in': 44.4661865234375, 'l2_norm_out': 1.5216153860092163, 'l2_ratio': 0.03254729509353638, 'relative_reconstruction_bias': 0.03965049982070923}, 'sparsity': {'l0': 2913.879150390625, 'l1': 2249.43310546875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9835125536087584, 'ce_loss_with_ablation': 7.839266300201416, 'ce_loss_with_sae': 2.3990352153778076, 'ce_loss_without_sae': 2.3078360557556152}, 'reconstruction_quality': {'explained_variance': -0.004525159951299429, 'mse': 16.02827262878418, 'cossim': 0.8685991168022156}, 'shrinkage': {'l2_norm_in': 40.885101318359375, 'l2_norm_out': 1.3543781042099, 'l2_ratio': 0.031723957508802414, 'relative_reconstruction_bias': 0.03960118815302849}, 'sparsity': {'l0': 2948.212890625, 'l1': 2133.8798828125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
  warnings.warn(
8000| l0_loss: 14469.50195 | mse_loss: 0.26119: 100%|██████████| 4096000/4096000 [04:54<00:00, 13895.49it/s]
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9811973157091689, 'ce_loss_with_ablation': 7.9237236976623535, 'ce_loss_with_sae': 2.438055992126465, 'ce_loss_without_sae': 2.3329341411590576}, 'reconstruction_quality': {'explained_variance': 0.0030754709150642157, 'mse': 16.359174728393555, 'cossim': 0.8790739178657532}, 'shrinkage': {'l2_norm_in': 40.85554885864258, 'l2_norm_out': 1.369192361831665, 'l2_ratio': 0.03218705207109451, 'relative_reconstruction_bias': 0.039595283567905426}, 'sparsity': {'l0': 2965.753662109375, 'l1': 2147.755615234375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9864443448089649, 'ce_loss_with_ablation': 7.754257678985596, 'ce_loss_with_sae': 2.4479188919067383, 'ce_loss_without_sae': 2.374999523162842}, 'reconstruction_quality': {'explained_variance': 0.004607777576893568, 'mse': 16.378263473510742, 'cossim': 0.8837288022041321}, 'shrinkage': {'l2_norm_in': 41.10640335083008, 'l2_norm_out': 1.3879612684249878, 'l2_ratio': 0.03242255374789238, 'relative_reconstruction_bias': 0.039627429097890854}, 'sparsity': {'l0': 2980.52783203125, 'l1': 2177.733154296875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9805164492076651, 'ce_loss_with_ablation': 7.706046104431152, 'ce_loss_with_sae': 2.4383816719055176, 'ce_loss_without_sae': 2.333709478378296}, 'reconstruction_quality': {'explained_variance': 0.02841949462890625, 'mse': 18.35604476928711, 'cossim': 0.8843182921409607}, 'shrinkage': {'l2_norm_in': 42.60511016845703, 'l2_norm_out': 1.4471081495285034, 'l2_ratio': 0.03250720724463463, 'relative_reconstruction_bias': 0.03961510583758354}, 'sparsity': {'l0': 3017.549560546875, 'l1': 2246.148193359375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9793380776820201, 'ce_loss_with_ablation': 8.2566499710083, 'ce_loss_with_sae': 2.2037816047668457, 'ce_loss_without_sae': 2.0760791301727295}, 'reconstruction_quality': {'explained_variance': 0.05746552348136902, 'mse': 20.44130516052246, 'cossim': 0.8889802098274231}, 'shrinkage': {'l2_norm_in': 44.40939712524414, 'l2_norm_out': 1.5256178379058838, 'l2_ratio': 0.032717641443014145, 'relative_reconstruction_bias': 0.039584752172231674}, 'sparsity': {'l0': 3034.8994140625, 'l1': 2328.886962890625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.980762893534187, 'ce_loss_with_ablation': 8.236321449279785, 'ce_loss_with_sae': 2.247471809387207, 'ce_loss_without_sae': 2.1300039291381836}, 'reconstruction_quality': {'explained_variance': 0.05089008808135986, 'mse': 19.891550064086914, 'cossim': 0.8906222581863403}, 'shrinkage': {'l2_norm_in': 44.13264083862305, 'l2_norm_out': 1.516158938407898, 'l2_ratio': 0.03278445824980736, 'relative_reconstruction_bias': 0.0396260991692543}, 'sparsity': {'l0': 3042.567626953125, 'l1': 2324.339599609375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9815264106540639, 'ce_loss_with_ablation': 8.337739944458008, 'ce_loss_with_sae': 2.213397979736328, 'ce_loss_without_sae': 2.098129987716675}, 'reconstruction_quality': {'explained_variance': 0.05892563983798027, 'mse': 20.45493507385254, 'cossim': 0.894992470741272}, 'shrinkage': {'l2_norm_in': 44.64028549194336, 'l2_norm_out': 1.546456217765808, 'l2_ratio': 0.03303849697113037, 'relative_reconstruction_bias': 0.039616186171770096}, 'sparsity': {'l0': 3061.934814453125, 'l1': 2356.17822265625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
