Estimating norm scaling factor: 100%|██████████| 1000/1000 [00:01<00:00, 513.41it/s]
3500| l0_loss: 7766.60156 | mse_loss: 0.47226:  15%|█▍        | 1792000/12288000 [02:06<12:28, 14019.91it/s]interrupted, saving progress
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.005227390700687625, 'ce_loss_with_ablation': 7.993437767028809, 'ce_loss_with_sae': 7.963644027709961, 'ce_loss_without_sae': 2.2938945293426514}, 'reconstruction_quality': {'explained_variance': -0.007303890772163868, 'mse': 21.235027313232422, 'cossim': 0.13084788620471954}, 'shrinkage': {'l2_norm_in': 43.8648796081543, 'l2_norm_out': 0.5297687649726868, 'l2_ratio': 0.0068161520175635815, 'relative_reconstruction_bias': 0.3860399127006531}, 'sparsity': {'l0': 2518.082763671875, 'l1': 184.74867248535156}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': -0.0208515380059983, 'ce_loss_with_ablation': 8.472864151000977, 'ce_loss_with_sae': 8.599045753479004, 'ce_loss_without_sae': 2.4214351177215576}, 'reconstruction_quality': {'explained_variance': -0.024570882320404053, 'mse': 20.39345932006836, 'cossim': 0.24726267158985138}, 'shrinkage': {'l2_norm_in': 43.19666290283203, 'l2_norm_out': 0.15466690063476562, 'l2_ratio': 0.002110517816618085, 'relative_reconstruction_bias': 0.06285379827022552}, 'sparsity': {'l0': 1125.0233154296875, 'l1': 58.717708587646484}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.08173237765225234, 'ce_loss_with_ablation': 8.208343505859375, 'ce_loss_with_sae': 7.7465057373046875, 'ce_loss_without_sae': 2.5577337741851807}, 'reconstruction_quality': {'explained_variance': -0.020240167155861855, 'mse': 20.41843032836914, 'cossim': 0.2910880744457245}, 'shrinkage': {'l2_norm_in': 43.310237884521484, 'l2_norm_out': 0.13153067231178284, 'l2_ratio': 0.0011608743807300925, 'relative_reconstruction_bias': 0.03283005952835083}, 'sparsity': {'l0': 676.8484497070312, 'l1': 54.8433723449707}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.3864877026160239, 'ce_loss_with_ablation': 8.418126106262207, 'ce_loss_with_sae': 6.113701343536377, 'ce_loss_without_sae': 2.4556472301483154}, 'reconstruction_quality': {'explained_variance': -0.011641657911241055, 'mse': 20.804601669311523, 'cossim': 0.3009944558143616}, 'shrinkage': {'l2_norm_in': 43.80038070678711, 'l2_norm_out': 0.19377219676971436, 'l2_ratio': 0.0015710791340097785, 'relative_reconstruction_bias': 0.01889250986278057}, 'sparsity': {'l0': 551.4337768554688, 'l1': 113.9655532836914}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5560908836685288, 'ce_loss_with_ablation': 8.324442863464355, 'ce_loss_with_sae': 5.062108039855957, 'ce_loss_without_sae': 2.457893133163452}, 'reconstruction_quality': {'explained_variance': -0.013454732485115528, 'mse': 19.605121612548828, 'cossim': 0.38491782546043396}, 'shrinkage': {'l2_norm_in': 43.595802307128906, 'l2_norm_out': 0.5126240253448486, 'l2_ratio': 0.0072645023465156555, 'relative_reconstruction_bias': 0.029401013627648354}, 'sparsity': {'l0': 496.861328125, 'l1': 258.095703125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.6161008142781442, 'ce_loss_with_ablation': 8.514806747436523, 'ce_loss_with_sae': 4.788108825683594, 'ce_loss_without_sae': 2.4659624099731445}, 'reconstruction_quality': {'explained_variance': -0.007760199252516031, 'mse': 19.528318405151367, 'cossim': 0.46298500895500183}, 'shrinkage': {'l2_norm_in': 43.64724349975586, 'l2_norm_out': 0.7221580743789673, 'l2_ratio': 0.011308322660624981, 'relative_reconstruction_bias': 0.035585105419158936}, 'sparsity': {'l0': 540.6886596679688, 'l1': 359.18359375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.7114087245178891, 'ce_loss_with_ablation': 8.2409029006958, 'ce_loss_with_sae': 4.097500324249268, 'ce_loss_without_sae': 2.4166805744171143}, 'reconstruction_quality': {'explained_variance': 0.008739990182220936, 'mse': 20.26193618774414, 'cossim': 0.506166934967041}, 'shrinkage': {'l2_norm_in': 44.002803802490234, 'l2_norm_out': 0.8459604382514954, 'l2_ratio': 0.013946441002190113, 'relative_reconstruction_bias': 0.0369986854493618}, 'sparsity': {'l0': 622.3568725585938, 'l1': 438.1319885253906}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.7600941648218902, 'ce_loss_with_ablation': 8.194169998168945, 'ce_loss_with_sae': 3.8711183071136475, 'ce_loss_without_sae': 2.5066487789154053}, 'reconstruction_quality': {'explained_variance': 0.003140291664749384, 'mse': 19.888477325439453, 'cossim': 0.5474772453308105}, 'shrinkage': {'l2_norm_in': 43.785003662109375, 'l2_norm_out': 0.915888249874115, 'l2_ratio': 0.016119733452796936, 'relative_reconstruction_bias': 0.03760090470314026}, 'sparsity': {'l0': 652.953125, 'l1': 492.04833984375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.7970832248634981, 'ce_loss_with_ablation': 8.161482810974121, 'ce_loss_with_sae': 3.693875789642334, 'ce_loss_without_sae': 2.5565385818481445}, 'reconstruction_quality': {'explained_variance': 0.0027557683642953634, 'mse': 19.49654197692871, 'cossim': 0.5729207992553711}, 'shrinkage': {'l2_norm_in': 43.49521255493164, 'l2_norm_out': 0.9598972201347351, 'l2_ratio': 0.017475193366408348, 'relative_reconstruction_bias': 0.038282956928014755}, 'sparsity': {'l0': 744.9279174804688, 'l1': 539.9375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.8166622164832765, 'ce_loss_with_ablation': 8.346538543701172, 'ce_loss_with_sae': 3.544682025909424, 'ce_loss_without_sae': 2.466682195663452}, 'reconstruction_quality': {'explained_variance': 0.016768446192145348, 'mse': 20.24521827697754, 'cossim': 0.6027647852897644}, 'shrinkage': {'l2_norm_in': 44.087890625, 'l2_norm_out': 1.0286550521850586, 'l2_ratio': 0.018778279423713684, 'relative_reconstruction_bias': 0.03871815279126167}, 'sparsity': {'l0': 813.876953125, 'l1': 606.7838745117188}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.8450457782597632, 'ce_loss_with_ablation': 8.018692016601562, 'ce_loss_with_sae': 3.3503592014312744, 'ce_loss_without_sae': 2.4943370819091797}, 'reconstruction_quality': {'explained_variance': 0.021207258105278015, 'mse': 20.44337272644043, 'cossim': 0.6160879135131836}, 'shrinkage': {'l2_norm_in': 44.241024017333984, 'l2_norm_out': 1.0576807260513306, 'l2_ratio': 0.019423816353082657, 'relative_reconstruction_bias': 0.03907177224755287}, 'sparsity': {'l0': 891.1160278320312, 'l1': 661.8626098632812}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.8726346779628127, 'ce_loss_with_ablation': 8.227436065673828, 'ce_loss_with_sae': 3.1925957202911377, 'ce_loss_without_sae': 2.457736015319824}, 'reconstruction_quality': {'explained_variance': 0.023660127073526382, 'mse': 20.29450798034668, 'cossim': 0.6488420367240906}, 'shrinkage': {'l2_norm_in': 44.09961700439453, 'l2_norm_out': 1.1002399921417236, 'l2_ratio': 0.020719965919852257, 'relative_reconstruction_bias': 0.03928302973508835}, 'sparsity': {'l0': 957.7078247070312, 'l1': 715.4608764648438}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9025060820885762, 'ce_loss_with_ablation': 8.218037605285645, 'ce_loss_with_sae': 2.6247215270996094, 'ce_loss_without_sae': 2.0204992294311523}, 'reconstruction_quality': {'explained_variance': 0.0013864340726286173, 'mse': 18.00372314453125, 'cossim': 0.6848900318145752}, 'shrinkage': {'l2_norm_in': 42.4014892578125, 'l2_norm_out': 1.0948301553726196, 'l2_ratio': 0.022335994988679886, 'relative_reconstruction_bias': 0.039337407797575}, 'sparsity': {'l0': 1041.0731201171875, 'l1': 728.6337890625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9215046929521877, 'ce_loss_with_ablation': 7.762081623077393, 'ce_loss_with_sae': 2.68875789642334, 'ce_loss_without_sae': 2.256603717803955}, 'reconstruction_quality': {'explained_variance': -0.019301285967230797, 'mse': 16.63058853149414, 'cossim': 0.6963712573051453}, 'shrinkage': {'l2_norm_in': 41.041751861572266, 'l2_norm_out': 1.0682388544082642, 'l2_ratio': 0.023112235590815544, 'relative_reconstruction_bias': 0.03939684480428696}, 'sparsity': {'l0': 1120.7457275390625, 'l1': 744.7116088867188}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9298026807081954, 'ce_loss_with_ablation': 7.718745231628418, 'ce_loss_with_sae': 2.6727712154388428, 'ce_loss_without_sae': 2.2918152809143066}, 'reconstruction_quality': {'explained_variance': -0.022665822878479958, 'mse': 16.160253524780273, 'cossim': 0.707767903804779}, 'shrinkage': {'l2_norm_in': 40.816558837890625, 'l2_norm_out': 1.0813318490982056, 'l2_ratio': 0.023731190711259842, 'relative_reconstruction_bias': 0.03952441364526749}, 'sparsity': {'l0': 1190.109619140625, 'l1': 786.7572021484375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9435617430940266, 'ce_loss_with_ablation': 7.9982428550720215, 'ce_loss_with_sae': 2.6233787536621094, 'ce_loss_without_sae': 2.3018863201141357}, 'reconstruction_quality': {'explained_variance': -0.01751674711704254, 'mse': 16.264373779296875, 'cossim': 0.7303187251091003}, 'shrinkage': {'l2_norm_in': 40.71774673461914, 'l2_norm_out': 1.120554804801941, 'l2_ratio': 0.024950409308075905, 'relative_reconstruction_bias': 0.03959323838353157}, 'sparsity': {'l0': 1245.4989013671875, 'l1': 841.064453125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.939543015731051, 'ce_loss_with_ablation': 7.808859825134277, 'ce_loss_with_sae': 2.7045183181762695, 'ce_loss_without_sae': 2.376068115234375}, 'reconstruction_quality': {'explained_variance': 0.03140096738934517, 'mse': 19.5998477935791, 'cossim': 0.7559687495231628}, 'shrinkage': {'l2_norm_in': 43.88994216918945, 'l2_norm_out': 1.2775681018829346, 'l2_ratio': 0.026057887822389603, 'relative_reconstruction_bias': 0.03965075686573982}, 'sparsity': {'l0': 1352.194580078125, 'l1': 990.6082153320312}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.938073263344935, 'ce_loss_with_ablation': 8.106575965881348, 'ce_loss_with_sae': 2.4273767471313477, 'ce_loss_without_sae': 2.0524654388427734}, 'reconstruction_quality': {'explained_variance': 0.041938766837120056, 'mse': 20.304916381835938, 'cossim': 0.7657761573791504}, 'shrinkage': {'l2_norm_in': 44.511573791503906, 'l2_norm_out': 1.3169540166854858, 'l2_ratio': 0.026541000232100487, 'relative_reconstruction_bias': 0.0396873764693737}, 'sparsity': {'l0': 1417.2655029296875, 'l1': 1056.3944091796875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9510862607491625, 'ce_loss_with_ablation': 8.093259811401367, 'ce_loss_with_sae': 2.446579694747925, 'ce_loss_without_sae': 2.156174659729004}, 'reconstruction_quality': {'explained_variance': -0.014353004284203053, 'mse': 16.310199737548828, 'cossim': 0.7644482254981995}, 'shrinkage': {'l2_norm_in': 40.953609466552734, 'l2_norm_out': 1.184799313545227, 'l2_ratio': 0.026722228154540062, 'relative_reconstruction_bias': 0.03966692090034485}, 'sparsity': {'l0': 1472.818359375, 'l1': 1009.0912475585938}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9549721901549234, 'ce_loss_with_ablation': 7.865519046783447, 'ce_loss_with_sae': 2.5609068870544434, 'ce_loss_without_sae': 2.3107895851135254}, 'reconstruction_quality': {'explained_variance': -0.011686774902045727, 'mse': 16.66132164001465, 'cossim': 0.7791779637336731}, 'shrinkage': {'l2_norm_in': 40.96787643432617, 'l2_norm_out': 1.212332010269165, 'l2_ratio': 0.027432197704911232, 'relative_reconstruction_bias': 0.039644982665777206}, 'sparsity': {'l0': 1566.0966796875, 'l1': 1074.9990234375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9638355840255821, 'ce_loss_with_ablation': 7.900069236755371, 'ce_loss_with_sae': 2.4886012077331543, 'ce_loss_without_sae': 2.285555601119995}, 'reconstruction_quality': {'explained_variance': -0.01618228293955326, 'mse': 15.991742134094238, 'cossim': 0.7779039144515991}, 'shrinkage': {'l2_norm_in': 40.538673400878906, 'l2_norm_out': 1.1916877031326294, 'l2_ratio': 0.027291104197502136, 'relative_reconstruction_bias': 0.039717692881822586}, 'sparsity': {'l0': 1598.5416259765625, 'l1': 1102.8997802734375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9676214347362007, 'ce_loss_with_ablation': 7.851823806762695, 'ce_loss_with_sae': 2.5675511360168457, 'ce_loss_without_sae': 2.390728712081909}, 'reconstruction_quality': {'explained_variance': -0.010367374867200851, 'mse': 16.143308639526367, 'cossim': 0.7943530082702637}, 'shrinkage': {'l2_norm_in': 40.78132247924805, 'l2_norm_out': 1.2284082174301147, 'l2_ratio': 0.028126036748290062, 'relative_reconstruction_bias': 0.03968111053109169}, 'sparsity': {'l0': 1677.8719482421875, 'l1': 1172.6129150390625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9658280888126174, 'ce_loss_with_ablation': 8.002524375915527, 'ce_loss_with_sae': 2.3878023624420166, 'ce_loss_without_sae': 2.189148187637329}, 'reconstruction_quality': {'explained_variance': 0.04654797166585922, 'mse': 20.1781063079834, 'cossim': 0.8186870813369751}, 'shrinkage': {'l2_norm_in': 44.511688232421875, 'l2_norm_out': 1.409342646598816, 'l2_ratio': 0.02922709286212921, 'relative_reconstruction_bias': 0.03968582674860954}, 'sparsity': {'l0': 1734.289306640625, 'l1': 1341.6981201171875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
Traceback (most recent call last):
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/data/yusenp/NLP/KAN-LLaMA/preliminary_exploration/train_SAE.py", line 94, in <module>
    main()
  File "/data/yusenp/NLP/KAN-LLaMA/preliminary_exploration/train_SAE.py", line 89, in main
    sparse_autoencoder = SAETrainingRunner(cfg).run()
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 113, in run
    sae = self.run_trainer_with_interruption_handling(trainer)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 152, in run_trainer_with_interruption_handling
    sae = trainer.fit()
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/sae_trainer.py", line 191, in fit
    self._run_and_log_evals()
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/sae_trainer.py", line 340, in _run_and_log_evals
    eval_metrics, _ = run_evals(
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/evals.py", line 139, in run_evals
    reconstruction_metrics = get_downstream_reconstruction_metrics(
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/evals.py", line 322, in get_downstream_reconstruction_metrics
    for metric_name, metric_value in get_recons_loss(
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/evals.py", line 666, in get_recons_loss
    recons_logits, recons_ce_loss = model.run_with_hooks(
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/transformer_lens/hook_points.py", line 456, in run_with_hooks
    return hooked_model.forward(*model_args, **model_kwargs)
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/transformer_lens/HookedTransformer.py", line 612, in forward
    residual = block(
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/transformer_lens/components/transformer_block.py", line 177, in forward
    if resid_pre.device != attn_out.device:
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 27, in interrupt_callback
    raise InterruptedException()
sae_lens.sae_training_runner.InterruptedException
Traceback (most recent call last):
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/data/yusenp/NLP/KAN-LLaMA/preliminary_exploration/train_SAE.py", line 94, in <module>
    main()
  File "/data/yusenp/NLP/KAN-LLaMA/preliminary_exploration/train_SAE.py", line 89, in main
    sparse_autoencoder = SAETrainingRunner(cfg).run()
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 113, in run
    sae = self.run_trainer_with_interruption_handling(trainer)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 152, in run_trainer_with_interruption_handling
    sae = trainer.fit()
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/sae_trainer.py", line 191, in fit
    self._run_and_log_evals()
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/sae_trainer.py", line 340, in _run_and_log_evals
    eval_metrics, _ = run_evals(
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/evals.py", line 139, in run_evals
    reconstruction_metrics = get_downstream_reconstruction_metrics(
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/evals.py", line 322, in get_downstream_reconstruction_metrics
    for metric_name, metric_value in get_recons_loss(
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/evals.py", line 666, in get_recons_loss
    recons_logits, recons_ce_loss = model.run_with_hooks(
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/transformer_lens/hook_points.py", line 456, in run_with_hooks
    return hooked_model.forward(*model_args, **model_kwargs)
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/transformer_lens/HookedTransformer.py", line 612, in forward
    residual = block(
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/transformer_lens/components/transformer_block.py", line 177, in forward
    if resid_pre.device != attn_out.device:
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 27, in interrupt_callback
    raise InterruptedException()
sae_lens.sae_training_runner.InterruptedException
