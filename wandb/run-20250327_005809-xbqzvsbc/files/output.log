Estimating norm scaling factor: 100%|██████████| 1000/1000 [00:01<00:00, 519.13it/s]
4700| l0_loss: 11217.48047 | mse_loss: 0.34649:  59%|█████▉    | 2406400/4096000 [02:52<02:00, 14056.87it/s]
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.04015893001213899, 'ce_loss_with_ablation': 7.993437767028809, 'ce_loss_with_sae': 7.76455020904541, 'ce_loss_without_sae': 2.2938945293426514}, 'reconstruction_quality': {'explained_variance': -0.0074298991821706295, 'mse': 21.966100692749023, 'cossim': 0.19631613790988922}, 'shrinkage': {'l2_norm_in': 44.595489501953125, 'l2_norm_out': 0.2557743489742279, 'l2_ratio': 0.00348183186724782, 'relative_reconstruction_bias': 0.135784313082695}, 'sparsity': {'l0': 1554.6488037109375, 'l1': 95.04264068603516}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': -0.19566966266379576, 'ce_loss_with_ablation': 8.472864151000977, 'ce_loss_with_sae': 9.65694522857666, 'ce_loss_without_sae': 2.4214351177215576}, 'reconstruction_quality': {'explained_variance': -0.024606291204690933, 'mse': 21.062952041625977, 'cossim': 0.28098252415657043}, 'shrinkage': {'l2_norm_in': 43.916141510009766, 'l2_norm_out': 0.12107513099908829, 'l2_ratio': 0.001219413592480123, 'relative_reconstruction_bias': 0.03764829412102699}, 'sparsity': {'l0': 723.9357299804688, 'l1': 49.47287368774414}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.3359264146664346, 'ce_loss_with_ablation': 8.208343505859375, 'ce_loss_with_sae': 6.310154438018799, 'ce_loss_without_sae': 2.5577337741851807}, 'reconstruction_quality': {'explained_variance': -0.01971435360610485, 'mse': 20.93818473815918, 'cossim': 0.2844085097312927}, 'shrinkage': {'l2_norm_in': 44.03160858154297, 'l2_norm_out': 0.1657046526670456, 'l2_ratio': 0.0014247018843889236, 'relative_reconstruction_bias': 0.0185270793735981}, 'sparsity': {'l0': 503.67852783203125, 'l1': 100.23150634765625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.545601368561481, 'ce_loss_with_ablation': 8.418126106262207, 'ce_loss_with_sae': 5.164989471435547, 'ce_loss_without_sae': 2.4556472301483154}, 'reconstruction_quality': {'explained_variance': -0.004798078443855047, 'mse': 20.960683822631836, 'cossim': 0.39945468306541443}, 'shrinkage': {'l2_norm_in': 44.52991485595703, 'l2_norm_out': 0.5568634867668152, 'l2_ratio': 0.008457432501018047, 'relative_reconstruction_bias': 0.027917003259062767}, 'sparsity': {'l0': 524.099609375, 'l1': 299.73785400390625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.6030681912809157, 'ce_loss_with_ablation': 8.324442863464355, 'ce_loss_with_sae': 4.786513328552246, 'ce_loss_without_sae': 2.457893133163452}, 'reconstruction_quality': {'explained_variance': -0.007419700268656015, 'mse': 19.990619659423828, 'cossim': 0.4623354971408844}, 'shrinkage': {'l2_norm_in': 44.321929931640625, 'l2_norm_out': 0.7432377934455872, 'l2_ratio': 0.011894501745700836, 'relative_reconstruction_bias': 0.03489646688103676}, 'sparsity': {'l0': 567.1251831054688, 'l1': 404.00836181640625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.6864061098530541, 'ce_loss_with_ablation': 8.514806747436523, 'ce_loss_with_sae': 4.362843036651611, 'ce_loss_without_sae': 2.4659624099731445}, 'reconstruction_quality': {'explained_variance': -0.0031388760544359684, 'mse': 20.088857650756836, 'cossim': 0.5146128535270691}, 'shrinkage': {'l2_norm_in': 44.374229431152344, 'l2_norm_out': 0.8546987771987915, 'l2_ratio': 0.01446688175201416, 'relative_reconstruction_bias': 0.03633710741996765}, 'sparsity': {'l0': 662.4365234375, 'l1': 488.47100830078125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.7559934255639066, 'ce_loss_with_ablation': 8.2409029006958, 'ce_loss_with_sae': 3.837829113006592, 'ce_loss_without_sae': 2.4166805744171143}, 'reconstruction_quality': {'explained_variance': 0.012680423445999622, 'mse': 20.895130157470703, 'cossim': 0.5508984327316284}, 'shrinkage': {'l2_norm_in': 44.735713958740234, 'l2_norm_out': 0.9403273463249207, 'l2_ratio': 0.016333719715476036, 'relative_reconstruction_bias': 0.036993417888879776}, 'sparsity': {'l0': 779.7289428710938, 'l1': 574.9170532226562}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.7943216808180927, 'ce_loss_with_ablation': 8.194169998168945, 'ce_loss_with_sae': 3.6764485836029053, 'ce_loss_without_sae': 2.5066487789154053}, 'reconstruction_quality': {'explained_variance': 0.006862051784992218, 'mse': 20.528837203979492, 'cossim': 0.5884270071983337}, 'shrinkage': {'l2_norm_in': 44.514286041259766, 'l2_norm_out': 0.9983016848564148, 'l2_ratio': 0.018153712153434753, 'relative_reconstruction_bias': 0.037521373480558395}, 'sparsity': {'l0': 833.7888793945312, 'l1': 640.0960693359375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.8396128860462703, 'ce_loss_with_ablation': 8.161482810974121, 'ce_loss_with_sae': 3.4554994106292725, 'ce_loss_without_sae': 2.5565385818481445}, 'reconstruction_quality': {'explained_variance': 0.006403129547834396, 'mse': 20.133691787719727, 'cossim': 0.6174517869949341}, 'shrinkage': {'l2_norm_in': 44.21966552734375, 'l2_norm_out': 1.0360043048858643, 'l2_ratio': 0.019288716837763786, 'relative_reconstruction_bias': 0.03819609805941582}, 'sparsity': {'l0': 928.8637084960938, 'l1': 700.5728759765625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.8592100245297353, 'ce_loss_with_ablation': 8.346538543701172, 'ce_loss_with_sae': 3.2945070266723633, 'ce_loss_without_sae': 2.466682195663452}, 'reconstruction_quality': {'explained_variance': 0.02063332311809063, 'mse': 20.9151668548584, 'cossim': 0.6520905494689941}, 'shrinkage': {'l2_norm_in': 44.82221603393555, 'l2_norm_out': 1.1051796674728394, 'l2_ratio': 0.020604288205504417, 'relative_reconstruction_bias': 0.03854390233755112}, 'sparsity': {'l0': 1016.2820434570312, 'l1': 787.7013549804688}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.8892646200238714, 'ce_loss_with_ablation': 8.018692016601562, 'ce_loss_with_sae': 3.106078624725342, 'ce_loss_without_sae': 2.4943370819091797}, 'reconstruction_quality': {'explained_variance': 0.025175774469971657, 'mse': 21.12855339050293, 'cossim': 0.6645652651786804}, 'shrinkage': {'l2_norm_in': 44.977901458740234, 'l2_norm_out': 1.1328600645065308, 'l2_ratio': 0.02128439024090767, 'relative_reconstruction_bias': 0.03872302547097206}, 'sparsity': {'l0': 1116.293212890625, 'l1': 859.2572631835938}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9084365143028006, 'ce_loss_with_ablation': 8.227436065673828, 'ce_loss_with_sae': 2.986029863357544, 'ce_loss_without_sae': 2.457736015319824}, 'reconstruction_quality': {'explained_variance': 0.02777845598757267, 'mse': 20.981061935424805, 'cossim': 0.6936655044555664}, 'shrinkage': {'l2_norm_in': 44.83413314819336, 'l2_norm_out': 1.1758053302764893, 'l2_ratio': 0.022609205916523933, 'relative_reconstruction_bias': 0.038798946887254715}, 'sparsity': {'l0': 1196.640625, 'l1': 920.9645385742188}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9303156146179402, 'ce_loss_with_ablation': 8.218037605285645, 'ce_loss_with_sae': 2.4523708820343018, 'ce_loss_without_sae': 2.0204992294311523}, 'reconstruction_quality': {'explained_variance': 0.005546775180846453, 'mse': 18.614206314086914, 'cossim': 0.7245402336120605}, 'shrinkage': {'l2_norm_in': 43.107723236083984, 'l2_norm_out': 1.1664618253707886, 'l2_ratio': 0.02410159818828106, 'relative_reconstruction_bias': 0.03883788734674454}, 'sparsity': {'l0': 1285.4227294921875, 'l1': 933.1791381835938}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9420326777889564, 'ce_loss_with_ablation': 7.762081623077393, 'ce_loss_with_sae': 2.5757415294647217, 'ce_loss_without_sae': 2.256603717803955}, 'reconstruction_quality': {'explained_variance': -0.015568715520203114, 'mse': 17.196176528930664, 'cossim': 0.7314541339874268}, 'shrinkage': {'l2_norm_in': 41.725341796875, 'l2_norm_out': 1.1309210062026978, 'l2_ratio': 0.02459115907549858, 'relative_reconstruction_bias': 0.03888838738203049}, 'sparsity': {'l0': 1369.753173828125, 'l1': 946.8250122070312}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9482040263781251, 'ce_loss_with_ablation': 7.718745231628418, 'ce_loss_with_sae': 2.572908401489258, 'ce_loss_without_sae': 2.2918152809143066}, 'reconstruction_quality': {'explained_variance': -0.019317662343382835, 'mse': 16.71302604675293, 'cossim': 0.7402589917182922}, 'shrinkage': {'l2_norm_in': 41.496395111083984, 'l2_norm_out': 1.136256217956543, 'l2_ratio': 0.024979785084724426, 'relative_reconstruction_bias': 0.03894442692399025}, 'sparsity': {'l0': 1440.8787841796875, 'l1': 991.4906616210938}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.958401868455174, 'ce_loss_with_ablation': 7.9982428550720215, 'ce_loss_with_sae': 2.538844108581543, 'ce_loss_without_sae': 2.3018863201141357}, 'reconstruction_quality': {'explained_variance': -0.014604141004383564, 'mse': 16.822904586791992, 'cossim': 0.7594252228736877}, 'shrinkage': {'l2_norm_in': 41.395938873291016, 'l2_norm_out': 1.168733835220337, 'l2_ratio': 0.025965744629502296, 'relative_reconstruction_bias': 0.0389828197658062}, 'sparsity': {'l0': 1495.8865966796875, 'l1': 1051.0850830078125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9535321796234484, 'ce_loss_with_ablation': 7.808859825134277, 'ce_loss_with_sae': 2.6285181045532227, 'ce_loss_without_sae': 2.376068115234375}, 'reconstruction_quality': {'explained_variance': 0.034153081476688385, 'mse': 20.275331497192383, 'cossim': 0.7836378216743469}, 'shrinkage': {'l2_norm_in': 44.6209716796875, 'l2_norm_out': 1.3256772756576538, 'l2_ratio': 0.02701413631439209, 'relative_reconstruction_bias': 0.03901781141757965}, 'sparsity': {'l0': 1591.7567138671875, 'l1': 1220.7098388671875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9509012404313352, 'ce_loss_with_ablation': 8.106575965881348, 'ce_loss_with_sae': 2.349714756011963, 'ce_loss_without_sae': 2.0524654388427734}, 'reconstruction_quality': {'explained_variance': 0.04439932480454445, 'mse': 21.00589942932129, 'cossim': 0.7910842895507812}, 'shrinkage': {'l2_norm_in': 45.25295639038086, 'l2_norm_out': 1.361535668373108, 'l2_ratio': 0.0273810513317585, 'relative_reconstruction_bias': 0.039049308747053146}, 'sparsity': {'l0': 1650.6009521484375, 'l1': 1291.9403076171875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9608217271425439, 'ce_loss_with_ablation': 8.093259811401367, 'ce_loss_with_sae': 2.388779401779175, 'ce_loss_without_sae': 2.156174659729004}, 'reconstruction_quality': {'explained_variance': -0.012233971618115902, 'mse': 16.87298011779785, 'cossim': 0.7870267629623413}, 'shrinkage': {'l2_norm_in': 41.6357307434082, 'l2_norm_out': 1.2217024564743042, 'l2_ratio': 0.027358978986740112, 'relative_reconstruction_bias': 0.0390268974006176}, 'sparsity': {'l0': 1700.0732421875, 'l1': 1232.089111328125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9635023253274584, 'ce_loss_with_ablation': 7.865519046783447, 'ce_loss_with_sae': 2.513524293899536, 'ce_loss_without_sae': 2.3107895851135254}, 'reconstruction_quality': {'explained_variance': -0.009899694472551346, 'mse': 17.237403869628906, 'cossim': 0.799104630947113}, 'shrinkage': {'l2_norm_in': 41.65023422241211, 'l2_norm_out': 1.2445684671401978, 'l2_ratio': 0.02792714349925518, 'relative_reconstruction_bias': 0.03899386525154114}, 'sparsity': {'l0': 1783.1900634765625, 'l1': 1297.7952880859375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.970523135675915, 'ce_loss_with_ablation': 7.900069236755371, 'ce_loss_with_sae': 2.4510538578033447, 'ce_loss_without_sae': 2.285555601119995}, 'reconstruction_quality': {'explained_variance': -0.014657211489975452, 'mse': 16.54538345336914, 'cossim': 0.7957732081413269}, 'shrinkage': {'l2_norm_in': 41.2138786315918, 'l2_norm_out': 1.2200483083724976, 'l2_ratio': 0.027679836377501488, 'relative_reconstruction_bias': 0.03906300291419029}, 'sparsity': {'l0': 1814.324462890625, 'l1': 1318.7098388671875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9728349003446466, 'ce_loss_with_ablation': 7.851823806762695, 'ce_loss_with_sae': 2.5390799045562744, 'ce_loss_without_sae': 2.390728712081909}, 'reconstruction_quality': {'explained_variance': -0.009221576154232025, 'mse': 16.70279312133789, 'cossim': 0.8092058300971985}, 'shrinkage': {'l2_norm_in': 41.4605712890625, 'l2_norm_out': 1.2522869110107422, 'l2_ratio': 0.028363296762108803, 'relative_reconstruction_bias': 0.03903235122561455}, 'sparsity': {'l0': 1888.7562255859375, 'l1': 1384.2176513671875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9703792800142821, 'ce_loss_with_ablation': 8.002524375915527, 'ce_loss_with_sae': 2.361344575881958, 'ce_loss_without_sae': 2.189148187637329}, 'reconstruction_quality': {'explained_variance': 0.04726998135447502, 'mse': 20.879425048828125, 'cossim': 0.8302202224731445}, 'shrinkage': {'l2_norm_in': 45.25307846069336, 'l2_norm_out': 1.429071307182312, 'l2_ratio': 0.02932264842092991, 'relative_reconstruction_bias': 0.03904068097472191}, 'sparsity': {'l0': 1944.0592041015625, 'l1': 1560.6212158203125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9656532229103835, 'ce_loss_with_ablation': 8.148221969604492, 'ce_loss_with_sae': 2.5731515884399414, 'ce_loss_without_sae': 2.3748550415039062}, 'reconstruction_quality': {'explained_variance': 0.0449562668800354, 'mse': 21.260549545288086, 'cossim': 0.8197669982910156}, 'shrinkage': {'l2_norm_in': 44.94275665283203, 'l2_norm_out': 1.3958683013916016, 'l2_ratio': 0.02881462872028351, 'relative_reconstruction_bias': 0.03897041082382202}, 'sparsity': {'l0': 2003.8236083984375, 'l1': 1606.4840087890625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9661962058362431, 'ce_loss_with_ablation': 8.11966323852539, 'ce_loss_with_sae': 2.673562526702881, 'ce_loss_without_sae': 2.483022689819336}, 'reconstruction_quality': {'explained_variance': 0.04591246321797371, 'mse': 20.943126678466797, 'cossim': 0.818829357624054}, 'shrinkage': {'l2_norm_in': 45.059181213378906, 'l2_norm_out': 1.398148775100708, 'l2_ratio': 0.02877134084701538, 'relative_reconstruction_bias': 0.03902576491236687}, 'sparsity': {'l0': 2073.49169921875, 'l1': 1647.6328125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9622862980338037, 'ce_loss_with_ablation': 8.117958068847656, 'ce_loss_with_sae': 2.6654818058013916, 'ce_loss_without_sae': 2.451789617538452}, 'reconstruction_quality': {'explained_variance': 0.03951520845293999, 'mse': 20.746389389038086, 'cossim': 0.8302884101867676}, 'shrinkage': {'l2_norm_in': 44.61726760864258, 'l2_norm_out': 1.4028456211090088, 'l2_ratio': 0.029351338744163513, 'relative_reconstruction_bias': 0.038959503173828125}, 'sparsity': {'l0': 2124.011962890625, 'l1': 1684.3843994140625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9714670623470987, 'ce_loss_with_ablation': 8.239028930664062, 'ce_loss_with_sae': 2.5986487865448, 'ce_loss_without_sae': 2.432985305786133}, 'reconstruction_quality': {'explained_variance': 0.041733141988515854, 'mse': 20.83032989501953, 'cossim': 0.8321860432624817}, 'shrinkage': {'l2_norm_in': 44.79892349243164, 'l2_norm_out': 1.4112348556518555, 'l2_ratio': 0.029452776536345482, 'relative_reconstruction_bias': 0.03897307068109512}, 'sparsity': {'l0': 2181.879150390625, 'l1': 1738.372314453125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9662723553850625, 'ce_loss_with_ablation': 8.300178527832031, 'ce_loss_with_sae': 2.685260534286499, 'ce_loss_without_sae': 2.489272356033325}, 'reconstruction_quality': {'explained_variance': 0.04167481139302254, 'mse': 20.87862205505371, 'cossim': 0.8386676907539368}, 'shrinkage': {'l2_norm_in': 44.81843185424805, 'l2_norm_out': 1.4223346710205078, 'l2_ratio': 0.02974494732916355, 'relative_reconstruction_bias': 0.03895856812596321}, 'sparsity': {'l0': 2238.458740234375, 'l1': 1775.7191162109375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9813089236443306, 'ce_loss_with_ablation': 7.968987464904785, 'ce_loss_with_sae': 2.3706138134002686, 'ce_loss_without_sae': 2.2639811038970947}, 'reconstruction_quality': {'explained_variance': 0.05333228036761284, 'mse': 20.624082565307617, 'cossim': 0.854870617389679}, 'shrinkage': {'l2_norm_in': 44.87458419799805, 'l2_norm_out': 1.4554108381271362, 'l2_ratio': 0.030500276014208794, 'relative_reconstruction_bias': 0.039046891033649445}, 'sparsity': {'l0': 2293.233642578125, 'l1': 1828.6610107421875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9812762459047499, 'ce_loss_with_ablation': 8.015522003173828, 'ce_loss_with_sae': 2.3832473754882812, 'ce_loss_without_sae': 2.275777816772461}, 'reconstruction_quality': {'explained_variance': 0.05584060028195381, 'mse': 20.85108184814453, 'cossim': 0.8634287118911743}, 'shrinkage': {'l2_norm_in': 44.79668045043945, 'l2_norm_out': 1.4678148031234741, 'l2_ratio': 0.030869126319885254, 'relative_reconstruction_bias': 0.03904625400900841}, 'sparsity': {'l0': 2334.671142578125, 'l1': 1875.7802734375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9827456890906185, 'ce_loss_with_ablation': 8.02662181854248, 'ce_loss_with_sae': 2.3629403114318848, 'ce_loss_without_sae': 2.2635016441345215}, 'reconstruction_quality': {'explained_variance': 0.04582465812563896, 'mse': 20.86408805847168, 'cossim': 0.8461292386054993}, 'shrinkage': {'l2_norm_in': 44.73898696899414, 'l2_norm_out': 1.434000849723816, 'l2_ratio': 0.03012198582291603, 'relative_reconstruction_bias': 0.03898018226027489}, 'sparsity': {'l0': 2393.242919921875, 'l1': 1895.0633544921875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9688242125428054, 'ce_loss_with_ablation': 8.207812309265137, 'ce_loss_with_sae': 2.6054301261901855, 'ce_loss_without_sae': 2.4251511096954346}, 'reconstruction_quality': {'explained_variance': 0.04414145275950432, 'mse': 20.66663932800293, 'cossim': 0.842054009437561}, 'shrinkage': {'l2_norm_in': 44.696258544921875, 'l2_norm_out': 1.4254568815231323, 'l2_ratio': 0.029934419319033623, 'relative_reconstruction_bias': 0.03896456956863403}, 'sparsity': {'l0': 2436.325927734375, 'l1': 1922.351806640625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9743261318814405, 'ce_loss_with_ablation': 7.968865394592285, 'ce_loss_with_sae': 2.5724685192108154, 'ce_loss_without_sae': 2.4302713871002197}, 'reconstruction_quality': {'explained_variance': 0.03616512939333916, 'mse': 20.125228881835938, 'cossim': 0.8498103022575378}, 'shrinkage': {'l2_norm_in': 44.27650833129883, 'l2_norm_out': 1.4224218130111694, 'l2_ratio': 0.03028530813753605, 'relative_reconstruction_bias': 0.03895796462893486}, 'sparsity': {'l0': 2473.969970703125, 'l1': 1956.345947265625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9791502047848861, 'ce_loss_with_ablation': 8.31395149230957, 'ce_loss_with_sae': 2.624671220779419, 'ce_loss_without_sae': 2.5035250186920166}, 'reconstruction_quality': {'explained_variance': 0.04137536883354187, 'mse': 20.616893768310547, 'cossim': 0.8549246191978455}, 'shrinkage': {'l2_norm_in': 44.58955383300781, 'l2_norm_out': 1.4441702365875244, 'l2_ratio': 0.03055359423160553, 'relative_reconstruction_bias': 0.038990218192338943}, 'sparsity': {'l0': 2526.814697265625, 'l1': 1998.0943603515625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9764026786497152, 'ce_loss_with_ablation': 8.183964729309082, 'ce_loss_with_sae': 2.552725076675415, 'ce_loss_without_sae': 2.4166314601898193}, 'reconstruction_quality': {'explained_variance': 0.04231954365968704, 'mse': 20.506601333618164, 'cossim': 0.8541965484619141}, 'shrinkage': {'l2_norm_in': 44.76676940917969, 'l2_norm_out': 1.448732852935791, 'l2_ratio': 0.03054521419107914, 'relative_reconstruction_bias': 0.03899219632148743}, 'sparsity': {'l0': 2563.204833984375, 'l1': 2028.293212890625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9763636435682078, 'ce_loss_with_ablation': 8.27078914642334, 'ce_loss_with_sae': 2.6311399936676025, 'ce_loss_without_sae': 2.494612216949463}, 'reconstruction_quality': {'explained_variance': 0.040754277259111404, 'mse': 20.492475509643555, 'cossim': 0.856719434261322}, 'shrinkage': {'l2_norm_in': 44.56110763549805, 'l2_norm_out': 1.4461653232574463, 'l2_ratio': 0.030672866851091385, 'relative_reconstruction_bias': 0.038964640349149704}, 'sparsity': {'l0': 2600.872802734375, 'l1': 2047.8980712890625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9751297789275324, 'ce_loss_with_ablation': 8.307905197143555, 'ce_loss_with_sae': 2.583724021911621, 'ce_loss_without_sae': 2.4377315044403076}, 'reconstruction_quality': {'explained_variance': 0.0403018556535244, 'mse': 20.40821075439453, 'cossim': 0.8545970916748047}, 'shrinkage': {'l2_norm_in': 44.603511810302734, 'l2_norm_out': 1.440859079360962, 'l2_ratio': 0.030530715361237526, 'relative_reconstruction_bias': 0.03896290808916092}, 'sparsity': {'l0': 2637.83740234375, 'l1': 2064.94189453125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9779060219632343, 'ce_loss_with_ablation': 8.298147201538086, 'ce_loss_with_sae': 2.5916941165924072, 'ce_loss_without_sae': 2.4627673625946045}, 'reconstruction_quality': {'explained_variance': 0.04716094210743904, 'mse': 20.777423858642578, 'cossim': 0.8615075945854187}, 'shrinkage': {'l2_norm_in': 44.81772994995117, 'l2_norm_out': 1.4627418518066406, 'l2_ratio': 0.03086921013891697, 'relative_reconstruction_bias': 0.03898898884654045}, 'sparsity': {'l0': 2662.529052734375, 'l1': 2100.34375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9760632344979638, 'ce_loss_with_ablation': 8.28319263458252, 'ce_loss_with_sae': 2.5701186656951904, 'ce_loss_without_sae': 2.4300124645233154}, 'reconstruction_quality': {'explained_variance': 0.044159214943647385, 'mse': 20.734914779663086, 'cossim': 0.8643695712089539}, 'shrinkage': {'l2_norm_in': 44.434295654296875, 'l2_norm_out': 1.4564956426620483, 'l2_ratio': 0.031031614169478416, 'relative_reconstruction_bias': 0.03895559534430504}, 'sparsity': {'l0': 2708.5390625, 'l1': 2126.464599609375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9747730706771599, 'ce_loss_with_ablation': 8.250324249267578, 'ce_loss_with_sae': 2.5924172401428223, 'ce_loss_without_sae': 2.4459917545318604}, 'reconstruction_quality': {'explained_variance': 0.0410161130130291, 'mse': 20.3385066986084, 'cossim': 0.8597165942192078}, 'shrinkage': {'l2_norm_in': 44.78322982788086, 'l2_norm_out': 1.458325982093811, 'l2_ratio': 0.03084556572139263, 'relative_reconstruction_bias': 0.03897976502776146}, 'sparsity': {'l0': 2750.503662109375, 'l1': 2158.141357421875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9790058254288132, 'ce_loss_with_ablation': 8.394744873046875, 'ce_loss_with_sae': 2.5983102321624756, 'ce_loss_without_sae': 2.4740092754364014}, 'reconstruction_quality': {'explained_variance': 0.03923149034380913, 'mse': 20.33893394470215, 'cossim': 0.863743007183075}, 'shrinkage': {'l2_norm_in': 44.873046875, 'l2_norm_out': 1.4673281908035278, 'l2_ratio': 0.030992913991212845, 'relative_reconstruction_bias': 0.038963187485933304}, 'sparsity': {'l0': 2768.0263671875, 'l1': 2175.639892578125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9771491012219491, 'ce_loss_with_ablation': 8.180709838867188, 'ce_loss_with_sae': 2.5559730529785156, 'ce_loss_without_sae': 2.4244370460510254}, 'reconstruction_quality': {'explained_variance': 0.006631083320826292, 'mse': 17.88886833190918, 'cossim': 0.8759095072746277}, 'shrinkage': {'l2_norm_in': 42.15052032470703, 'l2_norm_out': 1.3905812501907349, 'l2_ratio': 0.031590815633535385, 'relative_reconstruction_bias': 0.03899036720395088}, 'sparsity': {'l0': 2808.791259765625, 'l1': 2137.61376953125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9796395242636768, 'ce_loss_with_ablation': 7.890441417694092, 'ce_loss_with_sae': 2.501955270767212, 'ce_loss_without_sae': 2.389962911605835}, 'reconstruction_quality': {'explained_variance': 0.0029333976563066244, 'mse': 17.146987915039062, 'cossim': 0.878152072429657}, 'shrinkage': {'l2_norm_in': 41.85373306274414, 'l2_norm_out': 1.3844335079193115, 'l2_ratio': 0.03169840946793556, 'relative_reconstruction_bias': 0.03903012350201607}, 'sparsity': {'l0': 2817.923828125, 'l1': 2135.01220703125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9760331928705921, 'ce_loss_with_ablation': 7.853931427001953, 'ce_loss_with_sae': 2.4398951530456543, 'ce_loss_without_sae': 2.3069517612457275}, 'reconstruction_quality': {'explained_variance': 0.00042591019882820547, 'mse': 16.637901306152344, 'cossim': 0.8750357031822205}, 'shrinkage': {'l2_norm_in': 41.37568283081055, 'l2_norm_out': 1.3612091541290283, 'l2_ratio': 0.03152608498930931, 'relative_reconstruction_bias': 0.0390394888818264}, 'sparsity': {'l0': 2852.997802734375, 'l1': 2133.134765625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9801972567213355, 'ce_loss_with_ablation': 7.938239097595215, 'ce_loss_with_sae': 2.3801662921905518, 'ce_loss_without_sae': 2.2678775787353516}, 'reconstruction_quality': {'explained_variance': 0.00542317284271121, 'mse': 17.1895809173584, 'cossim': 0.8787523508071899}, 'shrinkage': {'l2_norm_in': 41.70266342163086, 'l2_norm_out': 1.378588080406189, 'l2_ratio': 0.03171242028474808, 'relative_reconstruction_bias': 0.039037298411130905}, 'sparsity': {'l0': 2881.521240234375, 'l1': 2160.944580078125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9862108974109183, 'ce_loss_with_ablation': 8.071582794189453, 'ce_loss_with_sae': 2.28495454788208, 'ce_loss_without_sae': 2.2040464878082275}, 'reconstruction_quality': {'explained_variance': 0.05548720434308052, 'mse': 20.91668128967285, 'cossim': 0.8858427405357361}, 'shrinkage': {'l2_norm_in': 45.122039794921875, 'l2_norm_out': 1.522752046585083, 'l2_ratio': 0.03210478276014328, 'relative_reconstruction_bias': 0.03907468542456627}, 'sparsity': {'l0': 2893.4541015625, 'l1': 2297.625732421875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9835239757763842, 'ce_loss_with_ablation': 7.839266300201416, 'ce_loss_with_sae': 2.3989720344543457, 'ce_loss_without_sae': 2.3078360557556152}, 'reconstruction_quality': {'explained_variance': -0.005255562253296375, 'mse': 16.523386001586914, 'cossim': 0.8693025708198547}, 'shrinkage': {'l2_norm_in': 41.48813247680664, 'l2_norm_out': 1.3557370901107788, 'l2_ratio': 0.03130105510354042, 'relative_reconstruction_bias': 0.0390266478061676}, 'sparsity': {'l0': 2925.191650390625, 'l1': 2178.791748046875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
  warnings.warn(
8000| l0_loss: 14267.00195 | mse_loss: 0.26971: 100%|██████████| 4096000/4096000 [04:55<00:00, 13854.52it/s]
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9818670536320414, 'ce_loss_with_ablation': 7.9237236976623535, 'ce_loss_with_sae': 2.434311628341675, 'ce_loss_without_sae': 2.3329341411590576}, 'reconstruction_quality': {'explained_variance': 0.0023389977868646383, 'mse': 16.864444732666016, 'cossim': 0.8798438906669617}, 'shrinkage': {'l2_norm_in': 41.4581413269043, 'l2_norm_out': 1.3707187175750732, 'l2_ratio': 0.031758833676576614, 'relative_reconstruction_bias': 0.03902197629213333}, 'sparsity': {'l0': 2941.6474609375, 'l1': 2192.98779296875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9864863619062004, 'ce_loss_with_ablation': 7.754257678985596, 'ce_loss_with_sae': 2.44769287109375, 'ce_loss_without_sae': 2.374999523162842}, 'reconstruction_quality': {'explained_variance': 0.003852264955639839, 'mse': 16.884084701538086, 'cossim': 0.8844538927078247}, 'shrinkage': {'l2_norm_in': 41.71269607543945, 'l2_norm_out': 1.3893461227416992, 'l2_ratio': 0.031986385583877563, 'relative_reconstruction_bias': 0.03905704244971275}, 'sparsity': {'l0': 2954.66943359375, 'l1': 2223.428955078125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9808238620919263, 'ce_loss_with_ablation': 7.706046104431152, 'ce_loss_with_sae': 2.436730146408081, 'ce_loss_without_sae': 2.333709478378296}, 'reconstruction_quality': {'explained_variance': 0.027667168527841568, 'mse': 18.923063278198242, 'cossim': 0.8848907351493835}, 'shrinkage': {'l2_norm_in': 43.2335090637207, 'l2_norm_out': 1.44835364818573, 'l2_ratio': 0.03206769376993179, 'relative_reconstruction_bias': 0.03904614597558975}, 'sparsity': {'l0': 2990.831298828125, 'l1': 2293.179443359375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9795317652420363, 'ce_loss_with_ablation': 8.2566499710083, 'ce_loss_with_sae': 2.2025845050811768, 'ce_loss_without_sae': 2.0760791301727295}, 'reconstruction_quality': {'explained_variance': 0.05671954154968262, 'mse': 21.07297134399414, 'cossim': 0.8895706534385681}, 'shrinkage': {'l2_norm_in': 45.06440353393555, 'l2_norm_out': 1.5267057418823242, 'l2_ratio': 0.03227091580629349, 'relative_reconstruction_bias': 0.039013851433992386}, 'sparsity': {'l0': 3005.986572265625, 'l1': 2376.43603515625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9811115225541774, 'ce_loss_with_ablation': 8.236321449279785, 'ce_loss_with_sae': 2.245342969894409, 'ce_loss_without_sae': 2.1300039291381836}, 'reconstruction_quality': {'explained_variance': 0.050134219229221344, 'mse': 20.506107330322266, 'cossim': 0.8911861777305603}, 'shrinkage': {'l2_norm_in': 44.7835693359375, 'l2_norm_out': 1.5172969102859497, 'l2_ratio': 0.0323365293443203, 'relative_reconstruction_bias': 0.03905710205435753}, 'sparsity': {'l0': 3012.400146484375, 'l1': 2371.822265625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9816155557366733, 'ce_loss_with_ablation': 8.337739944458008, 'ce_loss_with_sae': 2.212841749191284, 'ce_loss_without_sae': 2.098129987716675}, 'reconstruction_quality': {'explained_variance': 0.05816371366381645, 'mse': 21.087133407592773, 'cossim': 0.8955299258232117}, 'shrinkage': {'l2_norm_in': 45.298702239990234, 'l2_norm_out': 1.5474988222122192, 'l2_ratio': 0.03258616849780083, 'relative_reconstruction_bias': 0.03904332220554352}, 'sparsity': {'l0': 3031.24169921875, 'l1': 2404.113037109375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
