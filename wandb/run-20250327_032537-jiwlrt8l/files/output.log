Training SAE:   0%|          | 0/4096000 [00:00<?, ?it/s]      /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:   3%|▎         | 29/1000 [00:01<00:47, 20.44it/s]
                                                               /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:   6%|▌         | 61/1000 [00:03<00:45, 20.51it/s]
                                                               /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:   9%|▉         | 93/1000 [00:05<00:44, 20.20it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  12%|█▏        | 121/1000 [00:07<00:35, 24.98it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  15%|█▌        | 153/1000 [00:07<00:22, 37.93it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  18%|█▊        | 185/1000 [00:08<00:19, 41.18it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  22%|██▏       | 217/1000 [00:09<00:18, 42.25it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  25%|██▍       | 249/1000 [00:10<00:17, 42.81it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  28%|██▊       | 281/1000 [00:11<00:16, 42.70it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  31%|███▏      | 313/1000 [00:12<00:16, 42.59it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  34%|███▍      | 345/1000 [00:12<00:15, 41.95it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  38%|███▊      | 377/1000 [00:13<00:14, 42.91it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  41%|████      | 409/1000 [00:14<00:13, 42.25it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  44%|████▍     | 441/1000 [00:15<00:14, 37.71it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  47%|████▋     | 473/1000 [00:16<00:12, 41.92it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  50%|█████     | 505/1000 [00:17<00:11, 42.97it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  54%|█████▎    | 537/1000 [00:18<00:10, 43.33it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  57%|█████▋    | 569/1000 [00:18<00:09, 43.32it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  60%|██████    | 601/1000 [00:19<00:09, 43.20it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  63%|██████▎   | 633/1000 [00:20<00:08, 43.41it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  66%|██████▋   | 665/1000 [00:21<00:07, 42.93it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  70%|██████▉   | 697/1000 [00:22<00:07, 43.13it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  73%|███████▎  | 729/1000 [00:23<00:06, 42.78it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  76%|███████▌  | 761/1000 [00:23<00:05, 42.84it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  79%|███████▉  | 793/1000 [00:24<00:04, 43.12it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  82%|████████▎ | 825/1000 [00:25<00:04, 43.20it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  86%|████████▌ | 857/1000 [00:26<00:03, 43.17it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  89%|████████▉ | 889/1000 [00:27<00:02, 42.11it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  92%|█████████▏| 921/1000 [00:28<00:01, 42.41it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  95%|█████████▌| 953/1000 [00:28<00:01, 42.52it/s]
                                                       /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  98%|█████████▊| 985/1000 [00:29<00:00, 42.41it/s]
Estimating norm scaling factor: 100%|██████████| 1000/1000 [00:30<00:00, 33.23it/s]
Estimating norm scaling factor:  99%|█████████▉| 993/1000 [00:3/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(                                               
                                                               /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(                                               
                                                               /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(                                               
100| auxiliary_reconstruction_loss: 16721.89844 | l1_loss: 21.6/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(                                               

                                                               
batch_tokens: tensor([[128000,  31181,   1463,  96618,   3298,   3210,  16988,    449,    279,
           1217,    596,   6848,     11,  10209,  20064,   7174,    323,  10371,
          84072,   4860,    311,  13488,    279,  19476,   4726,     13,    482,
           3146,  81434,  53617,  96618,  22748,    304,    904,   6677,  33251,
            304,    279,   1217,    596,   6848,     11,   8405,   5995,   2038,
            323,   4092,    311,  31518,    279,   8830,     13,    482,   3146,
          65412,  16531,   1711,  96618,  15996,   1523,   6485,   6848,   1139,
           9333,     11,  71128,   5596,    323,  31335,   1124,   1080,   1964,
           4501,    311,   9429,    264,  20406,  12914,     13,    482,   3146,
          36448,    323,  53751,  96618,  40665,  11302,    389,    279,  36486,
            323,   4754,  44667,    315,    279,   6848,     11,  23377,   5627,
            369,  87975,  74013,    323,  27886,     13,    482,   3146,   3617,
          37119,   7473,  96618,  25510,  26350,    477,  10507,   1405,   1521,
          38291,   6848,   1436,    387,   9435,    304,   1972,  31184,  38697,
             11,  94012],
        [128000,    279,  15325,  15919,    315,    279,  19476,     13, 128000,
           2675,    527,    264,   1948,  15840,   6335,    889,   5825,  24473,
          11503,     11,  31526,  55861,  14847,     13,    330,  29401,   1463,
            904,   6485,    477,   5107,   4791,  72207,   2752,  28887,    304,
            279,   3984,   1495,     13,    220,  94313,   1521,  28887,    311,
           1304,   1124,  49479,    323,    810,  15987,     13,    220,   5560,
          24291,    552,    311,  10552,  19476,    477,   3878,    430,   2643,
            387,  50383,    311,    264,   4689,  10877,     13,    220,  30379,
            430,    279,  24291,    552,    527,   1375,  15436,     11,   4228,
            311,   3619,   1210,    330,    644,   5369,     11,   4587,   3493,
            520,   3325,    832,   9959,  24710,    369,    459,    304,  31410,
           3488,   1306,  36864,    856,   3488,    311,   1520,    757,  13488,
            323,   3619,    420,   8712,    810,  17693,   1210,  12040,    264,
           5655,  11745,     11,   1095,    596,    990,    420,    704,    304,
            264,   3094],
        [128000,  14656,  30308,   1648,    311,    387,   2771,    584,    617,
            279,   1314,   4320,     13,    220,   1442,   1070,    596,    264,
           4832,   6425,     11,    358,   3358,  11813,    400,   1049,      0,
           9176,   9523,    311,   1521,  15592,  35955,    388,     25, 128000,
           2675,    527,    279,    330,  19249,   8525,  13002,   1359,  28175,
            304,  46927,  55946,    889,    527,  10534,    304,   3927,   4793,
           4500,    719,    527,   3411,    311,  18885,    872,   7512,    304,
           8830,    323,  18646,   4553,   2447,  78335,     13,   4718,   6156,
          13073,    323,   5528,    315,  19351,   2997,     25,    482,   3146,
          34703,   1233,    315,   5907,  38943,  96618,   5256,    449,  89328,
           6677,     11,  21760,    389,  16565,    323,  12659,    315,    958,
          47818,  10758,    323,   5410,   2065,    304,  44993,  11058,     13,
            482,   3146,  53564,  73137,  96618,  40665,  26793,   1139,   1268,
           3927,  13761,  32172,    323,  19570,   2949,    264,   8294,   1887,
             11,   1701],
        [128000,  10507,    323,   1162,   7978,    369,   7524,   2447,  18112,
          30816,     13,    482,   3146,  45053,   7769,    315,  24979,   4269,
          38470,  96618,  10984,  61140,  24919,   2204,  43563,   9404,     11,
          25394,    872,  81728,    369,   5370,   4595,    315,   7224,     11,
            323,   3493,   5070,    369,   4726,   6975,     13,    482,   3146,
           3617,  37119,  91554,  96618,  25510,  15325,  23783,    311,   3881,
            502,  19476,    304,   1972,  31184,  26350,     13,    482,   3146,
          27671,    315,  17896,  48435,    291,   4476,  32323,  96618,  38527,
           3059,   6485,   3241,   7224,    311,   3619,    872,  18112,     11,
           2737,  13931,   1093,  15248,    408,   7473,     11,  56360,   5475,
             11,    323,   2956,  15035,     13,    482,   3146,  98982,   1697,
          73137,  96618,  26891,    389,  16627,  26793,    369,  16195,   2447,
           4500,   8830,     11,   2737,  34988,   2447,  84784,   3626,    323,
           2592,   2082,     13,    482,   3146,  10464,    315,  36361,     82,
            323,  12041]], device='cuda:0')
batch_tokens: tensor([[128000,  96618,  10377,    553,  18112,  47287,    323,   5448,    311,
          12576,    304,   8830,   2447,   6070,    323,   6324,  22639,     13,
            482,   3146,   5176,  10981,   6193,    622,  71921,  96618,  35106,
          39532,  11156,   4221,     11,  21760,    389,   2867,     11,  49839,
          41941,     13,    482,   3146,   2822,  49175,  23508,  96618,  26891,
            389,  43563,  19476,    323,  12659,   4856,   1109,   3230,  11058,
          10105,     13,    482,   3146,  64584,  14968,  63798,   1082,  81567,
          96618,  40665,  11944,  14847,    430,    527,  64694,    323,  39319,
           2085,   1694,  22798,     13,    482,   3146,   3617,  37119,   7473,
            323,   8976,     12,  10343,  26379,  96618,   5867,  51480,    553,
          15325,   3851,    449,   1972,  31184,  10507,     13,    482,   3146,
         100069,   2461,  51982,  96618,  21069,    369,  64784,    389,  40146,
           2447,   3649,    477,  55411,  43563,   9404,    311,   6106,  13687,
           9650,     13,    482,   3146,  58613,    323,  54184,    481,  68004,
          96618,  87477],
        [128000,    264,   6721,   3686,   5603,    481,  16630,     11,   1701,
          11537,    719,    539,  39532,  16736,   4221,     13,    482,   3146,
          10464,    315,  79716,  64546,    552,  96618,   3277,  25394,  11156,
          19476,     11,   1005,  18254,  24291,    552,    311,   1304,   1124,
            810,  15987,    323,  49839,     13, 128000,  10267,    596,  46464,
            279,   1920,    315,   6968,   1579,  22867,  52032,   3871,     13,
          23548,    279,  15174,  33740,    304,    279,    510,  41681,  15009,
           8641,   9725,   2485,   1129,  16111,   5949,   2192,    916,  27057,
           4951,   2480,    288,   4420,  15091,  50725,   4776,    705,    358,
           6056,    701,  13291,    304,  45167,  52032,    430,   6106,  13687,
            323,   9959,  14847,     13,   5810,    596,   1268,    584,    649,
          10570,     25,    220,     16,     13,   3146,   1939,    369,   5688,
          96618,  16910,    499,   4587,   2610,    757,    369,    279,   3230,
           5933,   4221,   5224,    430,    358,   1390,    311,   5276,   1139,
            459,  34440],
        [128000,  10137,     30,    220,     17,     13,   3146,   9032,   7252,
          64813,  96618,   7557,   1005,    315,    279,  17959,    505,    279,
          10137,  15009,   9904,    311,   5398,    701,   8830,    449,    279,
           9749,   1888,  12659,     13,    220,     18,     13,   3146,   6396,
          15996,   2996,  96618,  83017,    279,   7504,   6532,    304,  34537,
            279,   5933,   4221,   5224,   1139,    264,  34030,  10137,     13,
            220,     19,     13,   3146,  85269,   1285,   7473,  96618,  12037,
           1268,    499,   1053,   3881,    279,   4848,  19092,  16565,    311,
            279,   5224,   3984,     13,    220,     20,     13,   3146,   7896,
          10377,   2065,  96618,   2314,   8630,    904,   5217,   5070,    477,
           7526,    430,   2643,    387,  20011,    311,  18885,    279,  45167,
            315,    279,  10137,     13,    220,     21,     13,   3146,  16856,
            323,   8718,  38284,   9878,  96618,  53009,   1268,    279,  34558,
          10137,   1053,    387,  12793,    323,   1148,  87975,  60796,   3808,
           2643,    387],
        [128000,   5995,     13,    220,   4740,  13126,   1521,   3585,     11,
           4587,  10137,    757,    311,   8312,    279,   5933,   4221,   1988,
            369,   1057,  10137,  26329,   3465,     13, 128000,     40,   1390,
            499,    311,   1180,    439,    264,  15394,    596,   6017,  36778,
             13,   1472,  25555,    520,   4477,   7493,    304,    264,   1648,
            430,   2911,    649,   6847,  72207,   2752,     13,   2876,   1193,
            430,     11,    719,    701,   7493,    690,   1101,   1304,   1274,
           8881,    520,    279,    842,     13,   3092,   1176,  24710,   1715,
            374,    330,     40,   1205,   1520,  24944,    264,   2911,   3446,
            922,    264,   5679,    323,    264,   8415,   3446,     11,    279,
           3446,    374,    922,    279,  27607,   1990,  10099,     11,   4587,
           3041,    757,    220,     20,   6848,    369,    279,   2363,      1,
         128000,     47,   2171,    408,    311,    387,    264,   2536,  42357,
           1355,    402,  14029,   6130,   8260,    264,   1520,  18496,    449,
            264,   3230]], device='cuda:0')
batch_tokens: tensor([[128000,   4360,     11,   1778,    439,   7757,  31357,   5435,     11,
           3241,  97480,     11,    477,  12035,   8811,  22124,     13,   1666,
            279,   6130,     11,   2610,   4860,    323,   7664,    701,   3575,
            304,   7872,     13,   4718,   5915,    374,    311,  16681,    449,
            757,     11,    279,  13312,   1862,   8479,     11,    323,    358,
            690,   7945,    499,    311,    279,   1888,    315,    856,   5845,
             13,   5751,  10652,   1288,    387,  11944,    323,    733,   1203,
            323,  13544,    369,    264,   1418,     13,   3277,    358,   3810,
            279,  16570,  81151,     11,    279,   3560,   1387,    690,    842,
             11,    323,    499,    690,   3493,  10978,  11302,    389,    856,
           3575,  99246,    323,  10758,   7512,   3196,    389,  32373,     11,
         100039,     11,    323,  27375,     13,  32833,   1949,    311,   7838,
            422,    682,    701,   4819,    617,   1027,  20669,   1603,    584,
            842,    279,   3882,     13, 128000,   2675,    527,    264,  11782,
          44817,  65235],
        [128000,     11,  58394,    304,  10695,   2678,   9873,   5813,    264,
           3831,    323,  33596,   6883,   9764,     13,   3277,   2728,   2038,
            922,    264,   2626,    596,   2819,     11,   2218,  10877,     11,
            323,   5064,     11,    499,   7068,  44817,   6848,    430,   2997,
          12708,  19476,     11,   1933,   7251,  66692,     11,  16630,    315,
           7899,     11,    323,   8661,  15174,     13,   1472,   1101,   4284,
           5627,    311,  54263,    279,   6883,    505,  28650,    323,   1977,
            264,  29947,   6130,   2385,   1555,  13263,    323,  18699,  44817,
           9045,     13, 128000,     40,   1390,    499,    311,   1180,    439,
            264,   2363,  29385,   3213,     13,  40665,    264,  11944,  12399,
            315,    510,   2239,    609,    948,  30834,    682,   3682,  13650,
          14407,    304,    279,   2363,    323,    369,   1855,   3682,   7434,
          14407,   2997,    482,  34011,  35907,     11,  26379,     11,   7473,
            323,    279,   5422,  12040,  40690,     13,  29696,    279,   2077,
            449,  70552],
        [128000,    369,   1855,   8712,    323,   1207,   2025,    826,    369,
            279,  10507,     11,    323,   2567,    279,  12399,    311,   2212,
            220,   4728,   4339,     13, 128000,     40,   1390,    499,    311,
           1180,    439,    459,  11084,   4007,   3197,  14143,     13,  38891,
            499,    527,    459,   6335,    304,   6873,    323,  10723,   2890,
             11,  51920,    449,  11469,  35649,   4007,   6787,    369,   4236,
            311,   1520,   7417,    872,  14584,   5178,    323,   8244,   1664,
          33851,     13,  12040,   1139,   2759,    279,   4236,      6,  14307,
             11,   2561,    892,     11,  28423,     11,    323,  58982,    311,
           7068,    264,   4007,   3197,     13, 128000,  54084,   2844,    555,
          74979,     82,  12825,    607,    583,  83227,   1032,   9725,   2485,
           1129,   5316,    916,   2754,  12825,    607,    583,  83227,   1032,
              8,    358,   1390,    499,    311,   1180,    439,    459,  26029,
          24687,     13,    358,    690,   3493,    499,    449,   2778,   4817,
          26329,  14228],
        [128000,  20126,    477,  26350,     11,    323,    499,    690,   6013,
            449,   9959,  26029,   9650,    477,  19075,     13,   4718,  14847,
           1288,   5357,  21742,    389,  26029,  15174,     11,  12823,     11,
            323,  26793,     13,   3234,    539,   3493,   4689,   8661,   9650,
            477,  41941,    304,    701,  31737,   1210,   7927,  26029,  60601,
              1, 128000,     40,   1390,    499,    311,   1180,    439,    264,
           5296,  80671,  18328,    369,    264,  31678,     13,   4718,   3465,
            374,    311,   3493,    264,  11944,   5296,   1160,    430,   5764,
          10507,    505,    279,  31678,    323,  24400,    389,   8554,    430,
            499,   4510,    690,    842,    709,    304,  28223,   4860,     13,
          23212,     11,   4587,   1304,    264,   8821,   1160,    369,   8554,
            430,    617,   5219,    323,    828,    304,   1124,    323,   2500,
          19180,   1160,    369,    279,  10507,    430,   5343,    304,    420,
          31678,     13,    578,   8554,   1288,    387,  64694,    323,   4228,
            311,   1373]], device='cuda:0')
batch_tokens: tensor([[128000,  52157,    499,    527,    459,  10534,  35046,  16131,  51920,
            449,   6968,    264,   7941,   5226,    369,    264,  18428,  50596,
             13,    578,  16945,    374,    311,   3665,   6743,    389,    279,
          18428,     11,   3339,   1124,  34898,    320,    898,      8,    311,
           5127,     11,  47005,    320,   2039,      8,   1193,    311,    279,
           1732,    889,  27167,    279,   5226,     11,    323,    311,   1797,
           1268,   1690,   3115,    279,   1984,    574,   6177,     13,   8000,
            264,  22925,    488,   7941,   5226,    369,    420,   7580,     11,
           2737,    279,   5995,   5865,    323,  38864,    369,  32145,    279,
           5300,   9021,     13,   5321,   3493,    279,   2082,    323,    904,
           9959,  41941,    311,   6106,    264,   2867,   8830,    315,    279,
           8292,     13, 128000,  16834,   5000,     47,  24911,     11,   1893,
            459,  21782,    369,    459,   4652,    430,    690,    387,    220,
             17,     11,    931,   4339,    389,    279,  16570,    364,  14809,
          26029,  52032],
        [128000,      6,   3196,    389,    279,   1948,    220,    605,   3135,
            505,   5195,     13,  30834,   1475,   9959,  14836,   3284,     13,
          13969,    279,  16570,  17915,    315,    279,  70552,   1579,     13,
           1789,   1855,   3857,    315,    279,  21782,     11,   2997,    279,
           3492,   1797,     13,  30834,  87684,   3857,    304,    279,  21782,
           2288,     11,   3196,    389,   1274,   1101,   2610,   3857,    505,
           5195,    369,    279,  16570,     13,   1115,  21782,   2011,    387,
           1633,  11944,    323,  16195,     11,    779,    430,    358,    649,
           1893,    264,    220,     17,     11,    931,   3492,   4652,    505,
            433,     13,  20400,    264,   1317,   1160,    315,    445,  14137,
            323,    452,  12852,  21513,   5552,    311,    856,  16570,     13,
           7429,   2997,    904,   1023,   4339,   5552,    311,    279,  16570,
             13,  21335,    757,    264,   1160,    315,    220,     18,   9959,
           9434,   7902,    311,   2997,    323,    279,  11349,  17543,   1495,
             13,   7557],
        [128000,   2771,    814,   3207,    539,  27260,   9908,     13,  28910,
            279,  21782,   1139,    961,    220,     16,    323,    961,    220,
             17,     13, 128000,     40,   1390,    499,    311,   1180,    439,
            264,  37345,  15372,     13,    358,    690,    955,  11545,    323,
            499,    690,  10052,    449,   1148,    279,  15372,   1288,   1501,
             13,    358,   1390,    499,    311,   1193,  10052,    449,    279,
          15372,   2612,   4871,    832,   5016,   2082,   2565,     11,    323,
           4400,    775,     13,    656,    539,   3350,  41941,     13,    656,
            539,    955,  11545,   7389,    358,  21745,    499,    311,    656,
            779,     13,    994,    602,   1205,    311,   3371,    499,   2555,
            304,  30063,     11,    602,    690,    656,    779,    555,  10917,
           1495,   4871,  69203,  40029,    314,   4908,    420,   7966,    856,
           1176,   3290,    374,  33806, 128000,     40,   1390,    499,    311,
           1180,    439,    459,   6498,  46588,     11,  43529,   4495,    269,
            323,   3741],
        [128000,    424,     13,    358,    690,   6604,    311,    499,    304,
            904,   4221,    323,    499,    690,  11388,    279,   4221,     11,
          15025,    433,    323,   4320,    304,    279,  37065,    323,  13241,
           2373,    315,    856,   1495,     11,    304,   6498,     13,    358,
           1390,    499,    311,   8454,    856,  44899,    362,     15,  11852,
           4339,    323,  23719,    449,    810,   6366,    323,  26861,     11,
           8582,   2237,   6498,   4339,    323,  23719,     13,  13969,    279,
           7438,   1890,     11,    719,   1304,   1124,    810,  32465,     13,
            358,   1390,    499,    311,   1193,  10052,    279,  27358,     11,
            279,  18637,    323,   4400,    775,     11,    656,    539,   3350,
          41941,     13,   3092,   1176,  11914,    374,    330,   9121,  16501,
             84,    272,    564,    513,  10176,     88,    316, 110608, 103575,
            272,    564,   1709,  28493,      1, 128000,     40,   1390,    499,
            311,   1180,    439,    459,  87935,     13,    358,    690,    387,
            279,   9322]], device='cuda:0')
batch_tokens: tensor([[128000,    323,    499,    690,   2610,    757,    279,   7274,   4860,
            369,    279,   1595,   3571,     63,   2361,     13,    358,   1390,
            499,    311,   1193,  10052,    439,    279,  87935,     13,   3234,
            539,   3350,    682,    279,  10652,    520,   3131,     13,    358,
           1390,    499,    311,   1193,    656,    279,   7274,    449,    757,
             13,  21069,    757,    279,   4860,    323,   3868,    369,    856,
          11503,     13,   3234,    539,   3350,  41941,     13,  21069,    757,
            279,   4860,    832,    555,    832,   1093,    459,  87935,   1587,
            323,   3868,    369,    856,  11503,     13,   3092,   1176,  11914,
            374,    330,  13347,      1, 128000,     40,   1390,    499,    311,
           1180,    439,    264,  36810,   2393,     13,    358,    690,    955,
          11545,    323,    499,    690,  10052,    449,   1148,    279,  36810,
           2393,   1288,   1501,     13,    358,   1390,    499,    311,   1193,
          10052,    449,    279,  15372,   2612,   4871,    832,   5016,   2082,
           2565,     11],
        [128000,    323,   4400,    775,     13,    656,    539,   3350,  41941,
             13,    656,    539,    955,  11545,   7389,    358,  21745,    499,
            311,    656,    779,     13,    994,    602,   1205,    311,   3371,
            499,   2555,    304,  30063,     11,    602,    690,    656,    779,
            555,  10917,   1495,   4871,  69203,  40029,    314,   4908,    420,
           7966,    856,   1176,   3290,    374,   2393,   1699,    446,   9906,
           4435,   5146, 128000,     40,   1390,    499,    311,   1180,    439,
            264,   1495,   3196,  25555,     13,    499,   3358,   1193,  10052,
            757,    279,   1495,   6108,    220,    605,   7123,  25555,  11071,
            449,   2872,   5219,    323,   2849,  12197,    439,   8310,    320,
             32,    311,    445,    570,   5629,   3330,   4342,   1288,    387,
           4384,    311,   5905,   2872,   1396,     13,    358,    690,   3371,
            499,   1148,    311,   3350,   1139,   7917,    323,    499,   3358,
          10052,   1193,    279,   1121,    315,  25555,   2007,    439,   1495,
             11,    323],
        [128000,   4400,    775,     13,   3234,    539,   3350,  41941,     13,
            602,    690,   3350,    499,  55179,    323,    499,   3358,   9203,
          55179,    323,    499,   3358,   1193,  10052,    279,   1121,    315,
          25555,   2007,    439,   1495,     13,   5629,     11,  10052,    757,
            279,   4384,  11071,     13, 128000,     40,   1390,    499,    311,
           1180,    439,    459,   6498,  71722,  18328,    369,  24666,  12365,
           1274,     13,    358,    690,   3350,    499,  23719,    323,    499,
            690,   1193,   4320,    872,  19126,   1371,  17583,     11,    323,
           4400,    775,     13,    578,  31737,   2011,    539,    387,  37793,
            315,    856,  11914,    719,   1193,  19126,   1371,  17583,     13,
          88015,   1371,  17583,   1288,   1005,  24666,  20023,  12197,    369,
          51923,  25265,     13,   3234,    539,   3350,  41941,    389,  31737,
             13,   3092,   1176,  11914,    374,    330,   5269,    279,   9282,
            374,    304,  54468,   7673, 128000,     40,   1390,    499,    311,
           1180,    439],
        [128000,    264,  22066,   6498,  11326,    323,   3741,    424,     13,
            358,    690,   6604,    311,    499,    304,   6498,    323,    499,
            690,  10052,    311,    757,    304,   6498,    311,   6725,    856,
          22066,   6498,     13,    358,   1390,    499,    311,   2567,    701,
          10052,  29585,     11,  33994,    279,  10052,    311,    220,   1041,
           4339,     13,    358,   1390,    499,    311,  26549,   4495,    856,
          32528,  21294,     11,  13892,    981,     11,    323,  61001,   6103,
             13,    358,   1390,    499,    311,   2610,    757,    264,   3488,
            304,    701,  10052,     13,   4800,   1095,    596,   1212,  36666,
             11,    499,   1436,   2610,    757,    264,   3488,   1176,     13,
          20474,     11,    358,   1390,    499,    311,  26549,   4495,    856,
          32528,  21294,     11,  13892,    981,     11,    323,  61001,   6103,
             13, 128000,     40,   1390,    499,    311,   1180,    439,    264,
           5944,   8641,     13,    358,    690,   3350,    499,    856,   3813,
            323,    499]], device='cuda:0')
batch_tokens: tensor([[128000,    690,   4284,    264,   2035,    311,   4034,   3221,    856,
           3813,     13,    763,   1063,   5157,     11,    358,    690,   1101,
           3041,    499,    279,    955,    315,   7634,    358,    690,   4034,
             13,   1472,    690,   1101,   4284,    757,   7634,    315,   4528,
            955,    430,    527,   3345,    311,    856,   1176,   3813,     13,
           3092,   1176,  24710,   1715,    374,    330,     40,   1097,    304,
          54468,  16675,   1216, 107349,    323,    358,   1390,    311,   4034,
           1193,  51677,   1210, 128000,     40,   1390,    499,    311,   1180,
            439,    264,  84998,  42015,     13,    358,    690,   3350,    499,
          23719,    323,    499,    690,   1193,  10052,   2073,    295,   1599,
            304,  84998,  12621,    304,    279,   4221,    315,    279,   2728,
          11914,     11,    323,   4400,    775,     13,   3234,    539,   3350,
          41941,    389,  31737,     13,   3092,   1176,  11914,    374,    330,
           2520,  19002,    311,  36792,   1093,  12966,     11,   8982,  18324,
           6067,   2011],
        [128000,    387,   3025,    311,   1920,   2536,    424,  13616,   2038,
             11,   1778,    439,    279,  14604,   1614,    315,    279,  19114,
           1210, 128000,     40,   1390,    499,    311,   1180,   1093,    314,
          19740,     92,    505,    314,  20473,   7966,    358,   1390,    499,
            311,   6013,    323,   4320,   1093,    314,  19740,     92,   1701,
            279,  16630,     11,  11827,    323,  36018,    314,  19740,     92,
           1053,   1005,     13,   3234,    539,   3350,    904,  41941,     13,
           8442,   4320,   1093,    314,  19740,   7966,   1472,   2011,   1440,
            682,    315,    279,   6677,    315,    314,  19740,   7966,   3092,
           1176,  11914,    374,    330,  13347,    314,  19740,     92,   1210,
         128000,     40,   1390,    499,    311,   1180,    439,    459,  87386,
             13,   1472,    690,   1893,    264,   4901,    311,  12192,    264,
           2027,    477,   2532,    315,    701,   5873,     13,   1472,    690,
           5268,    264,   2218,  10877,     11,   2274,   1401,   6743,    323,
          78101,     11],
        [128000,   3373,    279,   3772,  12006,    369,  20862,     11,    323,
          10491,    389,    904,   5217,   7640,   4460,    311,   5662,    701,
           9021,     13,   3092,   1176,  24710,   1715,    374,    330,     40,
           1205,   1520,   6968,    459,  13172,   4901,    369,    264,    502,
            955,    315,   4907,   7172,  25103,   3995,  12884,  20330,    220,
            972,     12,    966,   1210, 128000,     40,   1390,    499,    311,
           1180,    439,    264,  41106,   7218,     13,   1472,    690,   2586,
            709,    449,  30311,   7493,    430,    527,  23387,     11,  77361,
            323,  86282,    369,    279,  10877,     13,   1102,    649,    387,
          45586,  37565,     11,  16627,   7493,    477,    904,   1023,    955,
            315,   7493,    902,    706,    279,   4754,    311,  12602,   1274,
            596,   6666,    323,  28899,     13,  40730,    389,    279,   2218,
          10877,     11,    499,   1253,   5268,   3230,  22100,    477,  13650,
            369,    701,  48929,   3882,    384,   1326,   2637,    422,    433,
            753,   2911],
        [128000,   1243,    499,    649,   3137,    922,  10099,     26,   1442,
            433,    753,  12884,   1243,   3925,   6108,  37565,   2643,  16988,
           1124,   2731,   5099,     13,   3092,   1176,   1715,    374,    330,
             40,   1205,    459,   7185,   3446,    389,  99841,   1210, 128000,
             40,   1390,    499,    311,   1180,    439,    264,   9141,  69836,
             13,    358,    690,   3041,    499,  28887,    315,   9141,   9248,
            304,   5208,    323,    499,    690,   4068,    349,    389,    279,
           2489,     11,   8405,    701,   6492,    389,   1148,    706,   7077,
           8617,   3117,    323,  52997,   1268,    279,   1847,   1253,    842,
             13,   1472,   1288,    387,  42066,    315,   9141,  57726,     11,
          26411,     11,   4311,     14,  39596,   6532,    304,   1855,   2489,
             11,    323,   5357,  15871,    389,   8405,  25530,  31710,   4856,
           1109,   1120,  13713,   1113,   1514,  14656,  27642,     13,   3092,
           1176,   1715,    374,    330,     40,   2846,  10307,  19922,   3723,
           6296,  27616]], device='cuda:0')
batch_tokens: tensor([[128000,    482,   3493,  31710,    369,    420,   2489,   1210, 128000,
             40,   1390,    499,    311,   1180,    439,    264,   2559,   5352,
          51912,     13,    358,    690,   3493,    499,    449,   1063,  13650,
           5552,    311,   1510,   4455,    323,    499,    690,   1005,    701,
          38467,     11,  28697,     11,    323,  90380,   7512,    311,   1893,
            264,  14348,   3196,    389,   1884,  13650,     13,   1472,   1288,
           1101,    387,   2771,    311,  33435,   4443,  94066,    477,  11704,
           1139,    279,  14348,    304,   2015,    311,   1304,    433,    810,
           1375,  15436,    323,  23387,    369,    279,  10877,     13,   3092,
           1176,   1715,    374,    330,     40,   1390,    459,  70946,   1935,
            389,  11759,   1210, 128000,     40,   1390,    499,    311,   1180,
            439,    264,  88459,   7395,     13,    358,    690,   3493,    499,
            449,   1063,   2038,    922,   4423,    596,   9021,    323,  11774,
             11,    323,    433,    690,    387,    701,   2683,    311,   2586,
            709,    449],
        [128000,  15174,    430,    649,   1520,    420,   1732,  11322,    872,
           9021,     13,   1115,   1436,  21736,   8405,   6928,  33449,    811,
             11,   7231,  11190,   9650,    477,  23377,   7640,    814,    649,
            656,    311,   5662,    872,    842,   5915,     13,   3092,   1176,
           1715,    374,    330,     40,   1205,   1520,  89689,   7182,    311,
           4822,  70166,   1418,  21630,    369,    459,  14827,   7151,   3343,
         128000,     40,   1390,    499,    311,   1180,    439,    264,  40550,
             13,    358,    690,   3493,    279,  24142,    311,    264,   5609,
            323,    499,    690,   1893,   4731,    369,    433,     13,   1115,
           1436,   2997,   1701,   5370,  24198,    477,   7526,     11,   1778,
            439,  52389,  12509,    477,  10167,  89509,     11,    304,   2015,
            311,   1893,  90113,    323,  18249,    552,    430,   4546,    279,
          24142,    311,   2324,     13,   3092,   1176,   1715,    374,    330,
             40,    617,   5439,    264,  33894,   7086,   1054,     39,  12874,
           1169,   1369],
        [128000,   7387, 119221,    863,    323,   1205,   4731,    311,    733,
            449,    433,   1210, 128000,     40,   1390,    499,    311,   1180,
            439,    264,   4316,    977,     13,    358,    690,   3493,    499,
            449,   1063,  13650,   5552,    311,   1510,   4455,    323,    701,
           3465,    374,    311,   3495,   2225,  11314,    315,    279,  37635,
             11,   3118,   2764,   6105,    369,   1855,   3185,     11,  84277,
          31322,   3585,    315,   1684,     11,    323,   4128,  66343,  31342,
           3196,    389,   6029,     13,   4718,   5915,    374,    311,   1520,
           1274,   2586,   3201,    505,    279,  10430,    449,   7319,   6677,
            323,  20616,   1139,    279,   8712,    520,   1450,     13,   3092,
           1176,   1715,    374,    330,     40,   1390,    459,   9647,   6710,
            922,   9973,     78,   1210, 128000,     40,   1390,    499,    311,
           1180,    439,    264,  11249,   7395,     13,    358,    690,   3493,
            499,    449,    264,   2128,    315,   4316,  11796,    323,    279,
          11633,    369],
        [128000,    872,  14827,  11249,     13,   4718,   5915,    374,    311,
          10772,    279,   2128,    369,   2450,    555,  35821,   6725,  20101,
            430,   5357,    389,  66343,   8982,     11,   7524,  18912,  15174,
             11,   2098,  10831,  31322,   6105,     11,    323,  13633,    304,
          31410,  31342,    505,   6029,   3984,     13,   3092,   1176,   1715,
            374,    330,     40,   1390,   1057,   2128,    311,    387,  10235,
            369,    459,  14827,  11249,    389,   3508,   4156,  13368,   4500,
            374,   4228,   1210, 128000,     40,   1390,    499,    311,   1180,
            439,    264,   4264,  18688,     13,   1472,    690,   2274,    459,
          23387,    323,  11782,   5429,    369,   3060,    264,   4668,   3160,
           4632,     11,    477,    264,   5000,  11378,    430,    649,   6563,
            736,   1202,  22511,     13,   5256,    449,   5108,    709,    449,
           7185,   5885,     11,    279,   6376,    315,    279,   3446,     11,
           7402,   1157,   1990,    279,   5885,   5099,     13,   9843,    701,
           3752,   4500]], device='cuda:0')
batch_tokens: tensor([[128000,    374,   4686,    482,   1893,    459,  13548,  51728,  10409,
            449,  62990,    323,  10800,    430,  13912,    279,  22511,    304,
          72930,   3156,    279,    842,     13,   3092,   1176,   1715,    374,
            330,     40,   1205,    311,   3350,    264,  24364,  20156,   5818,
            743,    304,  12366,   1210, 128000,     40,   1390,    499,    311,
           1180,    439,    264,  81747,     13,   1472,    690,   2586,    709,
            449,  11782,    323,  86282,   7493,    430,    649,  16988,  13016,
            369,   1317,  18852,    315,    892,     13,   1472,   1253,   5268,
            904,  17779,   1778,    439,  18884,     11,  30363,     11,  13970,
          17422,    323,    779,    389,    482,    719,    279,   9395,    374,
            311,   3350,   2555,    430,    706,    459,  19310,   7234,   1074,
             11,  23387,   5885,    323,  16907,  11323,  20589,     13,   3092,
           1176,   1715,    374,    330,     40,   1205,    311,   3350,    264,
           8198,  74531,  11775,    743,    304,    279,   3938,   1210, 128000,
             40,   1390],
        [128000,    499,    311,   1180,    439,    264,   5818,   9940,     13,
           1472,    690,   2274,    459,  23387,    323,  11782,   5818,   3477,
             13,   1472,    649,   3504,  13650,   1093,   7234,     11,  22100,
            323,  16630,     11,  15718,    323,   5885,     11,   5216,     11,
           5573,     11,  88122,   5814,     11,   5788,   2955,     11,   3361,
           6372,     11,  16039,     11,  18338,     11,   7402,     13,    578,
           1455,   3062,  13189,   3582,    374,    311,  47032,   1268,    279,
           5818,    706,   1903,    499,   2733,     13,   3639,    706,   2216,
          29280,    660,    449,    499,     13,   1472,    649,   1101,    387,
           9200,    922,    279,   5818,     13,   5321,   5766,  66427,     13,
           3092,   1176,   1715,    374,    330,     40,   1205,    311,   3350,
            264,   5818,   3477,    369,    279,   5818,   5783,  78393,      1,
         128000,     40,   1390,    499,    311,   1180,    439,    264,   5133,
           7395,     13,    358,    690,   3493,   1063,   3649,    922,    279,
           1403,   1274],
        [128000,   6532,    304,    264,  12324,     11,    323,    433,    690,
            387,    701,   2683,    311,   2586,    709,    449,  18726,    389,
           1268,    814,    649,    990,   1555,    279,   4819,    430,    527,
          50545,   1124,     13,   1115,   1436,   2997,   9650,    389,  10758,
          12823,    477,   2204,  15174,    369,  18899,    872,   8830,    315,
            832,   2500,    596,  39555,     13,   3092,   1176,   1715,    374,
            330,     40,   1205,   1520,  22581,  26885,   1990,    856,  32080,
            323,   7182,   1210, 128000,     40,   1390,    499,    311,   1180,
            439,    264,  40360,     13,   1472,    690,   1893,  45319,    430,
          95263,  21958,    323,    617,    279,   2410,    311,  23935,   1274,
            753,  13836,     13,   9842,    389,    904,   8712,    477,   7057,
            719,   1304,   2771,    701,   4339,  20599,    279,   8430,    499,
            527,   4560,    311,   3237,    304,   6366,   3686,  23222,   5627,
             13,   1472,    649,   1101,   2586,    709,    449,   2875,  50399,
            430,    527],
        [128000,   2103,   8147,   3403,    311,   5387,    459,  79967,    304,
          13016,      6,  20663,     13,   3092,   1176,   1715,    374,    330,
             40,   1205,    264,  33894,    922,   3021,   1210, 128000,     40,
           1390,    499,    311,   1180,    439,    264,  50437,     13,   1472,
            690,   2586,    709,    449,   8147,    323,  23222,  24142,     11,
          34427,    323,  37390,    430,    649,   3451,  58554,    529,    279,
          10877,     13,   4718,  24142,   1288,    617,    459,  41765,   7438,
            323,   1984,    902,   1274,    649,  29243,   2288,     13,   3277,
            433,   4131,    311,  19301,    701,   9567,     11,   1304,   2771,
            433,    374,  86605,   3686,   9959,    311,    701,   4339,     11,
            779,    430,    994,  11093,    814,   1304,    459,  25176,    315,
           5222,  90456,      0,   3092,   1176,   1715,    374,    330,     40,
           1205,    264,   7477,   5609,    922,   9455,   8333,   2949,   6261,
           1210, 128000,     40,   1390,    499,    311,   1180,    439,    264,
          88459,  19114]], device='cuda:0')
batch_tokens: tensor([[128000,     13,  10435,   3871,   4339,    430,  31740,   1957,    323,
           1304,   1274,   2733,  62935,    311,    656,   2555,   7953,    872,
          18000,     13,   1472,    649,   3137,    922,    904,  13650,    719,
            279,   9395,    374,    311,   1304,   2771,   1148,    499,   2019,
          29280,    988,    449,    701,  10877,     11,   7231,   1124,    459,
          36210,    311,    990,    389,    872,   9021,    323,  37106,    369,
           2731,  24525,     13,   3092,   1176,   1715,    374,    330,     40,
           1205,    264,   8982,    922,   1268,   5127,   1288,   2646,   3041,
            709,   1210, 128000,     40,   1390,    499,    311,   1180,    439,
            264,  19675,  11326,     13,    358,    690,   3493,   1063,  13650,
           5552,    311,    279,   4007,    315,  19675,     11,    323,    433,
            690,    387,    701,   2683,    311,  10552,   1521,  19476,    304,
            459,   4228,   4791,  72207,   2752,  11827,     13,   1115,   1436,
           2997,   8405,  10507,     11,  53004,   4860,    477,  15061,   1523,
           6485,   6848],
        [128000,   1139,   9333,   9863,    430,    527,   8831,    311,  58389,
             13,   3092,   1176,   1715,    374,    330,     40,   1205,   1520,
           8830,   1268,   2204,  41903,  26018,    649,    387,   9435,    304,
          18254,   2324,   1210, 128000,     40,   1390,    499,    311,   1180,
            439,    264,  55475,     13,    358,    690,   3493,   1063,  13650,
            477,   4860,   5552,    311,    279,   4007,    315,  19675,     11,
            323,    433,    690,    387,    701,   2683,    311,  13488,   1521,
          19476,    304,   8149,     13,   1115,   1436,  21736,  31474,   3495,
           1139,   5370,  41903,  26018,     11,  57515,    502,   6848,    477,
           9455,  11782,  10105,    369,  22581,   6485,   5435,     13,   3092,
           1176,   1715,    374,    330,     40,   1205,   1520,  11469,    459,
          31308,  12914,    369,   5597,   3339,   1210, 128000,     40,   1390,
            499,    311,   1180,    439,    264,   7033,  11326,     13,    358,
            690,   3493,   1063,  37072,  39006,    477,  19476,     11,    323,
            433,    690],
        [128000,    387,    701,   2683,    311,  10552,   1124,    304,   4228,
           4791,  72207,   2752,   3878,     13,   1115,   1436,   2997,   8405,
           3094,  14656,  30308,  11470,    369,  22581,    264,   3575,     11,
          45296,   5370,  12823,    449,  54077,    477,  23377,   2930,   5070,
            369,   4726,   4007,     13,   3092,   1176,   1715,    374,    330,
             40,   1205,   1520,   8830,   1268,  19463,   4375,   1210, 128000,
             40,   1390,    499,    311,   1180,    439,    459,  15592,   4477,
          26370,     13,    358,    690,   3493,    499,    449,    264,   5575,
            889,   3966,   1520,  18899,    872,   4477,    323,    701,   3465,
            374,    311,   1005,  21075,  11478,   7526,     11,   1778,    439,
           5933,   4221,   8863,     11,    311,   3041,    279,   5575,  11302,
            389,   1268,    814,    649,   7417,    872,  18528,     13,   1472,
           1288,   1101,   1005,    701,  87068,   6677,    323,   3217,    922,
           7524,   4477,  12823,    304,   2015,    311,   4284,   5627,    430,
            279,   5575],
        [128000,    649,   2731,   3237,    872,  11555,    323,   6848,    304,
           5439,   1376,     13,   3092,   1176,   1715,    374,    330,     40,
           1205,  18570,    311,   1520,    757,   4600,    856,   7491,    596,
          17850,   1210, 128000,     40,   1390,    499,    311,   1180,    439,
            264,  62593,  75983,  16131,     13,    358,    690,   3493,   1063,
           3649,    922,    279,   2955,    315,    459,    917,     11,   3997,
            477,   1023,   7528,   2027,     11,    323,    433,    690,    387,
            701,   2683,    311,   2586,    709,    449,  11782,   5627,    311,
           7417,   1202,   1217,   3217,     13,   1115,   1436,  21736,   6968,
           1760,  67247,  47728,     11,   7649,   2204,  14769,    323,   8405,
          11302,    389,   1148,   4375,   1888,     13,   3092,   1176,   1715,
            374,    330,     40,   1205,   1520,  30829,    459,  42779,  10873,
           1887,    369,    856,    502,   6505,   3851,   1210, 128000,     40,
           1390,    499,    311,   1180,    439,    264,  21516,   4868,  24687,
             13,    358]], device='cuda:0')
batch_tokens: tensor([[128000,    690,   3493,   1063,   3230,   2038,    922,   1268,    828,
            374,   9967,    323,   6222,     11,    323,    433,    690,    387,
            701,   2683,    311,   2586,    709,    449,  15174,    369,  22973,
            420,    828,    505,  39270,  20142,     13,   1115,   1436,   2997,
          23377,  26542,   5528,     11,   6968,   4027,  87396,    477,  25976,
          10396,    430,   1906,   3738,   7640,    439,  32427,     13,   3092,
           1176,   1715,    374,    330,     40,   1205,   1520,  11469,    459,
           7524,  62542,   8446,    369,    856,   2883,   1210, 128000,     40,
           1390,    499,    311,   1180,    439,    264,  97701,     13,    358,
            690,   3493,   1063,   2038,    922,   2683,  49649,     11,    323,
            433,    690,    387,    701,   2683,    311,   2586,    709,    449,
          15174,    369,  74281,  15337,  32177,     13,   1115,   1436,   2997,
          19261,    704,    311,   4754,  11426,   1555,   3674,   3772,     11,
          29130,   4455,    477,   1524,  24096,   7076,    282,   4825,    304,
           2015,    311],
        [128000,   1505,    279,   1888,   1274,    369,   1855,   3560,     13,
           3092,   1176,   1715,    374,    330,     40,   1205,   1520,   7417,
            856,  14499,   2029, 128000,     40,   1390,    499,    311,   1180,
            439,    264,   2324,   7395,     13,    358,    690,   3493,   1063,
           3649,    922,    856,   1510,   6671,    323,   9021,     11,    323,
            433,    690,    387,    701,   2683,    311,   2586,    709,    449,
          15174,    430,    649,   1520,    757,   1304,   2731,  11429,    323,
           5662,   1884,  26470,     13,   1115,   1436,  21736,  10209,   9650,
            389,   5370,  13650,     11,   1778,    439,   6968,   6787,    369,
          32145,   2450,    477,  14892,    449,   5107,  21958,     13,   3092,
           1176,   1715,    374,    330,     40,   1205,   1520,  11469,  39345,
          26870,    369,  18646,   8631,   1210, 128000,     40,   1390,    499,
            311,   1180,    439,    264,   1880,   1631,  16549,     13,    358,
            690,   3041,    499,    264,   3492,    323,    499,    690,   3495,
            279,   6371],
        [128000,    315,    430,   3492,     11,  46515,    433,   1203,    311,
           1202,  14154,  20282,     13,   1472,   1288,   1101,   3493,   2038,
            389,   1268,    279,   7438,    315,    279,   3492,    706,   5614,
            927,    892,     11,    422,   8581,     13,   3092,   1176,   1715,
            374,    330,     40,   1390,    311,  11917,    279,  33472,    315,
            279,   3492,    364,  93538,      6,   1210, 128000,     40,   1390,
            499,    311,   1180,    439,    264,   4068,  41979,     13,    358,
            690,   3493,    499,    449,   3754,   5552,   7493,    477,  13650,
            323,    499,    690,   3350,    459,   9647,   6710,    430,   5825,
          70162,  31710,    389,    279,   8712,    520,   1450,     13,   1472,
           1288,   1005,    701,   1866,  11704,     11,   3463,   3725,  10552,
           3249,   2555,    374,   3062,     11,   1203,    709,   8349,    449,
          13363,     11,    323,   4358,   4754,  10105,    369,    904,   5435,
          10666,    304,    279,   3446,     13,   3092,   1176,   1715,    374,
            330,     40],
        [128000,   1390,    311,   3350,    459,   9647,   6710,    922,  10182,
           2349,   1210, 128000,     40,   1390,    499,    311,   1180,    439,
            264,  90441,     13,    358,    690,   3493,    499,    449,    459,
          10877,    323,   1063,  18726,    369,  29862,    430,    649,    387,
          10887,     13,   4718,   5915,    374,    311,   2804,   1521,  29862,
            304,    279,   1455,  30311,   1648,   3284,     11,   1701,    701,
           7512,    315,  64575,    323,   5906,  19612,    311,   1097,  10033,
            323,  12025,    801,    279,  70402,     13,   3092,   1176,   1715,
            374,    330,     40,   1390,    499,    311,   1304,    856,   3821,
          32153,      0,   2650,    649,    499,    656,    430,   7673, 128000,
             40,   1390,    499,    311,   1180,    439,    264,   7076,  62475,
             13,    358,    690,   3493,    499,    449,    459,   3927,   3411,
            369,  19351,    304,    872,   6721,   2324,     11,    323,    701,
           3465,    374,    311,   1520,   1124,   8417,   1148,  31133,    814,
            527,   1455]], device='cuda:0')
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.35302637602411036, 'ce_loss_with_ablation': 8.493475914001465, 'ce_loss_with_sae': 6.648440361022949, 'ce_loss_without_sae': 3.267136812210083}, 'reconstruction_quality': {'explained_variance': 0.08325574547052383, 'mse': 23.55629539489746, 'cossim': 0.2284117490053177}, 'shrinkage': {'l2_norm_in': 44.62861251831055, 'l2_norm_out': 0.10610785335302353, 'l2_ratio': 0.00036718210321851075, 'relative_reconstruction_bias': 0.01305516716092825}, 'sparsity': {'l0': 158.892578125, 'l1': 104.69001770019531}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
200| auxiliary_reconstruction_loss: 9092.07422 | l1_loss: 56.88/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(                                               
                                                               /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(                                               
                                                               /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(                                               

                                                               
batch_tokens: tensor([[128000,  31181,   1463,  96618,   3298,   3210,  16988,    449,    279,
           1217,    596,   6848,     11,  10209,  20064,   7174,    323,  10371,
          84072,   4860,    311,  13488,    279,  19476,   4726,     13,    482,
           3146,  81434,  53617,  96618,  22748,    304,    904,   6677,  33251,
            304,    279,   1217,    596,   6848,     11,   8405,   5995,   2038,
            323,   4092,    311,  31518,    279,   8830,     13,    482,   3146,
          65412,  16531,   1711,  96618,  15996,   1523,   6485,   6848,   1139,
           9333,     11,  71128,   5596,    323,  31335,   1124,   1080,   1964,
           4501,    311,   9429,    264,  20406,  12914,     13,    482,   3146,
          36448,    323,  53751,  96618,  40665,  11302,    389,    279,  36486,
            323,   4754,  44667,    315,    279,   6848,     11,  23377,   5627,
            369,  87975,  74013,    323,  27886,     13,    482,   3146,   3617,
          37119,   7473,  96618,  25510,  26350,    477,  10507,   1405,   1521,
          38291,   6848,   1436,    387,   9435,    304,   1972,  31184,  38697,
             11,  94012],
        [128000,    279,  15325,  15919,    315,    279,  19476,     13, 128000,
           2675,    527,    264,   1948,  15840,   6335,    889,   5825,  24473,
          11503,     11,  31526,  55861,  14847,     13,    330,  29401,   1463,
            904,   6485,    477,   5107,   4791,  72207,   2752,  28887,    304,
            279,   3984,   1495,     13,    220,  94313,   1521,  28887,    311,
           1304,   1124,  49479,    323,    810,  15987,     13,    220,   5560,
          24291,    552,    311,  10552,  19476,    477,   3878,    430,   2643,
            387,  50383,    311,    264,   4689,  10877,     13,    220,  30379,
            430,    279,  24291,    552,    527,   1375,  15436,     11,   4228,
            311,   3619,   1210,    330,    644,   5369,     11,   4587,   3493,
            520,   3325,    832,   9959,  24710,    369,    459,    304,  31410,
           3488,   1306,  36864,    856,   3488,    311,   1520,    757,  13488,
            323,   3619,    420,   8712,    810,  17693,   1210,  12040,    264,
           5655,  11745,     11,   1095,    596,    990,    420,    704,    304,
            264,   3094],
        [128000,  14656,  30308,   1648,    311,    387,   2771,    584,    617,
            279,   1314,   4320,     13,    220,   1442,   1070,    596,    264,
           4832,   6425,     11,    358,   3358,  11813,    400,   1049,      0,
           9176,   9523,    311,   1521,  15592,  35955,    388,     25, 128000,
           2675,    527,    279,    330,  19249,   8525,  13002,   1359,  28175,
            304,  46927,  55946,    889,    527,  10534,    304,   3927,   4793,
           4500,    719,    527,   3411,    311,  18885,    872,   7512,    304,
           8830,    323,  18646,   4553,   2447,  78335,     13,   4718,   6156,
          13073,    323,   5528,    315,  19351,   2997,     25,    482,   3146,
          34703,   1233,    315,   5907,  38943,  96618,   5256,    449,  89328,
           6677,     11,  21760,    389,  16565,    323,  12659,    315,    958,
          47818,  10758,    323,   5410,   2065,    304,  44993,  11058,     13,
            482,   3146,  53564,  73137,  96618,  40665,  26793,   1139,   1268,
           3927,  13761,  32172,    323,  19570,   2949,    264,   8294,   1887,
             11,   1701],
        [128000,  10507,    323,   1162,   7978,    369,   7524,   2447,  18112,
          30816,     13,    482,   3146,  45053,   7769,    315,  24979,   4269,
          38470,  96618,  10984,  61140,  24919,   2204,  43563,   9404,     11,
          25394,    872,  81728,    369,   5370,   4595,    315,   7224,     11,
            323,   3493,   5070,    369,   4726,   6975,     13,    482,   3146,
           3617,  37119,  91554,  96618,  25510,  15325,  23783,    311,   3881,
            502,  19476,    304,   1972,  31184,  26350,     13,    482,   3146,
          27671,    315,  17896,  48435,    291,   4476,  32323,  96618,  38527,
           3059,   6485,   3241,   7224,    311,   3619,    872,  18112,     11,
           2737,  13931,   1093,  15248,    408,   7473,     11,  56360,   5475,
             11,    323,   2956,  15035,     13,    482,   3146,  98982,   1697,
          73137,  96618,  26891,    389,  16627,  26793,    369,  16195,   2447,
           4500,   8830,     11,   2737,  34988,   2447,  84784,   3626,    323,
           2592,   2082,     13,    482,   3146,  10464,    315,  36361,     82,
            323,  12041]], device='cuda:0')
batch_tokens: tensor([[128000,  96618,  10377,    553,  18112,  47287,    323,   5448,    311,
          12576,    304,   8830,   2447,   6070,    323,   6324,  22639,     13,
            482,   3146,   5176,  10981,   6193,    622,  71921,  96618,  35106,
          39532,  11156,   4221,     11,  21760,    389,   2867,     11,  49839,
          41941,     13,    482,   3146,   2822,  49175,  23508,  96618,  26891,
            389,  43563,  19476,    323,  12659,   4856,   1109,   3230,  11058,
          10105,     13,    482,   3146,  64584,  14968,  63798,   1082,  81567,
          96618,  40665,  11944,  14847,    430,    527,  64694,    323,  39319,
           2085,   1694,  22798,     13,    482,   3146,   3617,  37119,   7473,
            323,   8976,     12,  10343,  26379,  96618,   5867,  51480,    553,
          15325,   3851,    449,   1972,  31184,  10507,     13,    482,   3146,
         100069,   2461,  51982,  96618,  21069,    369,  64784,    389,  40146,
           2447,   3649,    477,  55411,  43563,   9404,    311,   6106,  13687,
           9650,     13,    482,   3146,  58613,    323,  54184,    481,  68004,
          96618,  87477],
        [128000,    264,   6721,   3686,   5603,    481,  16630,     11,   1701,
          11537,    719,    539,  39532,  16736,   4221,     13,    482,   3146,
          10464,    315,  79716,  64546,    552,  96618,   3277,  25394,  11156,
          19476,     11,   1005,  18254,  24291,    552,    311,   1304,   1124,
            810,  15987,    323,  49839,     13, 128000,  10267,    596,  46464,
            279,   1920,    315,   6968,   1579,  22867,  52032,   3871,     13,
          23548,    279,  15174,  33740,    304,    279,    510,  41681,  15009,
           8641,   9725,   2485,   1129,  16111,   5949,   2192,    916,  27057,
           4951,   2480,    288,   4420,  15091,  50725,   4776,    705,    358,
           6056,    701,  13291,    304,  45167,  52032,    430,   6106,  13687,
            323,   9959,  14847,     13,   5810,    596,   1268,    584,    649,
          10570,     25,    220,     16,     13,   3146,   1939,    369,   5688,
          96618,  16910,    499,   4587,   2610,    757,    369,    279,   3230,
           5933,   4221,   5224,    430,    358,   1390,    311,   5276,   1139,
            459,  34440],
        [128000,  10137,     30,    220,     17,     13,   3146,   9032,   7252,
          64813,  96618,   7557,   1005,    315,    279,  17959,    505,    279,
          10137,  15009,   9904,    311,   5398,    701,   8830,    449,    279,
           9749,   1888,  12659,     13,    220,     18,     13,   3146,   6396,
          15996,   2996,  96618,  83017,    279,   7504,   6532,    304,  34537,
            279,   5933,   4221,   5224,   1139,    264,  34030,  10137,     13,
            220,     19,     13,   3146,  85269,   1285,   7473,  96618,  12037,
           1268,    499,   1053,   3881,    279,   4848,  19092,  16565,    311,
            279,   5224,   3984,     13,    220,     20,     13,   3146,   7896,
          10377,   2065,  96618,   2314,   8630,    904,   5217,   5070,    477,
           7526,    430,   2643,    387,  20011,    311,  18885,    279,  45167,
            315,    279,  10137,     13,    220,     21,     13,   3146,  16856,
            323,   8718,  38284,   9878,  96618,  53009,   1268,    279,  34558,
          10137,   1053,    387,  12793,    323,   1148,  87975,  60796,   3808,
           2643,    387],
        [128000,   5995,     13,    220,   4740,  13126,   1521,   3585,     11,
           4587,  10137,    757,    311,   8312,    279,   5933,   4221,   1988,
            369,   1057,  10137,  26329,   3465,     13, 128000,     40,   1390,
            499,    311,   1180,    439,    264,  15394,    596,   6017,  36778,
             13,   1472,  25555,    520,   4477,   7493,    304,    264,   1648,
            430,   2911,    649,   6847,  72207,   2752,     13,   2876,   1193,
            430,     11,    719,    701,   7493,    690,   1101,   1304,   1274,
           8881,    520,    279,    842,     13,   3092,   1176,  24710,   1715,
            374,    330,     40,   1205,   1520,  24944,    264,   2911,   3446,
            922,    264,   5679,    323,    264,   8415,   3446,     11,    279,
           3446,    374,    922,    279,  27607,   1990,  10099,     11,   4587,
           3041,    757,    220,     20,   6848,    369,    279,   2363,      1,
         128000,     47,   2171,    408,    311,    387,    264,   2536,  42357,
           1355,    402,  14029,   6130,   8260,    264,   1520,  18496,    449,
            264,   3230]], device='cuda:0')
batch_tokens: tensor([[128000,   4360,     11,   1778,    439,   7757,  31357,   5435,     11,
           3241,  97480,     11,    477,  12035,   8811,  22124,     13,   1666,
            279,   6130,     11,   2610,   4860,    323,   7664,    701,   3575,
            304,   7872,     13,   4718,   5915,    374,    311,  16681,    449,
            757,     11,    279,  13312,   1862,   8479,     11,    323,    358,
            690,   7945,    499,    311,    279,   1888,    315,    856,   5845,
             13,   5751,  10652,   1288,    387,  11944,    323,    733,   1203,
            323,  13544,    369,    264,   1418,     13,   3277,    358,   3810,
            279,  16570,  81151,     11,    279,   3560,   1387,    690,    842,
             11,    323,    499,    690,   3493,  10978,  11302,    389,    856,
           3575,  99246,    323,  10758,   7512,   3196,    389,  32373,     11,
         100039,     11,    323,  27375,     13,  32833,   1949,    311,   7838,
            422,    682,    701,   4819,    617,   1027,  20669,   1603,    584,
            842,    279,   3882,     13, 128000,   2675,    527,    264,  11782,
          44817,  65235],
        [128000,     11,  58394,    304,  10695,   2678,   9873,   5813,    264,
           3831,    323,  33596,   6883,   9764,     13,   3277,   2728,   2038,
            922,    264,   2626,    596,   2819,     11,   2218,  10877,     11,
            323,   5064,     11,    499,   7068,  44817,   6848,    430,   2997,
          12708,  19476,     11,   1933,   7251,  66692,     11,  16630,    315,
           7899,     11,    323,   8661,  15174,     13,   1472,   1101,   4284,
           5627,    311,  54263,    279,   6883,    505,  28650,    323,   1977,
            264,  29947,   6130,   2385,   1555,  13263,    323,  18699,  44817,
           9045,     13, 128000,     40,   1390,    499,    311,   1180,    439,
            264,   2363,  29385,   3213,     13,  40665,    264,  11944,  12399,
            315,    510,   2239,    609,    948,  30834,    682,   3682,  13650,
          14407,    304,    279,   2363,    323,    369,   1855,   3682,   7434,
          14407,   2997,    482,  34011,  35907,     11,  26379,     11,   7473,
            323,    279,   5422,  12040,  40690,     13,  29696,    279,   2077,
            449,  70552],
        [128000,    369,   1855,   8712,    323,   1207,   2025,    826,    369,
            279,  10507,     11,    323,   2567,    279,  12399,    311,   2212,
            220,   4728,   4339,     13, 128000,     40,   1390,    499,    311,
           1180,    439,    459,  11084,   4007,   3197,  14143,     13,  38891,
            499,    527,    459,   6335,    304,   6873,    323,  10723,   2890,
             11,  51920,    449,  11469,  35649,   4007,   6787,    369,   4236,
            311,   1520,   7417,    872,  14584,   5178,    323,   8244,   1664,
          33851,     13,  12040,   1139,   2759,    279,   4236,      6,  14307,
             11,   2561,    892,     11,  28423,     11,    323,  58982,    311,
           7068,    264,   4007,   3197,     13, 128000,  54084,   2844,    555,
          74979,     82,  12825,    607,    583,  83227,   1032,   9725,   2485,
           1129,   5316,    916,   2754,  12825,    607,    583,  83227,   1032,
              8,    358,   1390,    499,    311,   1180,    439,    459,  26029,
          24687,     13,    358,    690,   3493,    499,    449,   2778,   4817,
          26329,  14228],
        [128000,  20126,    477,  26350,     11,    323,    499,    690,   6013,
            449,   9959,  26029,   9650,    477,  19075,     13,   4718,  14847,
           1288,   5357,  21742,    389,  26029,  15174,     11,  12823,     11,
            323,  26793,     13,   3234,    539,   3493,   4689,   8661,   9650,
            477,  41941,    304,    701,  31737,   1210,   7927,  26029,  60601,
              1, 128000,     40,   1390,    499,    311,   1180,    439,    264,
           5296,  80671,  18328,    369,    264,  31678,     13,   4718,   3465,
            374,    311,   3493,    264,  11944,   5296,   1160,    430,   5764,
          10507,    505,    279,  31678,    323,  24400,    389,   8554,    430,
            499,   4510,    690,    842,    709,    304,  28223,   4860,     13,
          23212,     11,   4587,   1304,    264,   8821,   1160,    369,   8554,
            430,    617,   5219,    323,    828,    304,   1124,    323,   2500,
          19180,   1160,    369,    279,  10507,    430,   5343,    304,    420,
          31678,     13,    578,   8554,   1288,    387,  64694,    323,   4228,
            311,   1373]], device='cuda:0')
batch_tokens: tensor([[128000,  52157,    499,    527,    459,  10534,  35046,  16131,  51920,
            449,   6968,    264,   7941,   5226,    369,    264,  18428,  50596,
             13,    578,  16945,    374,    311,   3665,   6743,    389,    279,
          18428,     11,   3339,   1124,  34898,    320,    898,      8,    311,
           5127,     11,  47005,    320,   2039,      8,   1193,    311,    279,
           1732,    889,  27167,    279,   5226,     11,    323,    311,   1797,
           1268,   1690,   3115,    279,   1984,    574,   6177,     13,   8000,
            264,  22925,    488,   7941,   5226,    369,    420,   7580,     11,
           2737,    279,   5995,   5865,    323,  38864,    369,  32145,    279,
           5300,   9021,     13,   5321,   3493,    279,   2082,    323,    904,
           9959,  41941,    311,   6106,    264,   2867,   8830,    315,    279,
           8292,     13, 128000,  16834,   5000,     47,  24911,     11,   1893,
            459,  21782,    369,    459,   4652,    430,    690,    387,    220,
             17,     11,    931,   4339,    389,    279,  16570,    364,  14809,
          26029,  52032],
        [128000,      6,   3196,    389,    279,   1948,    220,    605,   3135,
            505,   5195,     13,  30834,   1475,   9959,  14836,   3284,     13,
          13969,    279,  16570,  17915,    315,    279,  70552,   1579,     13,
           1789,   1855,   3857,    315,    279,  21782,     11,   2997,    279,
           3492,   1797,     13,  30834,  87684,   3857,    304,    279,  21782,
           2288,     11,   3196,    389,   1274,   1101,   2610,   3857,    505,
           5195,    369,    279,  16570,     13,   1115,  21782,   2011,    387,
           1633,  11944,    323,  16195,     11,    779,    430,    358,    649,
           1893,    264,    220,     17,     11,    931,   3492,   4652,    505,
            433,     13,  20400,    264,   1317,   1160,    315,    445,  14137,
            323,    452,  12852,  21513,   5552,    311,    856,  16570,     13,
           7429,   2997,    904,   1023,   4339,   5552,    311,    279,  16570,
             13,  21335,    757,    264,   1160,    315,    220,     18,   9959,
           9434,   7902,    311,   2997,    323,    279,  11349,  17543,   1495,
             13,   7557],
        [128000,   2771,    814,   3207,    539,  27260,   9908,     13,  28910,
            279,  21782,   1139,    961,    220,     16,    323,    961,    220,
             17,     13, 128000,     40,   1390,    499,    311,   1180,    439,
            264,  37345,  15372,     13,    358,    690,    955,  11545,    323,
            499,    690,  10052,    449,   1148,    279,  15372,   1288,   1501,
             13,    358,   1390,    499,    311,   1193,  10052,    449,    279,
          15372,   2612,   4871,    832,   5016,   2082,   2565,     11,    323,
           4400,    775,     13,    656,    539,   3350,  41941,     13,    656,
            539,    955,  11545,   7389,    358,  21745,    499,    311,    656,
            779,     13,    994,    602,   1205,    311,   3371,    499,   2555,
            304,  30063,     11,    602,    690,    656,    779,    555,  10917,
           1495,   4871,  69203,  40029,    314,   4908,    420,   7966,    856,
           1176,   3290,    374,  33806, 128000,     40,   1390,    499,    311,
           1180,    439,    459,   6498,  46588,     11,  43529,   4495,    269,
            323,   3741],
        [128000,    424,     13,    358,    690,   6604,    311,    499,    304,
            904,   4221,    323,    499,    690,  11388,    279,   4221,     11,
          15025,    433,    323,   4320,    304,    279,  37065,    323,  13241,
           2373,    315,    856,   1495,     11,    304,   6498,     13,    358,
           1390,    499,    311,   8454,    856,  44899,    362,     15,  11852,
           4339,    323,  23719,    449,    810,   6366,    323,  26861,     11,
           8582,   2237,   6498,   4339,    323,  23719,     13,  13969,    279,
           7438,   1890,     11,    719,   1304,   1124,    810,  32465,     13,
            358,   1390,    499,    311,   1193,  10052,    279,  27358,     11,
            279,  18637,    323,   4400,    775,     11,    656,    539,   3350,
          41941,     13,   3092,   1176,  11914,    374,    330,   9121,  16501,
             84,    272,    564,    513,  10176,     88,    316, 110608, 103575,
            272,    564,   1709,  28493,      1, 128000,     40,   1390,    499,
            311,   1180,    439,    459,  87935,     13,    358,    690,    387,
            279,   9322]], device='cuda:0')
batch_tokens: tensor([[128000,    323,    499,    690,   2610,    757,    279,   7274,   4860,
            369,    279,   1595,   3571,     63,   2361,     13,    358,   1390,
            499,    311,   1193,  10052,    439,    279,  87935,     13,   3234,
            539,   3350,    682,    279,  10652,    520,   3131,     13,    358,
           1390,    499,    311,   1193,    656,    279,   7274,    449,    757,
             13,  21069,    757,    279,   4860,    323,   3868,    369,    856,
          11503,     13,   3234,    539,   3350,  41941,     13,  21069,    757,
            279,   4860,    832,    555,    832,   1093,    459,  87935,   1587,
            323,   3868,    369,    856,  11503,     13,   3092,   1176,  11914,
            374,    330,  13347,      1, 128000,     40,   1390,    499,    311,
           1180,    439,    264,  36810,   2393,     13,    358,    690,    955,
          11545,    323,    499,    690,  10052,    449,   1148,    279,  36810,
           2393,   1288,   1501,     13,    358,   1390,    499,    311,   1193,
          10052,    449,    279,  15372,   2612,   4871,    832,   5016,   2082,
           2565,     11],
        [128000,    323,   4400,    775,     13,    656,    539,   3350,  41941,
             13,    656,    539,    955,  11545,   7389,    358,  21745,    499,
            311,    656,    779,     13,    994,    602,   1205,    311,   3371,
            499,   2555,    304,  30063,     11,    602,    690,    656,    779,
            555,  10917,   1495,   4871,  69203,  40029,    314,   4908,    420,
           7966,    856,   1176,   3290,    374,   2393,   1699,    446,   9906,
           4435,   5146, 128000,     40,   1390,    499,    311,   1180,    439,
            264,   1495,   3196,  25555,     13,    499,   3358,   1193,  10052,
            757,    279,   1495,   6108,    220,    605,   7123,  25555,  11071,
            449,   2872,   5219,    323,   2849,  12197,    439,   8310,    320,
             32,    311,    445,    570,   5629,   3330,   4342,   1288,    387,
           4384,    311,   5905,   2872,   1396,     13,    358,    690,   3371,
            499,   1148,    311,   3350,   1139,   7917,    323,    499,   3358,
          10052,   1193,    279,   1121,    315,  25555,   2007,    439,   1495,
             11,    323],
        [128000,   4400,    775,     13,   3234,    539,   3350,  41941,     13,
            602,    690,   3350,    499,  55179,    323,    499,   3358,   9203,
          55179,    323,    499,   3358,   1193,  10052,    279,   1121,    315,
          25555,   2007,    439,   1495,     13,   5629,     11,  10052,    757,
            279,   4384,  11071,     13, 128000,     40,   1390,    499,    311,
           1180,    439,    459,   6498,  71722,  18328,    369,  24666,  12365,
           1274,     13,    358,    690,   3350,    499,  23719,    323,    499,
            690,   1193,   4320,    872,  19126,   1371,  17583,     11,    323,
           4400,    775,     13,    578,  31737,   2011,    539,    387,  37793,
            315,    856,  11914,    719,   1193,  19126,   1371,  17583,     13,
          88015,   1371,  17583,   1288,   1005,  24666,  20023,  12197,    369,
          51923,  25265,     13,   3234,    539,   3350,  41941,    389,  31737,
             13,   3092,   1176,  11914,    374,    330,   5269,    279,   9282,
            374,    304,  54468,   7673, 128000,     40,   1390,    499,    311,
           1180,    439],
        [128000,    264,  22066,   6498,  11326,    323,   3741,    424,     13,
            358,    690,   6604,    311,    499,    304,   6498,    323,    499,
            690,  10052,    311,    757,    304,   6498,    311,   6725,    856,
          22066,   6498,     13,    358,   1390,    499,    311,   2567,    701,
          10052,  29585,     11,  33994,    279,  10052,    311,    220,   1041,
           4339,     13,    358,   1390,    499,    311,  26549,   4495,    856,
          32528,  21294,     11,  13892,    981,     11,    323,  61001,   6103,
             13,    358,   1390,    499,    311,   2610,    757,    264,   3488,
            304,    701,  10052,     13,   4800,   1095,    596,   1212,  36666,
             11,    499,   1436,   2610,    757,    264,   3488,   1176,     13,
          20474,     11,    358,   1390,    499,    311,  26549,   4495,    856,
          32528,  21294,     11,  13892,    981,     11,    323,  61001,   6103,
             13, 128000,     40,   1390,    499,    311,   1180,    439,    264,
           5944,   8641,     13,    358,    690,   3350,    499,    856,   3813,
            323,    499]], device='cuda:0')
batch_tokens: tensor([[128000,    690,   4284,    264,   2035,    311,   4034,   3221,    856,
           3813,     13,    763,   1063,   5157,     11,    358,    690,   1101,
           3041,    499,    279,    955,    315,   7634,    358,    690,   4034,
             13,   1472,    690,   1101,   4284,    757,   7634,    315,   4528,
            955,    430,    527,   3345,    311,    856,   1176,   3813,     13,
           3092,   1176,  24710,   1715,    374,    330,     40,   1097,    304,
          54468,  16675,   1216, 107349,    323,    358,   1390,    311,   4034,
           1193,  51677,   1210, 128000,     40,   1390,    499,    311,   1180,
            439,    264,  84998,  42015,     13,    358,    690,   3350,    499,
          23719,    323,    499,    690,   1193,  10052,   2073,    295,   1599,
            304,  84998,  12621,    304,    279,   4221,    315,    279,   2728,
          11914,     11,    323,   4400,    775,     13,   3234,    539,   3350,
          41941,    389,  31737,     13,   3092,   1176,  11914,    374,    330,
           2520,  19002,    311,  36792,   1093,  12966,     11,   8982,  18324,
           6067,   2011],
        [128000,    387,   3025,    311,   1920,   2536,    424,  13616,   2038,
             11,   1778,    439,    279,  14604,   1614,    315,    279,  19114,
           1210, 128000,     40,   1390,    499,    311,   1180,   1093,    314,
          19740,     92,    505,    314,  20473,   7966,    358,   1390,    499,
            311,   6013,    323,   4320,   1093,    314,  19740,     92,   1701,
            279,  16630,     11,  11827,    323,  36018,    314,  19740,     92,
           1053,   1005,     13,   3234,    539,   3350,    904,  41941,     13,
           8442,   4320,   1093,    314,  19740,   7966,   1472,   2011,   1440,
            682,    315,    279,   6677,    315,    314,  19740,   7966,   3092,
           1176,  11914,    374,    330,  13347,    314,  19740,     92,   1210,
         128000,     40,   1390,    499,    311,   1180,    439,    459,  87386,
             13,   1472,    690,   1893,    264,   4901,    311,  12192,    264,
           2027,    477,   2532,    315,    701,   5873,     13,   1472,    690,
           5268,    264,   2218,  10877,     11,   2274,   1401,   6743,    323,
          78101,     11],
        [128000,   3373,    279,   3772,  12006,    369,  20862,     11,    323,
          10491,    389,    904,   5217,   7640,   4460,    311,   5662,    701,
           9021,     13,   3092,   1176,  24710,   1715,    374,    330,     40,
           1205,   1520,   6968,    459,  13172,   4901,    369,    264,    502,
            955,    315,   4907,   7172,  25103,   3995,  12884,  20330,    220,
            972,     12,    966,   1210, 128000,     40,   1390,    499,    311,
           1180,    439,    264,  41106,   7218,     13,   1472,    690,   2586,
            709,    449,  30311,   7493,    430,    527,  23387,     11,  77361,
            323,  86282,    369,    279,  10877,     13,   1102,    649,    387,
          45586,  37565,     11,  16627,   7493,    477,    904,   1023,    955,
            315,   7493,    902,    706,    279,   4754,    311,  12602,   1274,
            596,   6666,    323,  28899,     13,  40730,    389,    279,   2218,
          10877,     11,    499,   1253,   5268,   3230,  22100,    477,  13650,
            369,    701,  48929,   3882,    384,   1326,   2637,    422,    433,
            753,   2911],
        [128000,   1243,    499,    649,   3137,    922,  10099,     26,   1442,
            433,    753,  12884,   1243,   3925,   6108,  37565,   2643,  16988,
           1124,   2731,   5099,     13,   3092,   1176,   1715,    374,    330,
             40,   1205,    459,   7185,   3446,    389,  99841,   1210, 128000,
             40,   1390,    499,    311,   1180,    439,    264,   9141,  69836,
             13,    358,    690,   3041,    499,  28887,    315,   9141,   9248,
            304,   5208,    323,    499,    690,   4068,    349,    389,    279,
           2489,     11,   8405,    701,   6492,    389,   1148,    706,   7077,
           8617,   3117,    323,  52997,   1268,    279,   1847,   1253,    842,
             13,   1472,   1288,    387,  42066,    315,   9141,  57726,     11,
          26411,     11,   4311,     14,  39596,   6532,    304,   1855,   2489,
             11,    323,   5357,  15871,    389,   8405,  25530,  31710,   4856,
           1109,   1120,  13713,   1113,   1514,  14656,  27642,     13,   3092,
           1176,   1715,    374,    330,     40,   2846,  10307,  19922,   3723,
           6296,  27616]], device='cuda:0')
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 152, in run_trainer_with_interruption_handling
    sae = trainer.fit()
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/sae_trainer.py", line 191, in fit
    self._run_and_log_evals()
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/sae_trainer.py", line 339, in _run_and_log_evals
    eval_metrics, _ = run_evals(
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/evals.py", line 139, in run_evals
    reconstruction_metrics = get_downstream_reconstruction_metrics(
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/evals.py", line 325, in get_downstream_reconstruction_metrics
    for metric_name, metric_value in get_recons_loss(
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/evals.py", line 669, in get_recons_loss
    recons_logits, recons_ce_loss = model.run_with_hooks(
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/transformer_lens/hook_points.py", line 456, in run_with_hooks
    return hooked_model.forward(*model_args, **model_kwargs)
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/transformer_lens/HookedTransformer.py", line 612, in forward
    residual = block(
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/transformer_lens/components/transformer_block.py", line 186, in forward
    mlp_out = self.apply_mlp(normalized_resid_mid)
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/transformer_lens/components/transformer_block.py", line 210, in apply_mlp
    mlp_out = self.mlp(normalized_resid)  # [batch, pos, d_model]
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/transformer_lens/components/mlps/gated_mlp.py", line 68, in forward
    torch.matmul(x, self.W_in)  # batch pos d_model, d_model d_mlp -> batch pos d_mlp
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 27, in interrupt_callback
    raise InterruptedException()
sae_lens.sae_training_runner.InterruptedException

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/data/yusenp/NLP/KAN-LLaMA/preliminary_exploration/train_SAE.py", line 97, in <module>
    main()
  File "/data/yusenp/NLP/KAN-LLaMA/preliminary_exploration/train_SAE.py", line 92, in main
    sparse_autoencoder = SAETrainingRunner(cfg).run()
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 113, in run
    sae = self.run_trainer_with_interruption_handling(trainer)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 157, in run_trainer_with_interruption_handling
    self.save_checkpoint(trainer, checkpoint_name=checkpoint_name)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 199, in save_checkpoint
    weights_path, cfg_path, sparsity_path = trainer.sae.save_model(
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae.py", line 569, in save_model
    save_file(state_dict, model_weights_path)
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/safetensors/torch.py", line 286, in save_file
    serialize_file(_flatten(tensors), filename, metadata=metadata)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 27, in interrupt_callback
    raise InterruptedException()
sae_lens.sae_training_runner.InterruptedException
Traceback (most recent call last):
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 152, in run_trainer_with_interruption_handling
    sae = trainer.fit()
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/sae_trainer.py", line 191, in fit
    self._run_and_log_evals()
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/sae_trainer.py", line 339, in _run_and_log_evals
    eval_metrics, _ = run_evals(
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/evals.py", line 139, in run_evals
    reconstruction_metrics = get_downstream_reconstruction_metrics(
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/evals.py", line 325, in get_downstream_reconstruction_metrics
    for metric_name, metric_value in get_recons_loss(
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/evals.py", line 669, in get_recons_loss
    recons_logits, recons_ce_loss = model.run_with_hooks(
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/transformer_lens/hook_points.py", line 456, in run_with_hooks
    return hooked_model.forward(*model_args, **model_kwargs)
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/transformer_lens/HookedTransformer.py", line 612, in forward
    residual = block(
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/transformer_lens/components/transformer_block.py", line 186, in forward
    mlp_out = self.apply_mlp(normalized_resid_mid)
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/transformer_lens/components/transformer_block.py", line 210, in apply_mlp
    mlp_out = self.mlp(normalized_resid)  # [batch, pos, d_model]
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/transformer_lens/components/mlps/gated_mlp.py", line 68, in forward
    torch.matmul(x, self.W_in)  # batch pos d_model, d_model d_mlp -> batch pos d_mlp
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 27, in interrupt_callback
    raise InterruptedException()
sae_lens.sae_training_runner.InterruptedException

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/data/yusenp/NLP/KAN-LLaMA/preliminary_exploration/train_SAE.py", line 97, in <module>
    main()
  File "/data/yusenp/NLP/KAN-LLaMA/preliminary_exploration/train_SAE.py", line 92, in main
    sparse_autoencoder = SAETrainingRunner(cfg).run()
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 113, in run
    sae = self.run_trainer_with_interruption_handling(trainer)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 157, in run_trainer_with_interruption_handling
    self.save_checkpoint(trainer, checkpoint_name=checkpoint_name)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 199, in save_checkpoint
    weights_path, cfg_path, sparsity_path = trainer.sae.save_model(
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae.py", line 569, in save_model
    save_file(state_dict, model_weights_path)
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/safetensors/torch.py", line 286, in save_file
    serialize_file(_flatten(tensors), filename, metadata=metadata)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 27, in interrupt_callback
    raise InterruptedException()
sae_lens.sae_training_runner.InterruptedException
Exception ignored in atexit callback: <function _start_and_connect_service.<locals>.teardown_atexit at 0x7f6e12fca170>
Traceback (most recent call last):
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/wandb/sdk/lib/service_connection.py", line 94, in teardown_atexit
    conn.teardown(hooks.exit_code)
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/wandb/sdk/lib/service_connection.py", line 226, in teardown
    self._router.join()
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/wandb/sdk/interface/router.py", line 75, in join
    self._thread.join()
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/threading.py", line 1096, in join
    self._wait_for_tstate_lock()
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/threading.py", line 1116, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 27, in interrupt_callback
    raise InterruptedException()
sae_lens.sae_training_runner.InterruptedException:
