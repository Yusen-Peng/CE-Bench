Estimating norm scaling factor: 100%|██████████| 1000/1000 [00:02<00:00, 392.20it/s]
4700| auxiliary_reconstruction_loss: 1.57189 | l1_loss: 1.79373 | mse_loss: 1.11648:  59%|█████▉    | 2406400/4096000 [04:07<02:52, 9819.05it/s] 
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.2879974191839516, 'ce_loss_with_ablation': 7.993437767028809, 'ce_loss_with_sae': 6.351984024047852, 'ce_loss_without_sae': 2.2938945293426514}, 'reconstruction_quality': {'explained_variance': -0.007684764452278614, 'mse': 20.112226486206055, 'cossim': 0.3013560473918915}, 'shrinkage': {'l2_norm_in': 42.693267822265625, 'l2_norm_out': 0.04743603616952896, 'l2_ratio': 0.00014257049770094454, 'relative_reconstruction_bias': 0.009461269713938236}, 'sparsity': {'l0': 40.84414291381836, 'l1': 40.17493438720703}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.47386460069216463, 'ce_loss_with_ablation': 8.472864151000977, 'ce_loss_with_sae': 5.605306148529053, 'ce_loss_without_sae': 2.4214351177215576}, 'reconstruction_quality': {'explained_variance': -0.024404603987932205, 'mse': 18.839773178100586, 'cossim': 0.3161619305610657}, 'shrinkage': {'l2_norm_in': 42.04290008544922, 'l2_norm_out': 0.18251211941242218, 'l2_ratio': 0.0003440867585595697, 'relative_reconstruction_bias': 0.019327906891703606}, 'sparsity': {'l0': 39.5966796875, 'l1': 202.517578125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.46082840461385105, 'ce_loss_with_ablation': 8.208343505859375, 'ce_loss_with_sae': 5.604382038116455, 'ce_loss_without_sae': 2.5577337741851807}, 'reconstruction_quality': {'explained_variance': -0.01971103809773922, 'mse': 18.452152252197266, 'cossim': 0.3244219422340393}, 'shrinkage': {'l2_norm_in': 42.153438568115234, 'l2_norm_out': 0.3234953284263611, 'l2_ratio': 0.0005528259207494557, 'relative_reconstruction_bias': 0.03192995861172676}, 'sparsity': {'l0': 38.4013671875, 'l1': 320.1276550292969}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.4785476300429507, 'ce_loss_with_ablation': 8.418126106262207, 'ce_loss_with_sae': 5.564795970916748, 'ce_loss_without_sae': 2.4556472301483154}, 'reconstruction_quality': {'explained_variance': -0.011553945951163769, 'mse': 18.814624786376953, 'cossim': 0.33391910791397095}, 'shrinkage': {'l2_norm_in': 42.6304931640625, 'l2_norm_out': 0.39245596528053284, 'l2_ratio': 0.0006919692386873066, 'relative_reconstruction_bias': 0.035773009061813354}, 'sparsity': {'l0': 37.07421875, 'l1': 405.56915283203125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.47216012716850253, 'ce_loss_with_ablation': 8.324442863464355, 'ce_loss_with_sae': 5.554491996765137, 'ce_loss_without_sae': 2.457893133163452}, 'reconstruction_quality': {'explained_variance': -0.018962472677230835, 'mse': 18.131908416748047, 'cossim': 0.33916565775871277}, 'shrinkage': {'l2_norm_in': 42.43137741088867, 'l2_norm_out': 0.40629759430885315, 'l2_ratio': 0.0007774549885652959, 'relative_reconstruction_bias': 0.03804219886660576}, 'sparsity': {'l0': 34.20429611206055, 'l1': 435.2830505371094}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.4840674428588704, 'ce_loss_with_ablation': 8.514806747436523, 'ce_loss_with_sae': 5.586758136749268, 'ce_loss_without_sae': 2.4659624099731445}, 'reconstruction_quality': {'explained_variance': -0.018773891031742096, 'mse': 18.314191818237305, 'cossim': 0.3533661663532257}, 'shrinkage': {'l2_norm_in': 42.481449127197266, 'l2_norm_out': 0.41807642579078674, 'l2_ratio': 0.0008612442761659622, 'relative_reconstruction_bias': 0.03843018040060997}, 'sparsity': {'l0': 32.612892150878906, 'l1': 446.95489501953125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.48933209691165164, 'ce_loss_with_ablation': 8.2409029006958, 'ce_loss_with_sae': 5.390923976898193, 'ce_loss_without_sae': 2.4166805744171143}, 'reconstruction_quality': {'explained_variance': -0.005881211720407009, 'mse': 19.103744506835938, 'cossim': 0.3610842525959015}, 'shrinkage': {'l2_norm_in': 42.827510833740234, 'l2_norm_out': 0.4407239854335785, 'l2_ratio': 0.0009362827986478806, 'relative_reconstruction_bias': 0.0385577492415905}, 'sparsity': {'l0': 36.94160079956055, 'l1': 468.94049072265625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5058955507088121, 'ce_loss_with_ablation': 8.194169998168945, 'ce_loss_with_sae': 5.316878318786621, 'ce_loss_without_sae': 2.5066487789154053}, 'reconstruction_quality': {'explained_variance': -0.015477508306503296, 'mse': 18.814476013183594, 'cossim': 0.3720080554485321}, 'shrinkage': {'l2_norm_in': 42.61552810668945, 'l2_norm_out': 0.4339470863342285, 'l2_ratio': 0.0009550840477459133, 'relative_reconstruction_bias': 0.03850944712758064}, 'sparsity': {'l0': 33.25664138793945, 'l1': 460.682373046875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.4841372011549698, 'ce_loss_with_ablation': 8.161482810974121, 'ce_loss_with_sae': 5.447920799255371, 'ce_loss_without_sae': 2.5565385818481445}, 'reconstruction_quality': {'explained_variance': -0.01844549924135208, 'mse': 18.485876083374023, 'cossim': 0.37431779503822327}, 'shrinkage': {'l2_norm_in': 42.33347702026367, 'l2_norm_out': 0.42892107367515564, 'l2_ratio': 0.0009753347258083522, 'relative_reconstruction_bias': 0.03860023617744446}, 'sparsity': {'l0': 33.78261947631836, 'l1': 453.1056213378906}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.49898813575025935, 'ce_loss_with_ablation': 8.346538543701172, 'ce_loss_with_sae': 5.412559986114502, 'ce_loss_without_sae': 2.466682195663452}, 'reconstruction_quality': {'explained_variance': -0.006710611283779144, 'mse': 19.22263526916504, 'cossim': 0.3785655200481415}, 'shrinkage': {'l2_norm_in': 42.91032028198242, 'l2_norm_out': 0.4490058422088623, 'l2_ratio': 0.0010177157819271088, 'relative_reconstruction_bias': 0.038649626076221466}, 'sparsity': {'l0': 34.20742416381836, 'l1': 472.33355712890625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.4968585493549992, 'ce_loss_with_ablation': 8.018692016601562, 'ce_loss_with_sae': 5.273869037628174, 'ce_loss_without_sae': 2.4943370819091797}, 'reconstruction_quality': {'explained_variance': -0.0032025661785155535, 'mse': 19.43050193786621, 'cossim': 0.37883445620536804}, 'shrinkage': {'l2_norm_in': 43.05936813354492, 'l2_norm_out': 0.45187661051750183, 'l2_ratio': 0.0010339453583583236, 'relative_reconstruction_bias': 0.03861244395375252}, 'sparsity': {'l0': 35.998046875, 'l1': 473.0816955566406}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5091226087274167, 'ce_loss_with_ablation': 8.227436065673828, 'ce_loss_with_sae': 5.289951324462891, 'ce_loss_without_sae': 2.457736015319824}, 'reconstruction_quality': {'explained_variance': -0.0036009096074849367, 'mse': 19.299407958984375, 'cossim': 0.3807368278503418}, 'shrinkage': {'l2_norm_in': 42.92173385620117, 'l2_norm_out': 0.45269033312797546, 'l2_ratio': 0.0010503208031877875, 'relative_reconstruction_bias': 0.03878447040915489}, 'sparsity': {'l0': 34.51308822631836, 'l1': 470.0635681152344}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.4737298398575691, 'ce_loss_with_ablation': 8.218037605285645, 'ce_loss_with_sae': 5.282078742980957, 'ce_loss_without_sae': 2.0204992294311523}, 'reconstruction_quality': {'explained_variance': -0.030343562364578247, 'mse': 17.13758659362793, 'cossim': 0.38352808356285095}, 'shrinkage': {'l2_norm_in': 41.26896286010742, 'l2_norm_out': 0.4008249342441559, 'l2_ratio': 0.0010126216802746058, 'relative_reconstruction_bias': 0.038820531219244}, 'sparsity': {'l0': 32.06679916381836, 'l1': 411.55596923828125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5429265161152639, 'ce_loss_with_ablation': 7.762081623077393, 'ce_loss_with_sae': 4.773011684417725, 'ce_loss_without_sae': 2.256603717803955}, 'reconstruction_quality': {'explained_variance': -0.05346785858273506, 'mse': 15.833447456359863, 'cossim': 0.38370439410209656}, 'shrinkage': {'l2_norm_in': 39.94554901123047, 'l2_norm_out': 0.36200830340385437, 'l2_ratio': 0.000975212489720434, 'relative_reconstruction_bias': 0.03896884247660637}, 'sparsity': {'l0': 31.552343368530273, 'l1': 366.3548278808594}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5100061971179053, 'ce_loss_with_ablation': 7.718745231628418, 'ce_loss_with_sae': 4.950977325439453, 'ce_loss_without_sae': 2.2918152809143066}, 'reconstruction_quality': {'explained_variance': -0.05834275111556053, 'mse': 15.391888618469238, 'cossim': 0.38436776399612427}, 'shrinkage': {'l2_norm_in': 39.72636795043945, 'l2_norm_out': 0.3544502854347229, 'l2_ratio': 0.000972938840277493, 'relative_reconstruction_bias': 0.039065368473529816}, 'sparsity': {'l0': 30.019336700439453, 'l1': 356.39154052734375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5572397510808003, 'ce_loss_with_ablation': 7.9982428550720215, 'ce_loss_with_sae': 4.8240065574646, 'ce_loss_without_sae': 2.3018863201141357}, 'reconstruction_quality': {'explained_variance': -0.05603114888072014, 'mse': 15.493788719177246, 'cossim': 0.38661518692970276}, 'shrinkage': {'l2_norm_in': 39.63019561767578, 'l2_norm_out': 0.36064252257347107, 'l2_ratio': 0.0009950314415618777, 'relative_reconstruction_bias': 0.039195068180561066}, 'sparsity': {'l0': 30.012500762939453, 'l1': 360.2586364746094}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5103292347580483, 'ce_loss_with_ablation': 7.808859825134277, 'ce_loss_with_sae': 5.036347389221191, 'ce_loss_without_sae': 2.376068115234375}, 'reconstruction_quality': {'explained_variance': -0.007881276309490204, 'mse': 18.67599105834961, 'cossim': 0.38693270087242126}, 'shrinkage': {'l2_norm_in': 42.7176628112793, 'l2_norm_out': 0.4465198218822479, 'l2_ratio': 0.001094699720852077, 'relative_reconstruction_bias': 0.03909149393439293}, 'sparsity': {'l0': 34.010353088378906, 'l1': 449.8360900878906}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.45200525503706174, 'ce_loss_with_ablation': 8.106575965881348, 'ce_loss_with_sae': 5.370086193084717, 'ce_loss_without_sae': 2.0524654388427734}, 'reconstruction_quality': {'explained_variance': 0.0018405262380838394, 'mse': 19.34293556213379, 'cossim': 0.38411498069763184}, 'shrinkage': {'l2_norm_in': 43.322689056396484, 'l2_norm_out': 0.46436062455177307, 'l2_ratio': 0.0011149084893986583, 'relative_reconstruction_bias': 0.039349041879177094}, 'sparsity': {'l0': 35.489845275878906, 'l1': 465.739013671875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5139497565249936, 'ce_loss_with_ablation': 8.093259811401367, 'ce_loss_with_sae': 5.041896343231201, 'ce_loss_without_sae': 2.156174659729004}, 'reconstruction_quality': {'explained_variance': -0.05738004669547081, 'mse': 15.545671463012695, 'cossim': 0.3901340961456299}, 'shrinkage': {'l2_norm_in': 39.85976028442383, 'l2_norm_out': 0.36246225237846375, 'l2_ratio': 0.0010111423907801509, 'relative_reconstruction_bias': 0.039304282516241074}, 'sparsity': {'l0': 30.599023818969727, 'l1': 355.4562683105469}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5052767112205634, 'ce_loss_with_ablation': 7.865519046783447, 'ce_loss_with_sae': 5.058843612670898, 'ce_loss_without_sae': 2.3107895851135254}, 'reconstruction_quality': {'explained_variance': -0.056511398404836655, 'mse': 15.878387451171875, 'cossim': 0.3917785584926605}, 'shrinkage': {'l2_norm_in': 39.8736457824707, 'l2_norm_out': 0.36856475472450256, 'l2_ratio': 0.001018378883600235, 'relative_reconstruction_bias': 0.039393145591020584}, 'sparsity': {'l0': 31.45136833190918, 'l1': 359.4211120605469}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5551411426492114, 'ce_loss_with_ablation': 7.900069236755371, 'ce_loss_with_sae': 4.78322172164917, 'ce_loss_without_sae': 2.285555601119995}, 'reconstruction_quality': {'explained_variance': -0.0607321634888649, 'mse': 15.241729736328125, 'cossim': 0.38999947905540466}, 'shrinkage': {'l2_norm_in': 39.455902099609375, 'l2_norm_out': 0.35786011815071106, 'l2_ratio': 0.0010194102069362998, 'relative_reconstruction_bias': 0.039498645812273026}, 'sparsity': {'l0': 31.17890739440918, 'l1': 346.6651611328125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5206991178928129, 'ce_loss_with_ablation': 7.851823806762695, 'ce_loss_with_sae': 5.008236408233643, 'ce_loss_without_sae': 2.390728712081909}, 'reconstruction_quality': {'explained_variance': -0.057120051234960556, 'mse': 15.392184257507324, 'cossim': 0.3906204104423523}, 'shrinkage': {'l2_norm_in': 39.692073822021484, 'l2_norm_out': 0.3620010316371918, 'l2_ratio': 0.0010301227448508143, 'relative_reconstruction_bias': 0.03940804675221443}, 'sparsity': {'l0': 32.184181213378906, 'l1': 349.5026550292969}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.48565416319448246, 'ce_loss_with_ablation': 8.002524375915527, 'ce_loss_with_sae': 5.179234027862549, 'ce_loss_without_sae': 2.189148187637329}, 'reconstruction_quality': {'explained_variance': -0.00040928201633505523, 'mse': 19.235519409179688, 'cossim': 0.3877595365047455}, 'shrinkage': {'l2_norm_in': 43.32279968261719, 'l2_norm_out': 0.463792622089386, 'l2_ratio': 0.0011385235702618957, 'relative_reconstruction_bias': 0.03935064747929573}, 'sparsity': {'l0': 38.34550857543945, 'l1': 453.4233093261719}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5044481875392934, 'ce_loss_with_ablation': 8.148221969604492, 'ce_loss_with_sae': 5.2358574867248535, 'ce_loss_without_sae': 2.3748550415039062}, 'reconstruction_quality': {'explained_variance': -0.001195532619021833, 'mse': 19.573959350585938, 'cossim': 0.3944387137889862}, 'shrinkage': {'l2_norm_in': 43.025726318359375, 'l2_norm_out': 0.4690871238708496, 'l2_ratio': 0.0011466445866972208, 'relative_reconstruction_bias': 0.03933316096663475}, 'sparsity': {'l0': 38.95097732543945, 'l1': 456.7809753417969}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5090322287015226, 'ce_loss_with_ablation': 8.11966323852539, 'ce_loss_with_sae': 5.250431537628174, 'ce_loss_without_sae': 2.483022689819336}, 'reconstruction_quality': {'explained_variance': -6.948281225049868e-05, 'mse': 19.28096580505371, 'cossim': 0.39205053448677063}, 'shrinkage': {'l2_norm_in': 43.13718032836914, 'l2_norm_out': 0.4696202278137207, 'l2_ratio': 0.0011587818153202534, 'relative_reconstruction_bias': 0.03948494419455528}, 'sparsity': {'l0': 39.85722732543945, 'l1': 455.2961120605469}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.49556660241282025, 'ce_loss_with_ablation': 8.117958068847656, 'ce_loss_with_sae': 5.309994220733643, 'ce_loss_without_sae': 2.451789617538452}, 'reconstruction_quality': {'explained_variance': -0.00841027032583952, 'mse': 19.099077224731445, 'cossim': 0.39335647225379944}, 'shrinkage': {'l2_norm_in': 42.71411895751953, 'l2_norm_out': 0.45905256271362305, 'l2_ratio': 0.001145125599578023, 'relative_reconstruction_bias': 0.039528246968984604}, 'sparsity': {'l0': 40.92011642456055, 'l1': 441.947509765625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5165089047807864, 'ce_loss_with_ablation': 8.239028930664062, 'ce_loss_with_sae': 5.2401556968688965, 'ce_loss_without_sae': 2.432985305786133}, 'reconstruction_quality': {'explained_variance': -0.006373194511979818, 'mse': 19.181737899780273, 'cossim': 0.3937169015407562}, 'shrinkage': {'l2_norm_in': 42.888023376464844, 'l2_norm_out': 0.4614482820034027, 'l2_ratio': 0.0011520221596583724, 'relative_reconstruction_bias': 0.03939327597618103}, 'sparsity': {'l0': 41.291603088378906, 'l1': 443.0680236816406}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.49946704730008035, 'ce_loss_with_ablation': 8.300178527832031, 'ce_loss_with_sae': 5.397822380065918, 'ce_loss_without_sae': 2.489272356033325}, 'reconstruction_quality': {'explained_variance': -0.007343857083469629, 'mse': 19.226024627685547, 'cossim': 0.39186811447143555}, 'shrinkage': {'l2_norm_in': 42.906700134277344, 'l2_norm_out': 0.46009188890457153, 'l2_ratio': 0.0011501749977469444, 'relative_reconstruction_bias': 0.03945058211684227}, 'sparsity': {'l0': 43.003517150878906, 'l1': 439.248779296875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5086430086326653, 'ce_loss_with_ablation': 7.968987464904785, 'ce_loss_with_sae': 5.06717586517334, 'ce_loss_without_sae': 2.2639811038970947}, 'reconstruction_quality': {'explained_variance': 0.0027565849013626575, 'mse': 18.999486923217773, 'cossim': 0.3884340226650238}, 'shrinkage': {'l2_norm_in': 42.96045684814453, 'l2_norm_out': 0.46358999609947205, 'l2_ratio': 0.0011741219786927104, 'relative_reconstruction_bias': 0.03953307494521141}, 'sparsity': {'l0': 44.25527572631836, 'l1': 440.9772033691406}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.49800317617608736, 'ce_loss_with_ablation': 8.015522003173828, 'ce_loss_with_sae': 5.157111167907715, 'ce_loss_without_sae': 2.275777816772461}, 'reconstruction_quality': {'explained_variance': 0.004400588106364012, 'mse': 19.206907272338867, 'cossim': 0.3910173177719116}, 'shrinkage': {'l2_norm_in': 42.88587951660156, 'l2_norm_out': 0.46807700395584106, 'l2_ratio': 0.0011824533576145768, 'relative_reconstruction_bias': 0.03958439826965332}, 'sparsity': {'l0': 45.23906326293945, 'l1': 442.8426818847656}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.4874819824594107, 'ce_loss_with_ablation': 8.02662181854248, 'ce_loss_with_sae': 5.217204570770264, 'ce_loss_without_sae': 2.2635016441345215}, 'reconstruction_quality': {'explained_variance': -0.003932369407266378, 'mse': 19.210317611694336, 'cossim': 0.39043474197387695}, 'shrinkage': {'l2_norm_in': 42.83064270019531, 'l2_norm_out': 0.4614684581756592, 'l2_ratio': 0.0011600349098443985, 'relative_reconstruction_bias': 0.039590295404195786}, 'sparsity': {'l0': 42.84980392456055, 'l1': 434.6104431152344}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5061986071795532, 'ce_loss_with_ablation': 8.207812309265137, 'ce_loss_with_sae': 5.280637264251709, 'ce_loss_without_sae': 2.4251511096954346}, 'reconstruction_quality': {'explained_variance': -0.005082002840936184, 'mse': 19.028345108032227, 'cossim': 0.38723093271255493}, 'shrinkage': {'l2_norm_in': 42.78973388671875, 'l2_norm_out': 0.45903173089027405, 'l2_ratio': 0.0011655868729576468, 'relative_reconstruction_bias': 0.03957501798868179}, 'sparsity': {'l0': 45.8974609375, 'l1': 430.86260986328125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.49266183874189445, 'ce_loss_with_ablation': 7.968865394592285, 'ce_loss_with_sae': 5.240211486816406, 'ce_loss_without_sae': 2.4302713871002197}, 'reconstruction_quality': {'explained_variance': -0.014657487161457539, 'mse': 18.53091049194336, 'cossim': 0.38913223147392273}, 'shrinkage': {'l2_norm_in': 42.38789367675781, 'l2_norm_out': 0.44785594940185547, 'l2_ratio': 0.0011623786995187402, 'relative_reconstruction_bias': 0.03966997191309929}, 'sparsity': {'l0': 47.429298400878906, 'l1': 417.8571472167969}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5225475104423571, 'ce_loss_with_ablation': 8.31395149230957, 'ce_loss_with_sae': 5.2777276039123535, 'ce_loss_without_sae': 2.5035250186920166}, 'reconstruction_quality': {'explained_variance': -0.009890190325677395, 'mse': 18.983415603637695, 'cossim': 0.3887559771537781}, 'shrinkage': {'l2_norm_in': 42.68758773803711, 'l2_norm_out': 0.4571571946144104, 'l2_ratio': 0.0011663626646623015, 'relative_reconstruction_bias': 0.03968718647956848}, 'sparsity': {'l0': 47.056251525878906, 'l1': 425.0854187011719}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5070801100076731, 'ce_loss_with_ablation': 8.183964729309082, 'ce_loss_with_sae': 5.259464740753174, 'ce_loss_without_sae': 2.4166314601898193}, 'reconstruction_quality': {'explained_variance': -0.00887824222445488, 'mse': 18.88549041748047, 'cossim': 0.38493362069129944}, 'shrinkage': {'l2_norm_in': 42.857242584228516, 'l2_norm_out': 0.4551031291484833, 'l2_ratio': 0.0011653058463707566, 'relative_reconstruction_bias': 0.039645083248615265}, 'sparsity': {'l0': 48.39628982543945, 'l1': 422.6518249511719}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5111799451208282, 'ce_loss_with_ablation': 8.27078914642334, 'ce_loss_with_sae': 5.3181233406066895, 'ce_loss_without_sae': 2.494612216949463}, 'reconstruction_quality': {'explained_variance': -0.010892734862864017, 'mse': 18.872098922729492, 'cossim': 0.3856898248195648}, 'shrinkage': {'l2_norm_in': 42.66035079956055, 'l2_norm_out': 0.45213690400123596, 'l2_ratio': 0.001162601518444717, 'relative_reconstruction_bias': 0.039621759206056595}, 'sparsity': {'l0': 46.895118713378906, 'l1': 418.2732849121094}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.4913251306501247, 'ce_loss_with_ablation': 8.307905197143555, 'ce_loss_with_sae': 5.423741340637207, 'ce_loss_without_sae': 2.4377315044403076}, 'reconstruction_quality': {'explained_variance': -0.011010284535586834, 'mse': 18.789899826049805, 'cossim': 0.3825511932373047}, 'shrinkage': {'l2_norm_in': 42.70094680786133, 'l2_norm_out': 0.45224133133888245, 'l2_ratio': 0.0011665134225040674, 'relative_reconstruction_bias': 0.03975194692611694}, 'sparsity': {'l0': 48.99687576293945, 'l1': 417.0721740722656}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.4929235557217817, 'ce_loss_with_ablation': 8.298147201538086, 'ce_loss_with_sae': 5.421751022338867, 'ce_loss_without_sae': 2.4627673625946045}, 'reconstruction_quality': {'explained_variance': -0.0047226110473275185, 'mse': 19.131561279296875, 'cossim': 0.3818974494934082}, 'shrinkage': {'l2_norm_in': 42.90603256225586, 'l2_norm_out': 0.45981135964393616, 'l2_ratio': 0.0011779776541516185, 'relative_reconstruction_bias': 0.03975580260157585}, 'sparsity': {'l0': 48.53203201293945, 'l1': 423.5567932128906}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.4936857681198347, 'ce_loss_with_ablation': 8.28319263458252, 'ce_loss_with_sae': 5.393560886383057, 'ce_loss_without_sae': 2.4300124645233154}, 'reconstruction_quality': {'explained_variance': -0.008355054073035717, 'mse': 19.089435577392578, 'cossim': 0.3846682608127594}, 'shrinkage': {'l2_norm_in': 42.53894805908203, 'l2_norm_out': 0.45697543025016785, 'l2_ratio': 0.0011750988196581602, 'relative_reconstruction_bias': 0.039764996618032455}, 'sparsity': {'l0': 50.12617111206055, 'l1': 419.6734313964844}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.4927520837325404, 'ce_loss_with_ablation': 8.250324249267578, 'ce_loss_with_sae': 5.390227317810059, 'ce_loss_without_sae': 2.4459917545318604}, 'reconstruction_quality': {'explained_variance': -0.011073976755142212, 'mse': 18.729969024658203, 'cossim': 0.3800744116306305}, 'shrinkage': {'l2_norm_in': 42.87299728393555, 'l2_norm_out': 0.45150700211524963, 'l2_ratio': 0.0011723986826837063, 'relative_reconstruction_bias': 0.03974902257323265}, 'sparsity': {'l0': 51.53984451293945, 'l1': 413.5270690917969}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.46922299897738384, 'ce_loss_with_ablation': 8.394744873046875, 'ce_loss_with_sae': 5.6165995597839355, 'ce_loss_without_sae': 2.4740092754364014}, 'reconstruction_quality': {'explained_variance': -0.013516909442842007, 'mse': 18.731599807739258, 'cossim': 0.37987518310546875}, 'shrinkage': {'l2_norm_in': 42.958984375, 'l2_norm_out': 0.4483282268047333, 'l2_ratio': 0.00116038229316473, 'relative_reconstruction_bias': 0.039783377200365067}, 'sparsity': {'l0': 49.533203125, 'l1': 410.0431823730469}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.4988944048760336, 'ce_loss_with_ablation': 8.180709838867188, 'ce_loss_with_sae': 5.3089375495910645, 'ce_loss_without_sae': 2.4244370460510254}, 'reconstruction_quality': {'explained_variance': -0.04998419061303139, 'mse': 16.483427047729492, 'cossim': 0.39178863167762756}, 'shrinkage': {'l2_norm_in': 40.35259246826172, 'l2_norm_out': 0.3885067403316498, 'l2_ratio': 0.0011013662442564964, 'relative_reconstruction_bias': 0.03984512761235237}, 'sparsity': {'l0': 44.16640853881836, 'l1': 349.2417297363281}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5252597030195774, 'ce_loss_with_ablation': 7.890441417694092, 'ce_loss_with_sae': 5.0012617111206055, 'ce_loss_without_sae': 2.389962911605835}, 'reconstruction_quality': {'explained_variance': -0.05424255132675171, 'mse': 15.807159423828125, 'cossim': 0.387052983045578}, 'shrinkage': {'l2_norm_in': 40.068458557128906, 'l2_norm_out': 0.3766675591468811, 'l2_ratio': 0.0011038817465305328, 'relative_reconstruction_bias': 0.039836782962083817}, 'sparsity': {'l0': 47.7880859375, 'l1': 337.3323974609375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5086898023654459, 'ce_loss_with_ablation': 7.853931427001953, 'ce_loss_with_sae': 5.0322394371032715, 'ce_loss_without_sae': 2.3069517612457275}, 'reconstruction_quality': {'explained_variance': -0.05639363452792168, 'mse': 15.338858604431152, 'cossim': 0.38804125785827637}, 'shrinkage': {'l2_norm_in': 39.61080551147461, 'l2_norm_out': 0.3670164942741394, 'l2_ratio': 0.0011014683404937387, 'relative_reconstruction_bias': 0.039860982447862625}, 'sparsity': {'l0': 45.85527420043945, 'l1': 326.852294921875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5105592093921681, 'ce_loss_with_ablation': 7.938239097595215, 'ce_loss_with_sae': 5.04318380355835, 'ce_loss_without_sae': 2.2678775787353516}, 'reconstruction_quality': {'explained_variance': -0.05165407061576843, 'mse': 15.842697143554688, 'cossim': 0.3852773606777191}, 'shrinkage': {'l2_norm_in': 39.92383575439453, 'l2_norm_out': 0.3785928785800934, 'l2_ratio': 0.0011227861978113651, 'relative_reconstruction_bias': 0.03992776945233345}, 'sparsity': {'l0': 50.17422103881836, 'l1': 338.0983581542969}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5012023657965665, 'ce_loss_with_ablation': 8.071582794189453, 'ce_loss_with_sae': 5.1307597160339355, 'ce_loss_without_sae': 2.2040464878082275}, 'reconstruction_quality': {'explained_variance': 0.00032014399766921997, 'mse': 19.269887924194336, 'cossim': 0.3847065567970276}, 'shrinkage': {'l2_norm_in': 43.197357177734375, 'l2_norm_out': 0.4717305600643158, 'l2_ratio': 0.0012087190989404917, 'relative_reconstruction_bias': 0.03979037329554558}, 'sparsity': {'l0': 51.64726638793945, 'l1': 430.2829284667969}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.502685976595332, 'ce_loss_with_ablation': 7.839266300201416, 'ce_loss_with_sae': 5.058693885803223, 'ce_loss_without_sae': 2.3078360557556152}, 'reconstruction_quality': {'explained_variance': -0.06158539280295372, 'mse': 15.2295503616333, 'cossim': 0.3841879367828369}, 'shrinkage': {'l2_norm_in': 39.71845626831055, 'l2_norm_out': 0.361223429441452, 'l2_ratio': 0.0010885520605370402, 'relative_reconstruction_bias': 0.0400518961250782}, 'sparsity': {'l0': 45.3544921875, 'l1': 319.9705505371094}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
  warnings.warn(
8000| auxiliary_reconstruction_loss: 1.69330 | l1_loss: 2.88038 | mse_loss: 1.06893: 100%|██████████| 4096000/4096000 [07:02<00:00, 9697.40it/s] 
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5147833825334482, 'ce_loss_with_ablation': 7.9237236976623535, 'ce_loss_with_sae': 5.04567813873291, 'ce_loss_without_sae': 2.3329341411590576}, 'reconstruction_quality': {'explained_variance': -0.05514959245920181, 'mse': 15.545480728149414, 'cossim': 0.38268253207206726}, 'shrinkage': {'l2_norm_in': 39.68973922729492, 'l2_norm_out': 0.3711465299129486, 'l2_ratio': 0.0011190440272912383, 'relative_reconstruction_bias': 0.039884310215711594}, 'sparsity': {'l0': 53.17988204956055, 'l1': 329.6226501464844}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.520685442458649, 'ce_loss_with_ablation': 7.754257678985596, 'ce_loss_with_sae': 4.9533562660217285, 'ce_loss_without_sae': 2.374999523162842}, 'reconstruction_quality': {'explained_variance': -0.05417230352759361, 'mse': 15.569160461425781, 'cossim': 0.385916531085968}, 'shrinkage': {'l2_norm_in': 39.933441162109375, 'l2_norm_out': 0.37049469351768494, 'l2_ratio': 0.0011012157192453742, 'relative_reconstruction_bias': 0.039860643446445465}, 'sparsity': {'l0': 47.18691635131836, 'l1': 328.3116149902344}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5151997631229954, 'ce_loss_with_ablation': 7.706046104431152, 'ce_loss_with_sae': 4.9382195472717285, 'ce_loss_without_sae': 2.333709478378296}, 'reconstruction_quality': {'explained_variance': -0.029059801250696182, 'mse': 17.4334774017334, 'cossim': 0.38500505685806274}, 'shrinkage': {'l2_norm_in': 41.38938522338867, 'l2_norm_out': 0.41889673471450806, 'l2_ratio': 0.0011573458323255181, 'relative_reconstruction_bias': 0.040056683123111725}, 'sparsity': {'l0': 51.935546875, 'l1': 375.0245361328125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.4672218426179213, 'ce_loss_with_ablation': 8.2566499710083, 'ce_loss_with_sae': 5.36895227432251, 'ce_loss_without_sae': 2.0760791301727295}, 'reconstruction_quality': {'explained_variance': 0.0011832541786134243, 'mse': 19.409940719604492, 'cossim': 0.38658905029296875}, 'shrinkage': {'l2_norm_in': 43.14218521118164, 'l2_norm_out': 0.474576860666275, 'l2_ratio': 0.0012162424391135573, 'relative_reconstruction_bias': 0.039808209985494614}, 'sparsity': {'l0': 53.191993713378906, 'l1': 430.540283203125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.48008203421616763, 'ce_loss_with_ablation': 8.236321449279785, 'ce_loss_with_sae': 5.304788112640381, 'ce_loss_without_sae': 2.1300039291381836}, 'reconstruction_quality': {'explained_variance': -0.006035075057297945, 'mse': 18.888870239257812, 'cossim': 0.3855019211769104}, 'shrinkage': {'l2_norm_in': 42.87332534790039, 'l2_norm_out': 0.4625086784362793, 'l2_ratio': 0.0012012480292469263, 'relative_reconstruction_bias': 0.039972927421331406}, 'sparsity': {'l0': 51.6953125, 'l1': 418.3002624511719}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.47840761281428656, 'ce_loss_with_ablation': 8.337739944458008, 'ce_loss_with_sae': 5.352663040161133, 'ce_loss_without_sae': 2.098129987716675}, 'reconstruction_quality': {'explained_variance': 0.0017486863071098924, 'mse': 19.42349624633789, 'cossim': 0.38661813735961914}, 'shrinkage': {'l2_norm_in': 43.36648178100586, 'l2_norm_out': 0.47852951288223267, 'l2_ratio': 0.0012174303410574794, 'relative_reconstruction_bias': 0.03993813320994377}, 'sparsity': {'l0': 52.51250076293945, 'l1': 434.1669921875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
