Estimating norm scaling factor: 100%|██████████| 1000/1000 [00:01<00:00, 514.88it/s]
4700| l0_loss: 10495.06836 | mse_loss: 0.33983:  20%|█▉        | 2406400/12288000 [02:49<11:42, 14066.34it/s]
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.005644280170639394, 'ce_loss_with_ablation': 7.993437767028809, 'ce_loss_with_sae': 7.961267948150635, 'ce_loss_without_sae': 2.2938945293426514}, 'reconstruction_quality': {'explained_variance': -0.007327811326831579, 'mse': 26.61334800720215, 'cossim': 0.12946729362010956}, 'shrinkage': {'l2_norm_in': 49.10028076171875, 'l2_norm_out': 0.5293653607368469, 'l2_ratio': 0.006031588651239872, 'relative_reconstruction_bias': 0.3488561809062958}, 'sparsity': {'l0': 2506.623779296875, 'l1': 206.2959747314453}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': -0.017307228842324062, 'ce_loss_with_ablation': 8.472864151000977, 'ce_loss_with_sae': 8.577597618103027, 'ce_loss_without_sae': 2.4214351177215576}, 'reconstruction_quality': {'explained_variance': -0.02460317313671112, 'mse': 25.557680130004883, 'cossim': 0.24494336545467377}, 'shrinkage': {'l2_norm_in': 48.35231018066406, 'l2_norm_out': 0.1545671820640564, 'l2_ratio': 0.0018758921651169658, 'relative_reconstruction_bias': 0.05609658360481262}, 'sparsity': {'l0': 1129.7421875, 'l1': 65.61375427246094}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.07703979367415073, 'ce_loss_with_ablation': 8.208343505859375, 'ce_loss_with_sae': 7.773021697998047, 'ce_loss_without_sae': 2.5577337741851807}, 'reconstruction_quality': {'explained_variance': -0.020281989127397537, 'mse': 25.5953369140625, 'cossim': 0.2871118187904358}, 'shrinkage': {'l2_norm_in': 48.47943878173828, 'l2_norm_out': 0.1316542774438858, 'l2_ratio': 0.001035893801599741, 'relative_reconstruction_bias': 0.029347805306315422}, 'sparsity': {'l0': 689.3810424804688, 'l1': 61.43235397338867}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.3877950207947722, 'ce_loss_with_ablation': 8.418126106262207, 'ce_loss_with_sae': 6.1059064865112305, 'ce_loss_without_sae': 2.4556472301483154}, 'reconstruction_quality': {'explained_variance': -0.011804374866187572, 'mse': 26.115116119384766, 'cossim': 0.28993576765060425}, 'shrinkage': {'l2_norm_in': 49.02808380126953, 'l2_norm_out': 0.19180159270763397, 'l2_ratio': 0.0013670221669599414, 'relative_reconstruction_bias': 0.016781611368060112}, 'sparsity': {'l0': 564.0328369140625, 'l1': 126.49256896972656}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5524775509870665, 'ce_loss_with_ablation': 8.324442863464355, 'ce_loss_with_sae': 5.083305835723877, 'ce_loss_without_sae': 2.457893133163452}, 'reconstruction_quality': {'explained_variance': -0.014232056215405464, 'mse': 24.675811767578125, 'cossim': 0.38301989436149597}, 'shrinkage': {'l2_norm_in': 48.7990837097168, 'l2_norm_out': 0.5131272673606873, 'l2_ratio': 0.006441307254135609, 'relative_reconstruction_bias': 0.02636861801147461}, 'sparsity': {'l0': 496.998046875, 'l1': 288.5029602050781}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.6103719204821059, 'ce_loss_with_ablation': 8.514806747436523, 'ce_loss_with_sae': 4.8227620124816895, 'ce_loss_without_sae': 2.4659624099731445}, 'reconstruction_quality': {'explained_variance': -0.009221134707331657, 'mse': 24.622873306274414, 'cossim': 0.4594230651855469}, 'shrinkage': {'l2_norm_in': 48.856666564941406, 'l2_norm_out': 0.7201136350631714, 'l2_ratio': 0.01002094428986311, 'relative_reconstruction_bias': 0.031809594482183456}, 'sparsity': {'l0': 544.3404541015625, 'l1': 399.7153625488281}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.7076826758385544, 'ce_loss_with_ablation': 8.2409029006958, 'ce_loss_with_sae': 4.11920166015625, 'ce_loss_without_sae': 2.4166805744171143}, 'reconstruction_quality': {'explained_variance': 0.006999050732702017, 'mse': 25.56607437133789, 'cossim': 0.5040355920791626}, 'shrinkage': {'l2_norm_in': 49.25466537475586, 'l2_norm_out': 0.8454727530479431, 'l2_ratio': 0.01242782361805439, 'relative_reconstruction_bias': 0.033055003732442856}, 'sparsity': {'l0': 625.3939819335938, 'l1': 488.48388671875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.7648033281474604, 'ce_loss_with_ablation': 8.194169998168945, 'ce_loss_with_sae': 3.844334840774536, 'ce_loss_without_sae': 2.5066487789154053}, 'reconstruction_quality': {'explained_variance': 0.001071481965482235, 'mse': 25.106237411499023, 'cossim': 0.5464677214622498}, 'shrinkage': {'l2_norm_in': 49.0108757019043, 'l2_norm_out': 0.9166955947875977, 'l2_ratio': 0.014430232346057892, 'relative_reconstruction_bias': 0.03355137258768082}, 'sparsity': {'l0': 655.0060424804688, 'l1': 548.3217163085938}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.8007428694907958, 'ce_loss_with_ablation': 8.161482810974121, 'ce_loss_with_sae': 3.67336368560791, 'ce_loss_without_sae': 2.5565385818481445}, 'reconstruction_quality': {'explained_variance': 0.00044261664152145386, 'mse': 24.616992950439453, 'cossim': 0.5716431140899658}, 'shrinkage': {'l2_norm_in': 48.686492919921875, 'l2_norm_out': 0.9616318941116333, 'l2_ratio': 0.015668189153075218, 'relative_reconstruction_bias': 0.0341765470802784}, 'sparsity': {'l0': 750.0703125, 'l1': 603.3480224609375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.8175106505357149, 'ce_loss_with_ablation': 8.346538543701172, 'ce_loss_with_sae': 3.5396933555603027, 'ce_loss_without_sae': 2.466682195663452}, 'reconstruction_quality': {'explained_variance': 0.014159987680613995, 'mse': 25.565841674804688, 'cossim': 0.6009055972099304}, 'shrinkage': {'l2_norm_in': 49.34990310668945, 'l2_norm_out': 1.030257225036621, 'l2_ratio': 0.016816623508930206, 'relative_reconstruction_bias': 0.034596193581819534}, 'sparsity': {'l0': 820.0826416015625, 'l1': 679.7321166992188}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.8419007455237673, 'ce_loss_with_ablation': 8.018692016601562, 'ce_loss_with_sae': 3.3677334785461426, 'ce_loss_without_sae': 2.4943370819091797}, 'reconstruction_quality': {'explained_variance': 0.018400652334094048, 'mse': 25.817129135131836, 'cossim': 0.6146000623703003}, 'shrinkage': {'l2_norm_in': 49.52131652832031, 'l2_norm_out': 1.0576720237731934, 'l2_ratio': 0.01732921414077282, 'relative_reconstruction_bias': 0.03494952246546745}, 'sparsity': {'l0': 893.64453125, 'l1': 742.0711669921875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.8724558753937417, 'ce_loss_with_ablation': 8.227436065673828, 'ce_loss_with_sae': 3.19362735748291, 'ce_loss_without_sae': 2.457736015319824}, 'reconstruction_quality': {'explained_variance': 0.02055216208100319, 'mse': 25.633224487304688, 'cossim': 0.648211658000946}, 'shrinkage': {'l2_norm_in': 49.36302947998047, 'l2_norm_out': 1.099381685256958, 'l2_ratio': 0.018472883850336075, 'relative_reconstruction_bias': 0.03510240092873573}, 'sparsity': {'l0': 959.0060424804688, 'l1': 803.5427856445312}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9035314583625064, 'ce_loss_with_ablation': 8.218037605285645, 'ce_loss_with_sae': 2.6183667182922363, 'ce_loss_without_sae': 2.0204992294311523}, 'reconstruction_quality': {'explained_variance': -0.0021795849315822124, 'mse': 22.74051856994629, 'cossim': 0.6842390894889832}, 'shrinkage': {'l2_norm_in': 47.46223068237305, 'l2_norm_out': 1.0940192937850952, 'l2_ratio': 0.0199196245521307, 'relative_reconstruction_bias': 0.03515106812119484}, 'sparsity': {'l0': 1040.1956787109375, 'l1': 819.384765625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.922356819227454, 'ce_loss_with_ablation': 7.762081623077393, 'ce_loss_with_sae': 2.6840665340423584, 'ce_loss_without_sae': 2.256603717803955}, 'reconstruction_quality': {'explained_variance': -0.0231045912951231, 'mse': 21.005481719970703, 'cossim': 0.6957258582115173}, 'shrinkage': {'l2_norm_in': 45.94020462036133, 'l2_norm_out': 1.0675334930419922, 'l2_ratio': 0.020615367218852043, 'relative_reconstruction_bias': 0.03521675989031792}, 'sparsity': {'l0': 1114.0699462890625, 'l1': 838.6318359375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9291106560290278, 'ce_loss_with_ablation': 7.718745231628418, 'ce_loss_with_sae': 2.6765267848968506, 'ce_loss_without_sae': 2.2918152809143066}, 'reconstruction_quality': {'explained_variance': -0.02661910653114319, 'mse': 20.4129581451416, 'cossim': 0.7069045901298523}, 'shrinkage': {'l2_norm_in': 45.68812942504883, 'l2_norm_out': 1.0805972814559937, 'l2_ratio': 0.02117900364100933, 'relative_reconstruction_bias': 0.035316795110702515}, 'sparsity': {'l0': 1179.4520263671875, 'l1': 887.2160034179688}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9438565248623916, 'ce_loss_with_ablation': 7.9982428550720215, 'ce_loss_with_sae': 2.621699571609497, 'ce_loss_without_sae': 2.3018863201141357}, 'reconstruction_quality': {'explained_variance': -0.021713443100452423, 'mse': 20.545841217041016, 'cossim': 0.7304104566574097}, 'shrinkage': {'l2_norm_in': 45.5775260925293, 'l2_norm_out': 1.1205122470855713, 'l2_ratio': 0.02228417806327343, 'relative_reconstruction_bias': 0.03537634760141373}, 'sparsity': {'l0': 1230.9632568359375, 'l1': 949.9765625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9401445926102766, 'ce_loss_with_ablation': 7.808859825134277, 'ce_loss_with_sae': 2.7012500762939453, 'ce_loss_without_sae': 2.376068115234375}, 'reconstruction_quality': {'explained_variance': 0.027134506031870842, 'mse': 24.76260757446289, 'cossim': 0.7565695643424988}, 'shrinkage': {'l2_norm_in': 49.128334045410156, 'l2_norm_out': 1.27774178981781, 'l2_ratio': 0.023283591493964195, 'relative_reconstruction_bias': 0.03542628139257431}, 'sparsity': {'l0': 1337.9564208984375, 'l1': 1118.307861328125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9388811307781189, 'ce_loss_with_ablation': 8.106575965881348, 'ce_loss_with_sae': 2.422485828399658, 'ce_loss_without_sae': 2.0524654388427734}, 'reconstruction_quality': {'explained_variance': 0.037627678364515305, 'mse': 25.654224395751953, 'cossim': 0.7666598558425903}, 'shrinkage': {'l2_norm_in': 49.82415771484375, 'l2_norm_out': 1.3177908658981323, 'l2_ratio': 0.023732522502541542, 'relative_reconstruction_bias': 0.03545469045639038}, 'sparsity': {'l0': 1402.728515625, 'l1': 1192.0306396484375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9512906624945687, 'ce_loss_with_ablation': 8.093259811401367, 'ce_loss_with_sae': 2.445366144180298, 'ce_loss_without_sae': 2.156174659729004}, 'reconstruction_quality': {'explained_variance': -0.018977561965584755, 'mse': 20.605239868164062, 'cossim': 0.7651501893997192}, 'shrinkage': {'l2_norm_in': 45.8415412902832, 'l2_norm_out': 1.1850754022598267, 'l2_ratio': 0.023876696825027466, 'relative_reconstruction_bias': 0.035435717552900314}, 'sparsity': {'l0': 1454.5765380859375, 'l1': 1139.186767578125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9552375751902806, 'ce_loss_with_ablation': 7.865519046783447, 'ce_loss_with_sae': 2.5594327449798584, 'ce_loss_without_sae': 2.3107895851135254}, 'reconstruction_quality': {'explained_variance': -0.01648653857409954, 'mse': 21.049665451049805, 'cossim': 0.7799350023269653}, 'shrinkage': {'l2_norm_in': 45.85750961303711, 'l2_norm_out': 1.2127987146377563, 'l2_ratio': 0.024517476558685303, 'relative_reconstruction_bias': 0.0354134738445282}, 'sparsity': {'l0': 1546.2945556640625, 'l1': 1212.6839599609375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9639578823317888, 'ce_loss_with_ablation': 7.900069236755371, 'ce_loss_with_sae': 2.487914562225342, 'ce_loss_without_sae': 2.285555601119995}, 'reconstruction_quality': {'explained_variance': -0.020914185792207718, 'mse': 20.203508377075195, 'cossim': 0.7788705229759216}, 'shrinkage': {'l2_norm_in': 45.377079010009766, 'l2_norm_out': 1.192907691001892, 'l2_ratio': 0.024408120661973953, 'relative_reconstruction_bias': 0.03548062965273857}, 'sparsity': {'l0': 1577.802001953125, 'l1': 1244.402587890625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.968025398973076, 'ce_loss_with_ablation': 7.851823806762695, 'ce_loss_with_sae': 2.565345048904419, 'ce_loss_without_sae': 2.390728712081909}, 'reconstruction_quality': {'explained_variance': -0.015326181426644325, 'mse': 20.395524978637695, 'cossim': 0.7951922416687012}, 'shrinkage': {'l2_norm_in': 45.648685455322266, 'l2_norm_out': 1.2298088073730469, 'l2_ratio': 0.02515549398958683, 'relative_reconstruction_bias': 0.03544953465461731}, 'sparsity': {'l0': 1657.504150390625, 'l1': 1320.748291015625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9660115357924415, 'ce_loss_with_ablation': 8.002524375915527, 'ce_loss_with_sae': 2.3867359161376953, 'ce_loss_without_sae': 2.189148187637329}, 'reconstruction_quality': {'explained_variance': 0.04156932979822159, 'mse': 25.496007919311523, 'cossim': 0.819361686706543}, 'shrinkage': {'l2_norm_in': 49.82428741455078, 'l2_norm_out': 1.4113444089889526, 'l2_ratio': 0.026156896725296974, 'relative_reconstruction_bias': 0.035460639744997025}, 'sparsity': {'l0': 1714.535400390625, 'l1': 1508.1270751953125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9611318996586284, 'ce_loss_with_ablation': 8.148221969604492, 'ce_loss_with_sae': 2.599254846572876, 'ce_loss_without_sae': 2.3748550415039062}, 'reconstruction_quality': {'explained_variance': 0.039682891219854355, 'mse': 25.959564208984375, 'cossim': 0.8109006881713867}, 'shrinkage': {'l2_norm_in': 49.482627868652344, 'l2_norm_out': 1.3828169107437134, 'l2_ratio': 0.02581312693655491, 'relative_reconstruction_bias': 0.03540311008691788}, 'sparsity': {'l0': 1780.6209716796875, 'l1': 1569.2369384765625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9632924486578509, 'ce_loss_with_ablation': 8.11966323852539, 'ce_loss_with_sae': 2.689929962158203, 'ce_loss_without_sae': 2.483022689819336}, 'reconstruction_quality': {'explained_variance': 0.04091973230242729, 'mse': 25.57097625732422, 'cossim': 0.8124257922172546}, 'shrinkage': {'l2_norm_in': 49.610809326171875, 'l2_norm_out': 1.3889297246932983, 'l2_ratio': 0.025870157405734062, 'relative_reconstruction_bias': 0.035459306091070175}, 'sparsity': {'l0': 1857.335205078125, 'l1': 1626.0491943359375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9599187196065848, 'ce_loss_with_ablation': 8.117958068847656, 'ce_loss_with_sae': 2.678896903991699, 'ce_loss_without_sae': 2.451789617538452}, 'reconstruction_quality': {'explained_variance': 0.034606486558914185, 'mse': 25.330276489257812, 'cossim': 0.826291561126709}, 'shrinkage': {'l2_norm_in': 49.12425994873047, 'l2_norm_out': 1.3975828886032104, 'l2_ratio': 0.026499008759856224, 'relative_reconstruction_bias': 0.03539341688156128}, 'sparsity': {'l0': 1913.388671875, 'l1': 1679.26171875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.969592209561047, 'ce_loss_with_ablation': 8.239028930664062, 'ce_loss_with_sae': 2.60953426361084, 'ce_loss_without_sae': 2.432985305786133}, 'reconstruction_quality': {'explained_variance': 0.03709522262215614, 'mse': 25.432065963745117, 'cossim': 0.8304877281188965}, 'shrinkage': {'l2_norm_in': 49.32426071166992, 'l2_norm_out': 1.4102438688278198, 'l2_ratio': 0.026701554656028748, 'relative_reconstruction_bias': 0.03540239855647087}, 'sparsity': {'l0': 1981.6829833984375, 'l1': 1751.7620849609375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9645905561495488, 'ce_loss_with_ablation': 8.300178527832031, 'ce_loss_with_sae': 2.695033311843872, 'ce_loss_without_sae': 2.489272356033325}, 'reconstruction_quality': {'explained_variance': 0.03723273053765297, 'mse': 25.490079879760742, 'cossim': 0.8391987085342407}, 'shrinkage': {'l2_norm_in': 49.34573745727539, 'l2_norm_out': 1.425490140914917, 'l2_ratio': 0.02707226388156414, 'relative_reconstruction_bias': 0.035398226231336594}, 'sparsity': {'l0': 2053.015380859375, 'l1': 1809.3076171875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9809271618052943, 'ce_loss_with_ablation': 7.968987464904785, 'ce_loss_with_sae': 2.3727917671203613, 'ce_loss_without_sae': 2.2639811038970947}, 'reconstruction_quality': {'explained_variance': 0.04897197708487511, 'mse': 25.179601669311523, 'cossim': 0.8570934534072876}, 'shrinkage': {'l2_norm_in': 49.407562255859375, 'l2_norm_out': 1.4618898630142212, 'l2_ratio': 0.02784056030213833, 'relative_reconstruction_bias': 0.03548227623105049}, 'sparsity': {'l0': 2124.141845703125, 'l1': 1884.7938232421875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9807338817703509, 'ce_loss_with_ablation': 8.015522003173828, 'ce_loss_with_sae': 2.3863604068756104, 'ce_loss_without_sae': 2.275777816772461}, 'reconstruction_quality': {'explained_variance': 0.05169075354933739, 'mse': 25.45712661743164, 'cossim': 0.8679437637329102}, 'shrinkage': {'l2_norm_in': 49.32179260253906, 'l2_norm_out': 1.4780148267745972, 'l2_ratio': 0.028273940086364746, 'relative_reconstruction_bias': 0.035467229783535004}, 'sparsity': {'l0': 2182.4599609375, 'l1': 1957.5806884765625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9819718273966567, 'ce_loss_with_ablation': 8.02662181854248, 'ce_loss_with_sae': 2.3674001693725586, 'ce_loss_without_sae': 2.2635016441345215}, 'reconstruction_quality': {'explained_variance': 0.04212338849902153, 'mse': 25.47072410583496, 'cossim': 0.8533130884170532}, 'shrinkage': {'l2_norm_in': 49.25826644897461, 'l2_norm_out': 1.4484491348266602, 'l2_ratio': 0.027703935280442238, 'relative_reconstruction_bias': 0.035410504788160324}, 'sparsity': {'l0': 2262.4521484375, 'l1': 2002.3660888671875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9705249049454819, 'ce_loss_with_ablation': 8.207812309265137, 'ce_loss_with_sae': 2.595595598220825, 'ce_loss_without_sae': 2.4251511096954346}, 'reconstruction_quality': {'explained_variance': 0.040793973952531815, 'mse': 25.228626251220703, 'cossim': 0.8518175482749939}, 'shrinkage': {'l2_norm_in': 49.21122360229492, 'l2_norm_out': 1.444254994392395, 'l2_ratio': 0.02764504961669445, 'relative_reconstruction_bias': 0.035393811762332916}, 'sparsity': {'l0': 2329.936767578125, 'l1': 2056.329833984375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9761437817198192, 'ce_loss_with_ablation': 7.968865394592285, 'ce_loss_with_sae': 2.562401294708252, 'ce_loss_without_sae': 2.4302713871002197}, 'reconstruction_quality': {'explained_variance': 0.032896872609853745, 'mse': 24.566110610961914, 'cossim': 0.8612422347068787}, 'shrinkage': {'l2_norm_in': 48.74907302856445, 'l2_norm_out': 1.444324254989624, 'l2_ratio': 0.02803567424416542, 'relative_reconstruction_bias': 0.035409267991781235}, 'sparsity': {'l0': 2394.675537109375, 'l1': 2120.70654296875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9809009960528413, 'ce_loss_with_ablation': 8.31395149230957, 'ce_loss_with_sae': 2.6144983768463135, 'ce_loss_without_sae': 2.5035250186920166}, 'reconstruction_quality': {'explained_variance': 0.038376737385988235, 'mse': 25.166601181030273, 'cossim': 0.8686712384223938}, 'shrinkage': {'l2_norm_in': 49.09374237060547, 'l2_norm_out': 1.4701476097106934, 'l2_ratio': 0.028388718143105507, 'relative_reconstruction_bias': 0.03542650118470192}, 'sparsity': {'l0': 2479.400634765625, 'l1': 2192.8955078125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9791150448477589, 'ce_loss_with_ablation': 8.183964729309082, 'ce_loss_with_sae': 2.5370819568634033, 'ce_loss_without_sae': 2.4166314601898193}, 'reconstruction_quality': {'explained_variance': 0.03961755707859993, 'mse': 25.031156539916992, 'cossim': 0.8703927397727966}, 'shrinkage': {'l2_norm_in': 49.28886032104492, 'l2_norm_out': 1.478920817375183, 'l2_ratio': 0.02848237194120884, 'relative_reconstruction_bias': 0.03542298451066017}, 'sparsity': {'l0': 2549.307861328125, 'l1': 2257.322265625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.980318397929058, 'ce_loss_with_ablation': 8.27078914642334, 'ce_loss_with_sae': 2.6082966327667236, 'ce_loss_without_sae': 2.494612216949463}, 'reconstruction_quality': {'explained_variance': 0.0382581427693367, 'mse': 25.013694763183594, 'cossim': 0.8749706149101257}, 'shrinkage': {'l2_norm_in': 49.06241989135742, 'l2_norm_out': 1.4791171550750732, 'l2_ratio': 0.028675353154540062, 'relative_reconstruction_bias': 0.03539019823074341}, 'sparsity': {'l0': 2628.147216796875, 'l1': 2311.403076171875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9790473229817784, 'ce_loss_with_ablation': 8.307905197143555, 'ce_loss_with_sae': 2.56072735786438, 'ce_loss_without_sae': 2.4377315044403076}, 'reconstruction_quality': {'explained_variance': 0.03820651024580002, 'mse': 24.907808303833008, 'cossim': 0.8755844235420227}, 'shrinkage': {'l2_norm_in': 49.10911178588867, 'l2_norm_out': 1.4798542261123657, 'l2_ratio': 0.02868153527379036, 'relative_reconstruction_bias': 0.03541869297623634}, 'sparsity': {'l0': 2712.445556640625, 'l1': 2367.104736328125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9830726064588149, 'ce_loss_with_ablation': 8.298147201538086, 'ce_loss_with_sae': 2.5615451335906982, 'ce_loss_without_sae': 2.4627673625946045}, 'reconstruction_quality': {'explained_variance': 0.045263323932886124, 'mse': 25.358556747436523, 'cossim': 0.8843914270401001}, 'shrinkage': {'l2_norm_in': 49.344970703125, 'l2_norm_out': 1.504907488822937, 'l2_ratio': 0.02906927466392517, 'relative_reconstruction_bias': 0.0354340635240078}, 'sparsity': {'l0': 2785.340576171875, 'l1': 2443.419921875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9802437611346664, 'ce_loss_with_ablation': 8.28319263458252, 'ce_loss_with_sae': 2.545649290084839, 'ce_loss_without_sae': 2.4300124645233154}, 'reconstruction_quality': {'explained_variance': 0.04239698871970177, 'mse': 25.306259155273438, 'cossim': 0.8888450860977173}, 'shrinkage': {'l2_norm_in': 48.92280197143555, 'l2_norm_out': 1.5001097917556763, 'l2_ratio': 0.029269829392433167, 'relative_reconstruction_bias': 0.035405632108449936}, 'sparsity': {'l0': 2882.0625, 'l1': 2511.801513671875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9800429531403296, 'ce_loss_with_ablation': 8.250324249267578, 'ce_loss_with_sae': 2.561829090118408, 'ce_loss_without_sae': 2.4459917545318604}, 'reconstruction_quality': {'explained_variance': 0.039665769785642624, 'mse': 24.82061767578125, 'cossim': 0.8872181177139282}, 'shrinkage': {'l2_norm_in': 49.30698013305664, 'l2_norm_out': 1.5077015161514282, 'l2_ratio': 0.029223693534731865, 'relative_reconstruction_bias': 0.03542904928326607}, 'sparsity': {'l0': 2981.500244140625, 'l1': 2594.987548828125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9843604360504506, 'ce_loss_with_ablation': 8.394744873046875, 'ce_loss_with_sae': 2.5666069984436035, 'ce_loss_without_sae': 2.4740092754364014}, 'reconstruction_quality': {'explained_variance': 0.03820235654711723, 'mse': 24.82062339782715, 'cossim': 0.8937610983848572}, 'shrinkage': {'l2_norm_in': 49.4058723449707, 'l2_norm_out': 1.5215303897857666, 'l2_ratio': 0.029481137171387672, 'relative_reconstruction_bias': 0.03540289029479027}, 'sparsity': {'l0': 3056.587646484375, 'l1': 2659.806396484375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9841950386931371, 'ce_loss_with_ablation': 8.180709838867188, 'ce_loss_with_sae': 2.5154147148132324, 'ce_loss_without_sae': 2.4244370460510254}, 'reconstruction_quality': {'explained_variance': 0.005310791078954935, 'mse': 21.829784393310547, 'cossim': 0.9047296643257141}, 'shrinkage': {'l2_norm_in': 46.4083366394043, 'l2_norm_out': 1.4424394369125366, 'l2_ratio': 0.029988110065460205, 'relative_reconstruction_bias': 0.0354333333671093}, 'sparsity': {'l0': 3157.976318359375, 'l1': 2668.829833984375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9837234959577913, 'ce_loss_with_ablation': 7.890441417694092, 'ce_loss_with_sae': 2.4794914722442627, 'ce_loss_without_sae': 2.389962911605835}, 'reconstruction_quality': {'explained_variance': 0.0018474910175427794, 'mse': 20.924272537231445, 'cossim': 0.909223198890686}, 'shrinkage': {'l2_norm_in': 46.08156204223633, 'l2_norm_out': 1.4387975931167603, 'l2_ratio': 0.030157415196299553, 'relative_reconstruction_bias': 0.03545115143060684}, 'sparsity': {'l0': 3228.701416015625, 'l1': 2714.767333984375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9806476215069906, 'ce_loss_with_ablation': 7.853931427001953, 'ce_loss_with_sae': 2.4142990112304688, 'ce_loss_without_sae': 2.3069517612457275}, 'reconstruction_quality': {'explained_variance': -0.0003617588372435421, 'mse': 20.302101135253906, 'cossim': 0.9078802466392517}, 'shrinkage': {'l2_norm_in': 45.55522537231445, 'l2_norm_out': 1.4190237522125244, 'l2_ratio': 0.03009854629635811, 'relative_reconstruction_bias': 0.035452865064144135}, 'sparsity': {'l0': 3328.760498046875, 'l1': 2763.59375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9844685454702937, 'ce_loss_with_ablation': 7.938239097595215, 'ce_loss_with_sae': 2.3559465408325195, 'ce_loss_without_sae': 2.2678775787353516}, 'reconstruction_quality': {'explained_variance': 0.004877009894698858, 'mse': 20.97479248046875, 'cossim': 0.913209855556488}, 'shrinkage': {'l2_norm_in': 45.91523361206055, 'l2_norm_out': 1.440139651298523, 'l2_ratio': 0.030350064858794212, 'relative_reconstruction_bias': 0.03545719385147095}, 'sparsity': {'l0': 3426.482177734375, 'l1': 2846.924560546875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9913872811677388, 'ce_loss_with_ablation': 8.071582794189453, 'ce_loss_with_sae': 2.254581928253174, 'ce_loss_without_sae': 2.2040464878082275}, 'reconstruction_quality': {'explained_variance': 0.05492815375328064, 'mse': 25.527563095092773, 'cossim': 0.9206550717353821}, 'shrinkage': {'l2_norm_in': 49.68001174926758, 'l2_norm_out': 1.5846672058105469, 'l2_ratio': 0.030724728479981422, 'relative_reconstruction_bias': 0.035475414246320724}, 'sparsity': {'l0': 3502.669677734375, 'l1': 3046.095458984375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9876266028749381, 'ce_loss_with_ablation': 7.839266300201416, 'ce_loss_with_sae': 2.3762786388397217, 'ce_loss_without_sae': 2.3078360557556152}, 'reconstruction_quality': {'explained_variance': -0.004988064523786306, 'mse': 20.15888786315918, 'cossim': 0.9101123213768005}, 'shrinkage': {'l2_norm_in': 45.67903518676758, 'l2_norm_out': 1.4255331754684448, 'l2_ratio': 0.03019828163087368, 'relative_reconstruction_bias': 0.035442132502794266}, 'sparsity': {'l0': 3604.414794921875, 'l1': 2978.21923828125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
  warnings.warn(
11300| l0_loss: 28656.26953 | mse_loss: 0.07794:  47%|████▋     | 5785600/12288000 [06:48<07:40, 14116.71it/s]interrupted, saving progress
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9877347339733165, 'ce_loss_with_ablation': 7.9237236976623535, 'ce_loss_with_sae': 2.4015066623687744, 'ce_loss_without_sae': 2.3329341411590576}, 'reconstruction_quality': {'explained_variance': 0.002534066094085574, 'mse': 20.575241088867188, 'cossim': 0.919593334197998}, 'shrinkage': {'l2_norm_in': 45.64601516723633, 'l2_norm_out': 1.441947340965271, 'l2_ratio': 0.030641093850135803, 'relative_reconstruction_bias': 0.035455744713544846}, 'sparsity': {'l0': 3694.188720703125, 'l1': 3038.587646484375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9909856484133405, 'ce_loss_with_ablation': 7.754257678985596, 'ce_loss_with_sae': 2.423490047454834, 'ce_loss_without_sae': 2.374999523162842}, 'reconstruction_quality': {'explained_variance': 0.004225828684866428, 'mse': 20.60062026977539, 'cossim': 0.9253650903701782}, 'shrinkage': {'l2_norm_in': 45.9262809753418, 'l2_norm_out': 1.461968183517456, 'l2_ratio': 0.030893756076693535, 'relative_reconstruction_bias': 0.03544830530881882}, 'sparsity': {'l0': 3781.30322265625, 'l1': 3131.6982421875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9871460408242713, 'ce_loss_with_ablation': 7.706046104431152, 'ce_loss_with_sae': 2.4027652740478516, 'ce_loss_without_sae': 2.333709478378296}, 'reconstruction_quality': {'explained_variance': 0.02806466817855835, 'mse': 23.089475631713867, 'cossim': 0.9264532327651978}, 'shrinkage': {'l2_norm_in': 47.60071563720703, 'l2_norm_out': 1.521985650062561, 'l2_ratio': 0.030982578173279762, 'relative_reconstruction_bias': 0.0354476161301136}, 'sparsity': {'l0': 3889.3125, 'l1': 3265.090087890625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9879329294041825, 'ce_loss_with_ablation': 8.2566499710083, 'ce_loss_with_sae': 2.150660514831543, 'ce_loss_without_sae': 2.0760791301727295}, 'reconstruction_quality': {'explained_variance': 0.057277511805295944, 'mse': 25.71384048461914, 'cossim': 0.9322698712348938}, 'shrinkage': {'l2_norm_in': 49.61656188964844, 'l2_norm_out': 1.6032646894454956, 'l2_ratio': 0.031244052574038506, 'relative_reconstruction_bias': 0.03544444963335991}, 'sparsity': {'l0': 3973.739501953125, 'l1': 3411.263671875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9887559429749281, 'ce_loss_with_ablation': 8.236321449279785, 'ce_loss_with_sae': 2.1986637115478516, 'ce_loss_without_sae': 2.1300039291381836}, 'reconstruction_quality': {'explained_variance': 0.05086579546332359, 'mse': 25.02198600769043, 'cossim': 0.9347814917564392}, 'shrinkage': {'l2_norm_in': 49.30735778808594, 'l2_norm_out': 1.5968014001846313, 'l2_ratio': 0.03136938437819481, 'relative_reconstruction_bias': 0.035462457686662674}, 'sparsity': {'l0': 4053.890625, 'l1': 3461.747802734375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9895852713218283, 'ce_loss_with_ablation': 8.337739944458008, 'ce_loss_with_sae': 2.163113832473755, 'ce_loss_without_sae': 2.098129987716675}, 'reconstruction_quality': {'explained_variance': 0.058771323412656784, 'mse': 25.7314395904541, 'cossim': 0.9387203454971313}, 'shrinkage': {'l2_norm_in': 49.8745231628418, 'l2_norm_out': 1.625386118888855, 'l2_ratio': 0.03156989812850952, 'relative_reconstruction_bias': 0.0354594886302948}, 'sparsity': {'l0': 4144.77294921875, 'l1': 3555.608154296875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9913904206841538, 'ce_loss_with_ablation': 8.417792320251465, 'ce_loss_with_sae': 2.4314305782318115, 'ce_loss_without_sae': 2.3794429302215576}, 'reconstruction_quality': {'explained_variance': 0.04876546934247017, 'mse': 24.908079147338867, 'cossim': 0.9298148155212402}, 'shrinkage': {'l2_norm_in': 48.94294357299805, 'l2_norm_out': 1.5729405879974365, 'l2_ratio': 0.03111695684492588, 'relative_reconstruction_bias': 0.03542773053050041}, 'sparsity': {'l0': 4225.3369140625, 'l1': 3564.192138671875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9900024334839652, 'ce_loss_with_ablation': 8.562667846679688, 'ce_loss_with_sae': 2.4646129608154297, 'ce_loss_without_sae': 2.403031587600708}, 'reconstruction_quality': {'explained_variance': 0.044076889753341675, 'mse': 24.495351791381836, 'cossim': 0.9306060075759888}, 'shrinkage': {'l2_norm_in': 49.00503921508789, 'l2_norm_out': 1.5757167339324951, 'l2_ratio': 0.03115745261311531, 'relative_reconstruction_bias': 0.0354272834956646}, 'sparsity': {'l0': 4305.4853515625, 'l1': 3621.186767578125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9907581855613365, 'ce_loss_with_ablation': 8.255166053771973, 'ce_loss_with_sae': 2.500366687774658, 'ce_loss_without_sae': 2.446685791015625}, 'reconstruction_quality': {'explained_variance': 0.039484988898038864, 'mse': 24.36984634399414, 'cossim': 0.9363382458686829}, 'shrinkage': {'l2_norm_in': 48.78483200073242, 'l2_norm_out': 1.5794683694839478, 'l2_ratio': 0.03142732009291649, 'relative_reconstruction_bias': 0.03542996570467949}, 'sparsity': {'l0': 4396.67919921875, 'l1': 3704.957763671875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9890972442405394, 'ce_loss_with_ablation': 8.296746253967285, 'ce_loss_with_sae': 2.487241506576538, 'ce_loss_without_sae': 2.423203706741333}, 'reconstruction_quality': {'explained_variance': 0.046567000448703766, 'mse': 25.041784286499023, 'cossim': 0.9341976046562195}, 'shrinkage': {'l2_norm_in': 49.24110412597656, 'l2_norm_out': 1.5893975496292114, 'l2_ratio': 0.031314339488744736, 'relative_reconstruction_bias': 0.03543267771601677}, 'sparsity': {'l0': 4478.35107421875, 'l1': 3807.025146484375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9927440891041334, 'ce_loss_with_ablation': 8.38912582397461, 'ce_loss_with_sae': 2.3813490867614746, 'ce_loss_without_sae': 2.3374385833740234}, 'reconstruction_quality': {'explained_variance': 0.04027634486556053, 'mse': 24.073928833007812, 'cossim': 0.9388842582702637}, 'shrinkage': {'l2_norm_in': 48.6624870300293, 'l2_norm_out': 1.5791516304016113, 'l2_ratio': 0.03152987360954285, 'relative_reconstruction_bias': 0.035447169095277786}, 'sparsity': {'l0': 4564.67529296875, 'l1': 3835.04541015625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9912142381924, 'ce_loss_with_ablation': 8.42988109588623, 'ce_loss_with_sae': 2.4793930053710938, 'ce_loss_without_sae': 2.426650047302246}, 'reconstruction_quality': {'explained_variance': 0.0584067665040493, 'mse': 25.47462272644043, 'cossim': 0.9409605860710144}, 'shrinkage': {'l2_norm_in': 49.24074935913086, 'l2_norm_out': 1.6044740676879883, 'l2_ratio': 0.03163290023803711, 'relative_reconstruction_bias': 0.03544860705733299}, 'sparsity': {'l0': 4648.1484375, 'l1': 3912.78125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9927798985978648, 'ce_loss_with_ablation': 8.233355522155762, 'ce_loss_with_sae': 2.3143701553344727, 'ce_loss_without_sae': 2.2713236808776855}, 'reconstruction_quality': {'explained_variance': 0.055201806128025055, 'mse': 25.148696899414062, 'cossim': 0.9495765566825867}, 'shrinkage': {'l2_norm_in': 49.46213150024414, 'l2_norm_out': 1.6299676895141602, 'l2_ratio': 0.03205625340342522, 'relative_reconstruction_bias': 0.03546535596251488}, 'sparsity': {'l0': 4729.55859375, 'l1': 4021.146240234375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9913381336412733, 'ce_loss_with_ablation': 8.197830200195312, 'ce_loss_with_sae': 2.149277448654175, 'ce_loss_without_sae': 2.0964279174804688}, 'reconstruction_quality': {'explained_variance': 0.061590611934661865, 'mse': 26.027921676635742, 'cossim': 0.9476966857910156}, 'shrinkage': {'l2_norm_in': 50.00461959838867, 'l2_norm_out': 1.644791841506958, 'l2_ratio': 0.031986501067876816, 'relative_reconstruction_bias': 0.03544965013861656}, 'sparsity': {'l0': 4821.60693359375, 'l1': 4126.625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9910767764553681, 'ce_loss_with_ablation': 8.222511291503906, 'ce_loss_with_sae': 2.1243247985839844, 'ce_loss_without_sae': 2.0694193840026855}, 'reconstruction_quality': {'explained_variance': 0.060421478003263474, 'mse': 25.607370376586914, 'cossim': 0.9487547874450684}, 'shrinkage': {'l2_norm_in': 49.643218994140625, 'l2_norm_out': 1.6346981525421143, 'l2_ratio': 0.03203276917338371, 'relative_reconstruction_bias': 0.03546355292201042}, 'sparsity': {'l0': 4890.42529296875, 'l1': 4156.67919921875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9916832261603234, 'ce_loss_with_ablation': 8.116395950317383, 'ce_loss_with_sae': 2.397123098373413, 'ce_loss_without_sae': 2.34915828704834}, 'reconstruction_quality': {'explained_variance': 0.051879581063985825, 'mse': 25.519926071166992, 'cossim': 0.9443961977958679}, 'shrinkage': {'l2_norm_in': 49.337013244628906, 'l2_norm_out': 1.6120738983154297, 'l2_ratio': 0.031779974699020386, 'relative_reconstruction_bias': 0.03543616086244583}, 'sparsity': {'l0': 4966.64208984375, 'l1': 4222.85546875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9921079903454842, 'ce_loss_with_ablation': 8.121553421020508, 'ce_loss_with_sae': 2.4864234924316406, 'ce_loss_without_sae': 2.4415972232818604}, 'reconstruction_quality': {'explained_variance': 0.05823763832449913, 'mse': 25.792341232299805, 'cossim': 0.9472929835319519}, 'shrinkage': {'l2_norm_in': 49.47166442871094, 'l2_norm_out': 1.6238940954208374, 'l2_ratio': 0.03193417936563492, 'relative_reconstruction_bias': 0.035449687391519547}, 'sparsity': {'l0': 5034.24853515625, 'l1': 4265.64404296875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9920476984680205, 'ce_loss_with_ablation': 8.168448448181152, 'ce_loss_with_sae': 2.5256412029266357, 'ce_loss_without_sae': 2.480408191680908}, 'reconstruction_quality': {'explained_variance': 0.05093974620103836, 'mse': 25.36396598815918, 'cossim': 0.9453815817832947}, 'shrinkage': {'l2_norm_in': 49.34089660644531, 'l2_norm_out': 1.6142066717147827, 'l2_ratio': 0.03182733803987503, 'relative_reconstruction_bias': 0.035444434732198715}, 'sparsity': {'l0': 5120.62890625, 'l1': 4361.2099609375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9943133499563448, 'ce_loss_with_ablation': 8.011977195739746, 'ce_loss_with_sae': 2.4969165325164795, 'ce_loss_without_sae': 2.4653749465942383}, 'reconstruction_quality': {'explained_variance': 0.05926278978586197, 'mse': 25.805892944335938, 'cossim': 0.9492128491401672}, 'shrinkage': {'l2_norm_in': 49.41799545288086, 'l2_norm_out': 1.625478982925415, 'l2_ratio': 0.03201858326792717, 'relative_reconstruction_bias': 0.035447098314762115}, 'sparsity': {'l0': 5188.16650390625, 'l1': 4403.4765625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9947569195706717, 'ce_loss_with_ablation': 8.217658042907715, 'ce_loss_with_sae': 2.569894790649414, 'ce_loss_without_sae': 2.5401270389556885}, 'reconstruction_quality': {'explained_variance': 0.04675285145640373, 'mse': 25.140636444091797, 'cossim': 0.9500341415405273}, 'shrinkage': {'l2_norm_in': 49.07607650756836, 'l2_norm_out': 1.6141289472579956, 'l2_ratio': 0.03205912187695503, 'relative_reconstruction_bias': 0.03544362261891365}, 'sparsity': {'l0': 5261.9384765625, 'l1': 4472.44384765625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9929422082577188, 'ce_loss_with_ablation': 8.262845993041992, 'ce_loss_with_sae': 2.5149052143096924, 'ce_loss_without_sae': 2.4740490913391113}, 'reconstruction_quality': {'explained_variance': 0.05489697679877281, 'mse': 25.485095977783203, 'cossim': 0.953497052192688}, 'shrinkage': {'l2_norm_in': 49.447044372558594, 'l2_norm_out': 1.634796380996704, 'l2_ratio': 0.03221819922327995, 'relative_reconstruction_bias': 0.03544212132692337}, 'sparsity': {'l0': 5339.765625, 'l1': 4540.55126953125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9941656313577203, 'ce_loss_with_ablation': 8.118338584899902, 'ce_loss_with_sae': 2.4878475666046143, 'ce_loss_without_sae': 2.4548044204711914}, 'reconstruction_quality': {'explained_variance': 0.05777599290013313, 'mse': 25.956771850585938, 'cossim': 0.9518781900405884}, 'shrinkage': {'l2_norm_in': 49.46053695678711, 'l2_norm_out': 1.6322115659713745, 'l2_ratio': 0.032139088958501816, 'relative_reconstruction_bias': 0.03546668216586113}, 'sparsity': {'l0': 5399.82080078125, 'l1': 4571.96875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9925599102494017, 'ce_loss_with_ablation': 8.169480323791504, 'ce_loss_with_sae': 2.558809757232666, 'ce_loss_without_sae': 2.5167529582977295}, 'reconstruction_quality': {'explained_variance': 0.05337132140994072, 'mse': 25.29084587097168, 'cossim': 0.9530481696128845}, 'shrinkage': {'l2_norm_in': 49.27791976928711, 'l2_norm_out': 1.6272038221359253, 'l2_ratio': 0.03219027444720268, 'relative_reconstruction_bias': 0.03544936701655388}, 'sparsity': {'l0': 5479.34228515625, 'l1': 4641.95654296875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9956470047326853, 'ce_loss_with_ablation': 8.463839530944824, 'ce_loss_with_sae': 2.529478073120117, 'ce_loss_without_sae': 2.503532886505127}, 'reconstruction_quality': {'explained_variance': 0.05576380714774132, 'mse': 25.82417106628418, 'cossim': 0.9549843072891235}, 'shrinkage': {'l2_norm_in': 49.47068786621094, 'l2_norm_out': 1.638170838356018, 'l2_ratio': 0.03229282423853874, 'relative_reconstruction_bias': 0.03544503077864647}, 'sparsity': {'l0': 5544.86669921875, 'l1': 4713.52490234375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9934242584880751, 'ce_loss_with_ablation': 8.111512184143066, 'ce_loss_with_sae': 2.535466432571411, 'ce_loss_without_sae': 2.4985570907592773}, 'reconstruction_quality': {'explained_variance': 0.05664990097284317, 'mse': 25.4887638092041, 'cossim': 0.9549561738967896}, 'shrinkage': {'l2_norm_in': 49.46797180175781, 'l2_norm_out': 1.6372852325439453, 'l2_ratio': 0.03228902816772461, 'relative_reconstruction_bias': 0.03544389829039574}, 'sparsity': {'l0': 5606.3837890625, 'l1': 4756.52490234375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9939946147757767, 'ce_loss_with_ablation': 8.19448471069336, 'ce_loss_with_sae': 2.5495493412017822, 'ce_loss_without_sae': 2.51544451713562}, 'reconstruction_quality': {'explained_variance': 0.05181291326880455, 'mse': 24.955846786499023, 'cossim': 0.9539392590522766}, 'shrinkage': {'l2_norm_in': 49.30617904663086, 'l2_norm_out': 1.6296364068984985, 'l2_ratio': 0.03224143385887146, 'relative_reconstruction_bias': 0.035466935485601425}, 'sparsity': {'l0': 5684.04052734375, 'l1': 4804.75927734375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9927042943102137, 'ce_loss_with_ablation': 8.033550262451172, 'ce_loss_with_sae': 2.495112657546997, 'ce_loss_without_sae': 2.454408884048462}, 'reconstruction_quality': {'explained_variance': 0.04588237404823303, 'mse': 24.66506576538086, 'cossim': 0.9554380774497986}, 'shrinkage': {'l2_norm_in': 48.72943115234375, 'l2_norm_out': 1.6116570234298706, 'l2_ratio': 0.03230993077158928, 'relative_reconstruction_bias': 0.035433605313301086}, 'sparsity': {'l0': 5749.830078125, 'l1': 4812.716796875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9939217451060107, 'ce_loss_with_ablation': 8.174964904785156, 'ce_loss_with_sae': 2.47031569480896, 'ce_loss_without_sae': 2.435429334640503}, 'reconstruction_quality': {'explained_variance': 0.04343009367585182, 'mse': 24.447528839111328, 'cossim': 0.9543976187705994}, 'shrinkage': {'l2_norm_in': 48.95066452026367, 'l2_norm_out': 1.6166969537734985, 'l2_ratio': 0.03225173428654671, 'relative_reconstruction_bias': 0.035420212894678116}, 'sparsity': {'l0': 5804.27099609375, 'l1': 4867.4892578125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
Traceback (most recent call last):
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 152, in run_trainer_with_interruption_handling
    sae = trainer.fit()
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/sae_trainer.py", line 191, in fit
    self._run_and_log_evals()
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/sae_trainer.py", line 340, in _run_and_log_evals
    eval_metrics, _ = run_evals(
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/evals.py", line 139, in run_evals
    reconstruction_metrics = get_downstream_reconstruction_metrics(
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/evals.py", line 349, in get_downstream_reconstruction_metrics
    metrics[f"{metric_name}"] = torch.cat(metric_values).mean().item()
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 27, in interrupt_callback
    raise InterruptedException()
sae_lens.sae_training_runner.InterruptedException

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/data/yusenp/NLP/KAN-LLaMA/preliminary_exploration/train_SAE.py", line 94, in <module>
    main()
  File "/data/yusenp/NLP/KAN-LLaMA/preliminary_exploration/train_SAE.py", line 89, in main
    sparse_autoencoder = SAETrainingRunner(cfg).run()
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 113, in run
    sae = self.run_trainer_with_interruption_handling(trainer)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 157, in run_trainer_with_interruption_handling
    self.save_checkpoint(trainer, checkpoint_name=checkpoint_name)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 221, in save_checkpoint
    model_artifact.add_file(str(weights_path))
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/wandb/sdk/artifacts/_validators.py", line 115, in wrapper
    return method(self, *args, **kwargs)
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/wandb/sdk/artifacts/artifact.py", line 1325, in add_file
    digest = md5_file_b64(local_path)
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/wandb/sdk/lib/hashutil.py", line 47, in md5_file_b64
    return _b64_from_hasher(_md5_file_hasher(*paths))
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/wandb/sdk/lib/hashutil.py", line 67, in _md5_file_hasher
    md5_hash.update(mview)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 27, in interrupt_callback
    raise InterruptedException()
sae_lens.sae_training_runner.InterruptedException
Traceback (most recent call last):
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 152, in run_trainer_with_interruption_handling
    sae = trainer.fit()
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/sae_trainer.py", line 191, in fit
    self._run_and_log_evals()
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/sae_trainer.py", line 340, in _run_and_log_evals
    eval_metrics, _ = run_evals(
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/evals.py", line 139, in run_evals
    reconstruction_metrics = get_downstream_reconstruction_metrics(
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/evals.py", line 349, in get_downstream_reconstruction_metrics
    metrics[f"{metric_name}"] = torch.cat(metric_values).mean().item()
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 27, in interrupt_callback
    raise InterruptedException()
sae_lens.sae_training_runner.InterruptedException

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/data/yusenp/NLP/KAN-LLaMA/preliminary_exploration/train_SAE.py", line 94, in <module>
    main()
  File "/data/yusenp/NLP/KAN-LLaMA/preliminary_exploration/train_SAE.py", line 89, in main
    sparse_autoencoder = SAETrainingRunner(cfg).run()
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 113, in run
    sae = self.run_trainer_with_interruption_handling(trainer)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 157, in run_trainer_with_interruption_handling
    self.save_checkpoint(trainer, checkpoint_name=checkpoint_name)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 221, in save_checkpoint
    model_artifact.add_file(str(weights_path))
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/wandb/sdk/artifacts/_validators.py", line 115, in wrapper
    return method(self, *args, **kwargs)
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/wandb/sdk/artifacts/artifact.py", line 1325, in add_file
    digest = md5_file_b64(local_path)
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/wandb/sdk/lib/hashutil.py", line 47, in md5_file_b64
    return _b64_from_hasher(_md5_file_hasher(*paths))
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/wandb/sdk/lib/hashutil.py", line 67, in _md5_file_hasher
    md5_hash.update(mview)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 27, in interrupt_callback
    raise InterruptedException()
sae_lens.sae_training_runner.InterruptedException
Exception ignored in atexit callback: <function _start_and_connect_service.<locals>.teardown_atexit at 0x7f34bceafbe0>
Traceback (most recent call last):
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/wandb/sdk/lib/service_connection.py", line 94, in teardown_atexit
    conn.teardown(hooks.exit_code)
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/wandb/sdk/lib/service_connection.py", line 226, in teardown
    self._router.join()
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/wandb/sdk/interface/router.py", line 75, in join
    self._thread.join()
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/threading.py", line 1096, in join
    self._wait_for_tstate_lock()
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/threading.py", line 1116, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 27, in interrupt_callback
    raise InterruptedException()
sae_lens.sae_training_runner.InterruptedException:
