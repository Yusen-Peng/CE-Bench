Estimating norm scaling factor: 100%|██████████| 1000/1000 [00:39<00:00, 25.14it/s]
8000| auxiliary_reconstruction_loss: 960.00000 | l1_loss: 248.00000 | mse_loss: 21.62500: 100%|██████████| 4096000/4096000 [12:48<00:00, 5327.81it/s] 
                                                               
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.41255128200930524, 'ce_loss_with_ablation': 7.981978893280029, 'ce_loss_with_sae': 5.518618583679199, 'ce_loss_without_sae': 2.0109386444091797}, 'reconstruction_quality': {'explained_variance': -0.12974034249782562, 'mse': 3.9925057888031006, 'cossim': 0.2881588637828827}, 'shrinkage': {'l2_norm_in': 46.807342529296875, 'l2_norm_out': 0.1962890625, 'l2_ratio': 0.0007386822253465652, 'relative_reconstruction_bias': 0.027407372370362282}, 'sparsity': {'l0': 203.2138214111328, 'l1': 308.0}, 'token_stats': {'total_tokens_eval_reconstruction': 20480, 'total_tokens_eval_sparsity_variance': 20480}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.6104605735131041, 'ce_loss_with_ablation': 7.871342658996582, 'ce_loss_with_sae': 4.184729099273682, 'ce_loss_without_sae': 1.8322736024856567}, 'reconstruction_quality': {'explained_variance': -0.13627342879772186, 'mse': 3.1677298545837402, 'cossim': 0.5105407238006592}, 'shrinkage': {'l2_norm_in': 44.466094970703125, 'l2_norm_out': 0.6328125, 'l2_ratio': 0.012070494703948498, 'relative_reconstruction_bias': 0.030064744874835014}, 'sparsity': {'l0': 350.4998474121094, 'l1': 524.0}, 'token_stats': {'total_tokens_eval_reconstruction': 20480, 'total_tokens_eval_sparsity_variance': 20480}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.8094597843088699, 'ce_loss_with_ablation': 7.940507411956787, 'ce_loss_with_sae': 3.040858745574951, 'ce_loss_without_sae': 1.887521505355835}, 'reconstruction_quality': {'explained_variance': -0.10958892107009888, 'mse': 3.784343719482422, 'cossim': 0.6302981376647949}, 'shrinkage': {'l2_norm_in': 46.514225006103516, 'l2_norm_out': 0.79296875, 'l2_ratio': 0.014876496978104115, 'relative_reconstruction_bias': 0.0315483920276165}, 'sparsity': {'l0': 437.4482116699219, 'l1': 688.0}, 'token_stats': {'total_tokens_eval_reconstruction': 20480, 'total_tokens_eval_sparsity_variance': 20480}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.8795338594624706, 'ce_loss_with_ablation': 8.141507148742676, 'ce_loss_with_sae': 2.7947967052459717, 'ce_loss_without_sae': 2.0624797344207764}, 'reconstruction_quality': {'explained_variance': -0.09524818509817123, 'mse': 4.032429218292236, 'cossim': 0.708349347114563}, 'shrinkage': {'l2_norm_in': 47.210445404052734, 'l2_norm_out': 0.890625, 'l2_ratio': 0.016689470037817955, 'relative_reconstruction_bias': 0.03151978179812431}, 'sparsity': {'l0': 449.15966796875, 'l1': 752.0}, 'token_stats': {'total_tokens_eval_reconstruction': 20480, 'total_tokens_eval_sparsity_variance': 20480}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.8999316824651634, 'ce_loss_with_ablation': 7.874908447265625, 'ce_loss_with_sae': 2.520754098892212, 'ce_loss_without_sae': 1.92539644241333}, 'reconstruction_quality': {'explained_variance': -0.10349640995264053, 'mse': 3.6622440814971924, 'cossim': 0.7297706604003906}, 'shrinkage': {'l2_norm_in': 46.19028091430664, 'l2_norm_out': 0.890625, 'l2_ratio': 0.017387378960847855, 'relative_reconstruction_bias': 0.031433481723070145}, 'sparsity': {'l0': 468.4965515136719, 'l1': 704.0}, 'token_stats': {'total_tokens_eval_reconstruction': 20480, 'total_tokens_eval_sparsity_variance': 20480}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.8761776221572632, 'ce_loss_with_ablation': 7.983587741851807, 'ce_loss_with_sae': 2.8817074298858643, 'ce_loss_without_sae': 2.1607041358947754}, 'reconstruction_quality': {'explained_variance': -0.09769395738840103, 'mse': 4.011699676513672, 'cossim': 0.7084952592849731}, 'shrinkage': {'l2_norm_in': 47.08127975463867, 'l2_norm_out': 0.8828125, 'l2_ratio': 0.016753921285271645, 'relative_reconstruction_bias': 0.03143741562962532}, 'sparsity': {'l0': 508.1202087402344, 'l1': 740.0}, 'token_stats': {'total_tokens_eval_reconstruction': 20480, 'total_tokens_eval_sparsity_variance': 20480}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9144352166629276, 'ce_loss_with_ablation': 7.211080074310303, 'ce_loss_with_sae': 2.2320077419281006, 'ce_loss_without_sae': 1.7661100625991821}, 'reconstruction_quality': {'explained_variance': -0.09341754764318466, 'mse': 4.003148555755615, 'cossim': 0.7318005561828613}, 'shrinkage': {'l2_norm_in': 47.0997314453125, 'l2_norm_out': 0.9140625, 'l2_ratio': 0.017388442531228065, 'relative_reconstruction_bias': 0.031606853008270264}, 'sparsity': {'l0': 486.42437744140625, 'l1': 764.0}, 'token_stats': {'total_tokens_eval_reconstruction': 20480, 'total_tokens_eval_sparsity_variance': 20480}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9021010359035941, 'ce_loss_with_ablation': 7.588014125823975, 'ce_loss_with_sae': 2.49560809135437, 'ce_loss_without_sae': 1.9429634809494019}, 'reconstruction_quality': {'explained_variance': -0.09975264221429825, 'mse': 4.065793037414551, 'cossim': 0.718772828578949}, 'shrinkage': {'l2_norm_in': 46.84039306640625, 'l2_norm_out': 0.890625, 'l2_ratio': 0.017089365050196648, 'relative_reconstruction_bias': 0.03144615516066551}, 'sparsity': {'l0': 502.3446350097656, 'l1': 760.0}, 'token_stats': {'total_tokens_eval_reconstruction': 20480, 'total_tokens_eval_sparsity_variance': 20480}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.8799831344672002, 'ce_loss_with_ablation': 7.73548698425293, 'ce_loss_with_sae': 2.8670358657836914, 'ce_loss_without_sae': 2.203050136566162}, 'reconstruction_quality': {'explained_variance': -0.09916423261165619, 'mse': 4.1270880699157715, 'cossim': 0.7178494334220886}, 'shrinkage': {'l2_norm_in': 47.02960205078125, 'l2_norm_out': 0.8984375, 'l2_ratio': 0.017090389505028725, 'relative_reconstruction_bias': 0.0315064899623394}, 'sparsity': {'l0': 507.283447265625, 'l1': 768.0}, 'token_stats': {'total_tokens_eval_reconstruction': 20480, 'total_tokens_eval_sparsity_variance': 20480}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9167443959439127, 'ce_loss_with_ablation': 7.726574897766113, 'ce_loss_with_sae': 2.289952278137207, 'ce_loss_without_sae': 1.7962167263031006}, 'reconstruction_quality': {'explained_variance': -0.1289132684469223, 'mse': 2.8388192653656006, 'cossim': 0.7446029186248779}, 'shrinkage': {'l2_norm_in': 43.511207580566406, 'l2_norm_out': 0.828125, 'l2_ratio': 0.017830369994044304, 'relative_reconstruction_bias': 0.031204862520098686}, 'sparsity': {'l0': 467.0519104003906, 'l1': 576.0}, 'token_stats': {'total_tokens_eval_reconstruction': 20480, 'total_tokens_eval_sparsity_variance': 20480}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.8838699091831681, 'ce_loss_with_ablation': 8.022222518920898, 'ce_loss_with_sae': 2.8630077838897705, 'ce_loss_without_sae': 2.185147762298584}, 'reconstruction_quality': {'explained_variance': -0.10209017246961594, 'mse': 3.7629525661468506, 'cossim': 0.7318989634513855}, 'shrinkage': {'l2_norm_in': 46.528377532958984, 'l2_norm_out': 0.8984375, 'l2_ratio': 0.017441561445593834, 'relative_reconstruction_bias': 0.03137668967247009}, 'sparsity': {'l0': 494.990478515625, 'l1': 724.0}, 'token_stats': {'total_tokens_eval_reconstruction': 20480, 'total_tokens_eval_sparsity_variance': 20480}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9193987554189328, 'ce_loss_with_ablation': 7.958876132965088, 'ce_loss_with_sae': 2.2593679428100586, 'ce_loss_without_sae': 1.7597072124481201}, 'reconstruction_quality': {'explained_variance': -0.09434070438146591, 'mse': 4.027294158935547, 'cossim': 0.7274414896965027}, 'shrinkage': {'l2_norm_in': 47.17161178588867, 'l2_norm_out': 0.9140625, 'l2_ratio': 0.01733500137925148, 'relative_reconstruction_bias': 0.03152984380722046}, 'sparsity': {'l0': 499.4665222167969, 'l1': 768.0}, 'token_stats': {'total_tokens_eval_reconstruction': 20480, 'total_tokens_eval_sparsity_variance': 20480}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9139203298484369, 'ce_loss_with_ablation': 7.333769798278809, 'ce_loss_with_sae': 2.253650665283203, 'ce_loss_without_sae': 1.7751680612564087}, 'reconstruction_quality': {'explained_variance': -0.12738744914531708, 'mse': 2.8671586513519287, 'cossim': 0.7397838830947876}, 'shrinkage': {'l2_norm_in': 43.64094161987305, 'l2_norm_out': 0.828125, 'l2_ratio': 0.017720583826303482, 'relative_reconstruction_bias': 0.031213415786623955}, 'sparsity': {'l0': 469.23077392578125, 'l1': 576.0}, 'token_stats': {'total_tokens_eval_reconstruction': 20480, 'total_tokens_eval_sparsity_variance': 20480}}
