Estimating norm scaling factor: 100%|██████████| 1000/1000 [00:39<00:00, 25.60it/s]
100| mse_loss: 22.55636:   1%|▏         | 51200/4096000 [02:00<Traceback (most recent call last):
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/runpy.py", line 196, in _run_module_as_main
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.7628828341463478, 'ce_loss_with_ablation': 7.897684097290039, 'ce_loss_with_sae': 3.2659518718719482, 'ce_loss_without_sae': 1.8263294696807861}, 'reconstruction_quality': {'explained_variance': -0.0826166644692421, 'mse': 3.1610665321350098, 'cossim': 0.7200555801391602}, 'shrinkage': {'l2_norm_in': 41.60581970214844, 'l2_norm_out': 1.0479475259780884, 'l2_ratio': 0.024081656709313393, 'relative_reconstruction_bias': 0.036589883267879486}, 'sparsity': {'l0': 8114.6767578125, 'l1': -120.17870330810547}, 'token_stats': {'total_tokens_eval_reconstruction': 20480, 'total_tokens_eval_sparsity_variance': 20480}}
    return _run_code(code, main_globals, None,
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/data/yusenp/NLP/KAN-LLaMA/preliminary_exploration/train_SAE.py", line 91, in <module>
    main()
  File "/data/yusenp/NLP/KAN-LLaMA/preliminary_exploration/train_SAE.py", line 85, in main
    sparse_autoencoder = SAETrainingRunner(cfg).run()
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 113, in run
    sae = self.run_trainer_with_interruption_handling(trainer)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 152, in run_trainer_with_interruption_handling
    sae = trainer.fit()
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/sae_trainer.py", line 191, in fit
    self._run_and_log_evals()
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/sae_trainer.py", line 360, in _run_and_log_evals
    W_dec_norm_dist = self.sae.W_dec.detach().float().norm(dim=1).cpu().numpy()
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1928, in __getattr__
    raise AttributeError(
AttributeError: 'TrainingSAE' object has no attribute 'W_dec'
Traceback (most recent call last):
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/data/yusenp/NLP/KAN-LLaMA/preliminary_exploration/train_SAE.py", line 91, in <module>
    main()
  File "/data/yusenp/NLP/KAN-LLaMA/preliminary_exploration/train_SAE.py", line 85, in main
    sparse_autoencoder = SAETrainingRunner(cfg).run()
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 113, in run
    sae = self.run_trainer_with_interruption_handling(trainer)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/sae_training_runner.py", line 152, in run_trainer_with_interruption_handling
    sae = trainer.fit()
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/sae_trainer.py", line 191, in fit
    self._run_and_log_evals()
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/sae_trainer.py", line 360, in _run_and_log_evals
    W_dec_norm_dist = self.sae.W_dec.detach().float().norm(dim=1).cpu().numpy()
  File "/data/yusenp/.conda/envs/kan_llama/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1928, in __getattr__
    raise AttributeError(
AttributeError: 'TrainingSAE' object has no attribute 'W_dec'
