Estimating norm scaling factor: 100%|██████████| 1000/1000 [00:30<00:00, 32.36it/s]
Estimating norm scaling factor: 100%|██████████| 1000/1000 [00:35<00:00, 28.26it/s]
2400| l0_loss: 23336.09375 | mse_loss: 8.77525: 100%|██████████| 1228800/1228800 [05:10<00:00, 3958.54it/s]
                                                               
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.24871900280044856, 'ce_loss_with_ablation': 8.148616790771484, 'ce_loss_with_sae': 6.658390522003174, 'ce_loss_without_sae': 2.157010793685913}, 'reconstruction_quality': {'explained_variance': -0.05734984204173088, 'mse': 21.075998306274414, 'cossim': 0.23054857552051544}, 'shrinkage': {'l2_norm_in': 45.073707580566406, 'l2_norm_out': 0.19875645637512207, 'l2_ratio': 0.00414184620603919, 'relative_reconstruction_bias': 0.010820407420396805}, 'sparsity': {'l0': 463.8439636230469, 'l1': 138.06236267089844}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5321138125890502, 'ce_loss_with_ablation': 7.824138641357422, 'ce_loss_with_sae': 4.856225967407227, 'ce_loss_without_sae': 2.246548652648926}, 'reconstruction_quality': {'explained_variance': -0.042319219559431076, 'mse': 20.393077850341797, 'cossim': 0.4965639114379883}, 'shrinkage': {'l2_norm_in': 44.8381233215332, 'l2_norm_out': 0.7151128649711609, 'l2_ratio': 0.015387045219540596, 'relative_reconstruction_bias': 0.022378994151949883}, 'sparsity': {'l0': 885.4990234375, 'l1': 558.3309936523438}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.6730124304356222, 'ce_loss_with_ablation': 8.016386985778809, 'ce_loss_with_sae': 4.19910192489624, 'ce_loss_without_sae': 2.3444485664367676}, 'reconstruction_quality': {'explained_variance': 0.019328076392412186, 'mse': 24.564260482788086, 'cossim': 0.6025204062461853}, 'shrinkage': {'l2_norm_in': 48.61422348022461, 'l2_norm_out': 1.0685839653015137, 'l2_ratio': 0.019391749054193497, 'relative_reconstruction_bias': 0.032614316791296005}, 'sparsity': {'l0': 1422.6005859375, 'l1': 1052.53369140625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.879173604183387, 'ce_loss_with_ablation': 8.240143775939941, 'ce_loss_with_sae': 2.8294150829315186, 'ce_loss_without_sae': 2.0858089923858643}, 'reconstruction_quality': {'explained_variance': 0.02769996039569378, 'mse': 24.372116088867188, 'cossim': 0.7018948793411255}, 'shrinkage': {'l2_norm_in': 48.379493713378906, 'l2_norm_out': 1.2254379987716675, 'l2_ratio': 0.022889304906129837, 'relative_reconstruction_bias': 0.03479486331343651}, 'sparsity': {'l0': 2138.93408203125, 'l1': 1517.864501953125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9491321131434438, 'ce_loss_with_ablation': 8.336833953857422, 'ce_loss_with_sae': 2.3807008266448975, 'ce_loss_without_sae': 2.0614871978759766}, 'reconstruction_quality': {'explained_variance': 0.02754126489162445, 'mse': 24.06859588623047, 'cossim': 0.7581066489219666}, 'shrinkage': {'l2_norm_in': 48.40412139892578, 'l2_norm_out': 1.3213716745376587, 'l2_ratio': 0.025126172229647636, 'relative_reconstruction_bias': 0.036010678857564926}, 'sparsity': {'l0': 2770.038818359375, 'l1': 1964.9840087890625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9520095175778756, 'ce_loss_with_ablation': 8.125807762145996, 'ce_loss_with_sae': 2.6779332160949707, 'ce_loss_without_sae': 2.4033076763153076}, 'reconstruction_quality': {'explained_variance': 0.029229653999209404, 'mse': 24.03016471862793, 'cossim': 0.778427243232727}, 'shrinkage': {'l2_norm_in': 48.1058464050293, 'l2_norm_out': 1.3521137237548828, 'l2_ratio': 0.026189809665083885, 'relative_reconstruction_bias': 0.036096688359975815}, 'sparsity': {'l0': 3265.299560546875, 'l1': 2312.636474609375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9531205549072487, 'ce_loss_with_ablation': 8.143976211547852, 'ce_loss_with_sae': 2.7074801921844482, 'ce_loss_without_sae': 2.440084934234619}, 'reconstruction_quality': {'explained_variance': 0.036604948341846466, 'mse': 24.510583877563477, 'cossim': 0.8029801249504089}, 'shrinkage': {'l2_norm_in': 48.534820556640625, 'l2_norm_out': 1.3980331420898438, 'l2_ratio': 0.0270762387663126, 'relative_reconstruction_bias': 0.036038126796483994}, 'sparsity': {'l0': 3629.07275390625, 'l1': 2612.658203125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9658577221645696, 'ce_loss_with_ablation': 8.02258586883545, 'ce_loss_with_sae': 2.6498889923095703, 'ce_loss_without_sae': 2.4599685668945312}, 'reconstruction_quality': {'explained_variance': 0.029770372435450554, 'mse': 23.9235897064209, 'cossim': 0.820014476776123}, 'shrinkage': {'l2_norm_in': 47.9874267578125, 'l2_norm_out': 1.4121342897415161, 'l2_ratio': 0.027898449450731277, 'relative_reconstruction_bias': 0.03606656938791275}, 'sparsity': {'l0': 3938.53759765625, 'l1': 2816.04296875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9753332880169939, 'ce_loss_with_ablation': 8.403814315795898, 'ce_loss_with_sae': 2.6155624389648438, 'ce_loss_without_sae': 2.469174385070801}, 'reconstruction_quality': {'explained_variance': 0.030871763825416565, 'mse': 23.863449096679688, 'cossim': 0.8302149176597595}, 'shrinkage': {'l2_norm_in': 48.04714584350586, 'l2_norm_out': 1.4291428327560425, 'l2_ratio': 0.02828533761203289, 'relative_reconstruction_bias': 0.036087777465581894}, 'sparsity': {'l0': 4157.02099609375, 'l1': 3016.968505859375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9720230907052083, 'ce_loss_with_ablation': 8.205121040344238, 'ce_loss_with_sae': 2.600896120071411, 'ce_loss_without_sae': 2.4395945072174072}, 'reconstruction_quality': {'explained_variance': 0.03951308876276016, 'mse': 24.454303741455078, 'cossim': 0.8353025317192078}, 'shrinkage': {'l2_norm_in': 48.33676528930664, 'l2_norm_out': 1.44529390335083, 'l2_ratio': 0.02845245599746704, 'relative_reconstruction_bias': 0.03608094900846481}, 'sparsity': {'l0': 4300.04248046875, 'l1': 3151.574951171875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.975427761548561, 'ce_loss_with_ablation': 8.366900444030762, 'ce_loss_with_sae': 2.603806257247925, 'ce_loss_without_sae': 2.4586267471313477}, 'reconstruction_quality': {'explained_variance': 0.05055448040366173, 'mse': 24.616901397705078, 'cossim': 0.8590289354324341}, 'shrinkage': {'l2_norm_in': 48.73853302001953, 'l2_norm_out': 1.4960544109344482, 'l2_ratio': 0.029384929686784744, 'relative_reconstruction_bias': 0.03610881045460701}, 'sparsity': {'l0': 4417.85009765625, 'l1': 3278.693115234375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9757199328859443, 'ce_loss_with_ablation': 8.36906623840332, 'ce_loss_with_sae': 2.2526354789733887, 'ce_loss_without_sae': 2.1004326343536377}, 'reconstruction_quality': {'explained_variance': 0.04581823572516441, 'mse': 24.266944885253906, 'cossim': 0.8609917759895325}, 'shrinkage': {'l2_norm_in': 48.47297286987305, 'l2_norm_out': 1.4943151473999023, 'l2_ratio': 0.029551351442933083, 'relative_reconstruction_bias': 0.03608028218150139}, 'sparsity': {'l0': 4518.00732421875, 'l1': 3351.169677734375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.976934106977899, 'ce_loss_with_ablation': 8.188097953796387, 'ce_loss_with_sae': 2.500049591064453, 'ce_loss_without_sae': 2.3657519817352295}, 'reconstruction_quality': {'explained_variance': 0.03311612084507942, 'mse': 23.6216983795166, 'cossim': 0.8499564528465271}, 'shrinkage': {'l2_norm_in': 47.993072509765625, 'l2_norm_out': 1.4606894254684448, 'l2_ratio': 0.029176203534007072, 'relative_reconstruction_bias': 0.03610621765255928}, 'sparsity': {'l0': 4580.01513671875, 'l1': 3383.952392578125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9746812291177158, 'ce_loss_with_ablation': 8.206550598144531, 'ce_loss_with_sae': 2.6402974128723145, 'ce_loss_without_sae': 2.4957058429718018}, 'reconstruction_quality': {'explained_variance': 0.027597889304161072, 'mse': 23.247821807861328, 'cossim': 0.8415021896362305}, 'shrinkage': {'l2_norm_in': 47.759132385253906, 'l2_norm_out': 1.4358924627304077, 'l2_ratio': 0.02877020835876465, 'relative_reconstruction_bias': 0.03612030670046806}, 'sparsity': {'l0': 4623.86083984375, 'l1': 3404.548095703125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9809857170223286, 'ce_loss_with_ablation': 8.353255271911621, 'ce_loss_with_sae': 2.5233094692230225, 'ce_loss_without_sae': 2.410308599472046}, 'reconstruction_quality': {'explained_variance': 0.042016077786684036, 'mse': 24.26514434814453, 'cossim': 0.8499576449394226}, 'shrinkage': {'l2_norm_in': 48.4339599609375, 'l2_norm_out': 1.474273681640625, 'l2_ratio': 0.02915217913687229, 'relative_reconstruction_bias': 0.036109667271375656}, 'sparsity': {'l0': 4646.81591796875, 'l1': 3451.160888671875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9814668595442838, 'ce_loss_with_ablation': 8.41412353515625, 'ce_loss_with_sae': 2.54237699508667, 'ce_loss_without_sae': 2.431500196456909}, 'reconstruction_quality': {'explained_variance': 0.03614037483930588, 'mse': 23.75376319885254, 'cossim': 0.8555507659912109}, 'shrinkage': {'l2_norm_in': 47.9381103515625, 'l2_norm_out': 1.4688338041305542, 'l2_ratio': 0.029432082548737526, 'relative_reconstruction_bias': 0.036090120673179626}, 'sparsity': {'l0': 4678.248046875, 'l1': 3463.76416015625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
