Training SAE:   0%|          | 0/4096000 [00:00<?, ?it/s]                          /data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:738: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(scaling factor:  46%|████▋     | 465/1000 [00:00<00:01, 519.34it/s]
Estimating norm scaling factor: 100%|██████████| 1000/1000 [00:01<00:00, 537.26it/s]
4700| l0_loss: 11419.78516 | mse_loss: 0.37096:  59%|█████▉    | 2406400/4096000 [02:51<02:00, 14018.55it/s]
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.04059146434078652, 'ce_loss_with_ablation': 7.993437767028809, 'ce_loss_with_sae': 7.7620849609375, 'ce_loss_without_sae': 2.2938945293426514}, 'reconstruction_quality': {'explained_variance': -0.007425230927765369, 'mse': 23.74806785583496, 'cossim': 0.190702423453331}, 'shrinkage': {'l2_norm_in': 46.36882781982422, 'l2_norm_out': 0.26943597197532654, 'l2_ratio': 0.003550568362697959, 'relative_reconstruction_bias': 0.13589949905872345}, 'sparsity': {'l0': 1648.3157958984375, 'l1': 104.55757141113281}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': -0.22488507687853213, 'ce_loss_with_ablation': 8.472864151000977, 'ce_loss_with_sae': 9.833740234375, 'ce_loss_without_sae': 2.4214351177215576}, 'reconstruction_quality': {'explained_variance': -0.024623317644000053, 'mse': 22.774887084960938, 'cossim': 0.28058499097824097}, 'shrinkage': {'l2_norm_in': 45.6624641418457, 'l2_norm_out': 0.11872128397226334, 'l2_ratio': 0.0011280024191364646, 'relative_reconstruction_bias': 0.036379795521497726}, 'sparsity': {'l0': 717.8246459960938, 'l1': 51.03339767456055}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.33959842407556845, 'ce_loss_with_ablation': 8.208343505859375, 'ce_loss_with_sae': 6.289405345916748, 'ce_loss_without_sae': 2.5577337741851807}, 'reconstruction_quality': {'explained_variance': -0.01974649913609028, 'mse': 22.644208908081055, 'cossim': 0.28911513090133667}, 'shrinkage': {'l2_norm_in': 45.78252029418945, 'l2_norm_out': 0.16528455913066864, 'l2_ratio': 0.0013341322774067521, 'relative_reconstruction_bias': 0.017891783267259598}, 'sparsity': {'l0': 497.03790283203125, 'l1': 105.3180923461914}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5439116996020025, 'ce_loss_with_ablation': 8.418126106262207, 'ce_loss_with_sae': 5.1750640869140625, 'ce_loss_without_sae': 2.4556472301483154}, 'reconstruction_quality': {'explained_variance': -0.005200617015361786, 'mse': 22.6956787109375, 'cossim': 0.39718297123908997}, 'shrinkage': {'l2_norm_in': 46.30064392089844, 'l2_norm_out': 0.5510466694831848, 'l2_ratio': 0.00798131339251995, 'relative_reconstruction_bias': 0.02687492035329342}, 'sparsity': {'l0': 539.8054809570312, 'l1': 311.9455871582031}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5845998387472566, 'ce_loss_with_ablation': 8.324442863464355, 'ce_loss_with_sae': 4.8948588371276855, 'ce_loss_without_sae': 2.457893133163452}, 'reconstruction_quality': {'explained_variance': -0.008023589849472046, 'mse': 21.662527084350586, 'cossim': 0.45814189314842224}, 'shrinkage': {'l2_norm_in': 46.08438491821289, 'l2_norm_out': 0.7366129755973816, 'l2_ratio': 0.01132131926715374, 'relative_reconstruction_bias': 0.033459678292274475}, 'sparsity': {'l0': 562.734375, 'l1': 417.2831115722656}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.689059013447485, 'ce_loss_with_ablation': 8.514806747436523, 'ce_loss_with_sae': 4.346796035766602, 'ce_loss_without_sae': 2.4659624099731445}, 'reconstruction_quality': {'explained_variance': -0.0038250552024692297, 'mse': 21.768802642822266, 'cossim': 0.5138505101203918}, 'shrinkage': {'l2_norm_in': 46.138763427734375, 'l2_norm_out': 0.8513236045837402, 'l2_ratio': 0.013838136568665504, 'relative_reconstruction_bias': 0.03498150035738945}, 'sparsity': {'l0': 655.0017700195312, 'l1': 505.9645690917969}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.7612421592284669, 'ce_loss_with_ablation': 8.2409029006958, 'ce_loss_with_sae': 3.8072593212127686, 'ce_loss_without_sae': 2.4166805744171143}, 'reconstruction_quality': {'explained_variance': 0.011945354752242565, 'mse': 22.642602920532227, 'cossim': 0.5509833693504333}, 'shrinkage': {'l2_norm_in': 46.51462173461914, 'l2_norm_out': 0.9394327402114868, 'l2_ratio': 0.015683231875300407, 'relative_reconstruction_bias': 0.03568955883383751}, 'sparsity': {'l0': 771.9674072265625, 'l1': 595.9496459960938}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.7921580848245495, 'ce_loss_with_ablation': 8.194169998168945, 'ce_loss_with_sae': 3.688754081726074, 'ce_loss_without_sae': 2.5066487789154053}, 'reconstruction_quality': {'explained_variance': 0.00596146285533905, 'mse': 22.24712562561035, 'cossim': 0.5891335606575012}, 'shrinkage': {'l2_norm_in': 46.28438949584961, 'l2_norm_out': 0.997332751750946, 'l2_ratio': 0.01740776002407074, 'relative_reconstruction_bias': 0.036252424120903015}, 'sparsity': {'l0': 833.1683959960938, 'l1': 661.6236572265625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.8334048383501695, 'ce_loss_with_ablation': 8.161482810974121, 'ce_loss_with_sae': 3.490295171737671, 'ce_loss_without_sae': 2.5565385818481445}, 'reconstruction_quality': {'explained_variance': 0.005323001649230719, 'mse': 21.826536178588867, 'cossim': 0.6175559163093567}, 'shrinkage': {'l2_norm_in': 45.978057861328125, 'l2_norm_out': 1.03241765499115, 'l2_ratio': 0.018461061641573906, 'relative_reconstruction_bias': 0.03676823526620865}, 'sparsity': {'l0': 942.6849975585938, 'l1': 721.6007690429688}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.8564609668231226, 'ce_loss_with_ablation': 8.346538543701172, 'ce_loss_with_sae': 3.310671091079712, 'ce_loss_without_sae': 2.466682195663452}, 'reconstruction_quality': {'explained_variance': 0.019417909905314445, 'mse': 22.677398681640625, 'cossim': 0.6512033343315125}, 'shrinkage': {'l2_norm_in': 46.60456466674805, 'l2_norm_out': 1.1008220911026, 'l2_ratio': 0.01972196437418461, 'relative_reconstruction_bias': 0.03706216812133789}, 'sparsity': {'l0': 1042.6871337890625, 'l1': 809.1591796875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.8866560809404103, 'ce_loss_with_ablation': 8.018692016601562, 'ce_loss_with_sae': 3.1204891204833984, 'ce_loss_without_sae': 2.4943370819091797}, 'reconstruction_quality': {'explained_variance': 0.023872334510087967, 'mse': 22.907590866088867, 'cossim': 0.6637272834777832}, 'shrinkage': {'l2_norm_in': 46.766441345214844, 'l2_norm_out': 1.128421425819397, 'l2_ratio': 0.02034848928451538, 'relative_reconstruction_bias': 0.03728475421667099}, 'sparsity': {'l0': 1139.7362060546875, 'l1': 881.7615356445312}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9058312530196436, 'ce_loss_with_ablation': 8.227436065673828, 'ce_loss_with_sae': 3.00106143951416, 'ce_loss_without_sae': 2.457736015319824}, 'reconstruction_quality': {'explained_variance': 0.026360759511590004, 'mse': 22.74797821044922, 'cossim': 0.6934059262275696}, 'shrinkage': {'l2_norm_in': 46.6169548034668, 'l2_norm_out': 1.171432375907898, 'l2_ratio': 0.02161681279540062, 'relative_reconstruction_bias': 0.037351787090301514}, 'sparsity': {'l0': 1222.106689453125, 'l1': 945.5253295898438}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9281926925686956, 'ce_loss_with_ablation': 8.218037605285645, 'ce_loss_with_sae': 2.4655277729034424, 'ce_loss_without_sae': 2.0204992294311523}, 'reconstruction_quality': {'explained_variance': 0.003831534180790186, 'mse': 20.18296241760254, 'cossim': 0.7221550941467285}, 'shrinkage': {'l2_norm_in': 44.8218994140625, 'l2_norm_out': 1.160967469215393, 'l2_ratio': 0.02303132228553295, 'relative_reconstruction_bias': 0.03737085312604904}, 'sparsity': {'l0': 1316.5400390625, 'l1': 957.5089111328125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9421559691192244, 'ce_loss_with_ablation': 7.762081623077393, 'ce_loss_with_sae': 2.5750627517700195, 'ce_loss_without_sae': 2.256603717803955}, 'reconstruction_quality': {'explained_variance': -0.017193282023072243, 'mse': 18.645734786987305, 'cossim': 0.730172336101532}, 'shrinkage': {'l2_norm_in': 43.384544372558594, 'l2_norm_out': 1.1284946203231812, 'l2_ratio': 0.02358563244342804, 'relative_reconstruction_bias': 0.03738580271601677}, 'sparsity': {'l0': 1400.7044677734375, 'l1': 973.6724853515625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9480422229948484, 'ce_loss_with_ablation': 7.718745231628418, 'ce_loss_with_sae': 2.573786497116089, 'ce_loss_without_sae': 2.2918152809143066}, 'reconstruction_quality': {'explained_variance': -0.0208947341889143, 'mse': 18.121315002441406, 'cossim': 0.7399879097938538}, 'shrinkage': {'l2_norm_in': 43.1464958190918, 'l2_norm_out': 1.135269045829773, 'l2_ratio': 0.023993581533432007, 'relative_reconstruction_bias': 0.03745375946164131}, 'sparsity': {'l0': 1470.8580322265625, 'l1': 1021.5932006835938}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9590518281429405, 'ce_loss_with_ablation': 7.9982428550720215, 'ce_loss_with_sae': 2.535141706466675, 'ce_loss_without_sae': 2.3018863201141357}, 'reconstruction_quality': {'explained_variance': -0.01643030159175396, 'mse': 18.241535186767578, 'cossim': 0.7581798434257507}, 'shrinkage': {'l2_norm_in': 43.04204177856445, 'l2_norm_out': 1.165176510810852, 'l2_ratio': 0.02488088048994541, 'relative_reconstruction_bias': 0.0374760702252388}, 'sparsity': {'l0': 1526.1990966796875, 'l1': 1080.8070068359375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9526751037224215, 'ce_loss_with_ablation': 7.808859825134277, 'ce_loss_with_sae': 2.633174419403076, 'ce_loss_without_sae': 2.376068115234375}, 'reconstruction_quality': {'explained_variance': 0.03205059841275215, 'mse': 21.985864639282227, 'cossim': 0.7805423736572266}, 'shrinkage': {'l2_norm_in': 46.395320892333984, 'l2_norm_out': 1.3185423612594604, 'l2_ratio': 0.025798141956329346, 'relative_reconstruction_bias': 0.03752994164824486}, 'sparsity': {'l0': 1630.033447265625, 'l1': 1252.8724365234375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9492324196090385, 'ce_loss_with_ablation': 8.106575965881348, 'ce_loss_with_sae': 2.3598179817199707, 'ce_loss_without_sae': 2.0524654388427734}, 'reconstruction_quality': {'explained_variance': 0.04222524166107178, 'mse': 22.778759002685547, 'cossim': 0.7876976728439331}, 'shrinkage': {'l2_norm_in': 47.05243682861328, 'l2_norm_out': 1.353427529335022, 'l2_ratio': 0.026126910001039505, 'relative_reconstruction_bias': 0.0375492237508297}, 'sparsity': {'l0': 1690.8758544921875, 'l1': 1324.5987548828125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9600066099267768, 'ce_loss_with_ablation': 8.093259811401367, 'ce_loss_with_sae': 2.3936188220977783, 'ce_loss_without_sae': 2.156174659729004}, 'reconstruction_quality': {'explained_variance': -0.0140537666156888, 'mse': 18.295320510864258, 'cossim': 0.7875298857688904}, 'shrinkage': {'l2_norm_in': 43.29137420654297, 'l2_norm_out': 1.2194281816482544, 'l2_ratio': 0.026253310963511467, 'relative_reconstruction_bias': 0.03752925619482994}, 'sparsity': {'l0': 1744.2322998046875, 'l1': 1263.9202880859375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9646920297444131, 'ce_loss_with_ablation': 7.865519046783447, 'ce_loss_with_sae': 2.506915807723999, 'ce_loss_without_sae': 2.3107895851135254}, 'reconstruction_quality': {'explained_variance': -0.011657738126814365, 'mse': 18.690017700195312, 'cossim': 0.8006537556648254}, 'shrinkage': {'l2_norm_in': 43.306453704833984, 'l2_norm_out': 1.2439301013946533, 'l2_ratio': 0.026839284226298332, 'relative_reconstruction_bias': 0.03750448301434517}, 'sparsity': {'l0': 1838.0068359375, 'l1': 1332.021484375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9710151315702589, 'ce_loss_with_ablation': 7.900069236755371, 'ce_loss_with_sae': 2.448291540145874, 'ce_loss_without_sae': 2.285555601119995}, 'reconstruction_quality': {'explained_variance': -0.01637876406311989, 'mse': 17.940343856811523, 'cossim': 0.7971746325492859}, 'shrinkage': {'l2_norm_in': 42.85274887084961, 'l2_norm_out': 1.2196370363235474, 'l2_ratio': 0.026617109775543213, 'relative_reconstruction_bias': 0.03754342347383499}, 'sparsity': {'l0': 1864.0213623046875, 'l1': 1352.6077880859375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9730197468353988, 'ce_loss_with_ablation': 7.851823806762695, 'ce_loss_with_sae': 2.5380704402923584, 'ce_loss_without_sae': 2.390728712081909}, 'reconstruction_quality': {'explained_variance': -0.011133972555398941, 'mse': 18.11079216003418, 'cossim': 0.8094552159309387}, 'shrinkage': {'l2_norm_in': 43.109249114990234, 'l2_norm_out': 1.2505003213882446, 'l2_ratio': 0.02723369374871254, 'relative_reconstruction_bias': 0.03754211589694023}, 'sparsity': {'l0': 1945.6380615234375, 'l1': 1419.8408203125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9697923973222893, 'ce_loss_with_ablation': 8.002524375915527, 'ce_loss_with_sae': 2.3647563457489014, 'ce_loss_without_sae': 2.189148187637329}, 'reconstruction_quality': {'explained_variance': 0.044902630150318146, 'mse': 22.64227294921875, 'cossim': 0.8269138336181641}, 'shrinkage': {'l2_norm_in': 47.05255889892578, 'l2_norm_out': 1.4215143918991089, 'l2_ratio': 0.02800723910331726, 'relative_reconstruction_bias': 0.03753850609064102}, 'sparsity': {'l0': 2006.96875, 'l1': 1601.0653076171875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9651273560766815, 'ce_loss_with_ablation': 8.148221969604492, 'ce_loss_with_sae': 2.5761876106262207, 'ce_loss_without_sae': 2.3748550415039062}, 'reconstruction_quality': {'explained_variance': 0.04309718683362007, 'mse': 23.053918838500977, 'cossim': 0.8197229504585266}, 'shrinkage': {'l2_norm_in': 46.72990036010742, 'l2_norm_out': 1.3943172693252563, 'l2_ratio': 0.027671033516526222, 'relative_reconstruction_bias': 0.03747445344924927}, 'sparsity': {'l0': 2066.623779296875, 'l1': 1651.1025390625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9663818094269028, 'ce_loss_with_ablation': 8.11966323852539, 'ce_loss_with_sae': 2.672516345977783, 'ce_loss_without_sae': 2.483022689819336}, 'reconstruction_quality': {'explained_variance': 0.043974339962005615, 'mse': 22.709857940673828, 'cossim': 0.817882239818573}, 'shrinkage': {'l2_norm_in': 46.8509521484375, 'l2_norm_out': 1.3959499597549438, 'l2_ratio': 0.027611494064331055, 'relative_reconstruction_bias': 0.037528421729803085}, 'sparsity': {'l0': 2140.494384765625, 'l1': 1696.1673583984375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9620126255421011, 'ce_loss_with_ablation': 8.117958068847656, 'ce_loss_with_sae': 2.667032480239868, 'ce_loss_without_sae': 2.451789617538452}, 'reconstruction_quality': {'explained_variance': 0.03762796148657799, 'mse': 22.495960235595703, 'cossim': 0.8303945660591125}, 'shrinkage': {'l2_norm_in': 46.3914680480957, 'l2_norm_out': 1.4022581577301025, 'l2_ratio': 0.02820885181427002, 'relative_reconstruction_bias': 0.03746975213289261}, 'sparsity': {'l0': 2191.594970703125, 'l1': 1735.416015625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9709031323186069, 'ce_loss_with_ablation': 8.239028930664062, 'ce_loss_with_sae': 2.6019229888916016, 'ce_loss_without_sae': 2.432985305786133}, 'reconstruction_quality': {'explained_variance': 0.03981882333755493, 'mse': 22.586467742919922, 'cossim': 0.8321923613548279}, 'shrinkage': {'l2_norm_in': 46.58034896850586, 'l2_norm_out': 1.410443663597107, 'l2_ratio': 0.028299767524003983, 'relative_reconstruction_bias': 0.0374956913292408}, 'sparsity': {'l0': 2249.919921875, 'l1': 1793.2347412109375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9654034326182972, 'ce_loss_with_ablation': 8.300178527832031, 'ce_loss_with_sae': 2.690309762954712, 'ce_loss_without_sae': 2.489272356033325}, 'reconstruction_quality': {'explained_variance': 0.039716076105833054, 'mse': 22.63967514038086, 'cossim': 0.8386396765708923}, 'shrinkage': {'l2_norm_in': 46.60062789916992, 'l2_norm_out': 1.4212068319320679, 'l2_ratio': 0.0285766813904047, 'relative_reconstruction_bias': 0.037468984723091125}, 'sparsity': {'l0': 2310.145263671875, 'l1': 1832.8494873046875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9807976511387181, 'ce_loss_with_ablation': 7.968987464904785, 'ce_loss_with_sae': 2.373530626296997, 'ce_loss_without_sae': 2.2639811038970947}, 'reconstruction_quality': {'explained_variance': 0.05103094130754471, 'mse': 22.364673614501953, 'cossim': 0.8527023196220398}, 'shrinkage': {'l2_norm_in': 46.65901184082031, 'l2_norm_out': 1.4507862329483032, 'l2_ratio': 0.029213497415184975, 'relative_reconstruction_bias': 0.037552982568740845}, 'sparsity': {'l0': 2377.285400390625, 'l1': 1886.54296875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9805739597425164, 'ce_loss_with_ablation': 8.015522003173828, 'ce_loss_with_sae': 2.3872783184051514, 'ce_loss_without_sae': 2.275777816772461}, 'reconstruction_quality': {'explained_variance': 0.05346729978919029, 'mse': 22.611783981323242, 'cossim': 0.8611078262329102}, 'shrinkage': {'l2_norm_in': 46.57801818847656, 'l2_norm_out': 1.4622949361801147, 'l2_ratio': 0.029551882296800613, 'relative_reconstruction_bias': 0.03753703460097313}, 'sparsity': {'l0': 2415.167236328125, 'l1': 1935.5269775390625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9815160573612466, 'ce_loss_with_ablation': 8.02662181854248, 'ce_loss_with_sae': 2.3700268268585205, 'ce_loss_without_sae': 2.2635016441345215}, 'reconstruction_quality': {'explained_variance': 0.04384377598762512, 'mse': 22.624515533447266, 'cossim': 0.846023678779602}, 'shrinkage': {'l2_norm_in': 46.51802444458008, 'l2_norm_out': 1.4329785108566284, 'l2_ratio': 0.028945961967110634, 'relative_reconstruction_bias': 0.03747647628188133}, 'sparsity': {'l0': 2482.747802734375, 'l1': 1959.1746826171875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9686726514074508, 'ce_loss_with_ablation': 8.207812309265137, 'ce_loss_with_sae': 2.606306552886963, 'ce_loss_without_sae': 2.4251511096954346}, 'reconstruction_quality': {'explained_variance': 0.042239777743816376, 'mse': 22.409202575683594, 'cossim': 0.8424659967422485}, 'shrinkage': {'l2_norm_in': 46.47359848022461, 'l2_norm_out': 1.425499439239502, 'l2_ratio': 0.028785577043890953, 'relative_reconstruction_bias': 0.03748052194714546}, 'sparsity': {'l0': 2529.887939453125, 'l1': 1988.4241943359375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9743600527357362, 'ce_loss_with_ablation': 7.968865394592285, 'ce_loss_with_sae': 2.5722806453704834, 'ce_loss_without_sae': 2.4302713871002197}, 'reconstruction_quality': {'explained_variance': 0.03418169543147087, 'mse': 21.821908950805664, 'cossim': 0.8499663472175598}, 'shrinkage': {'l2_norm_in': 46.03715896606445, 'l2_norm_out': 1.422302484512329, 'l2_ratio': 0.029116017743945122, 'relative_reconstruction_bias': 0.03748362883925438}, 'sparsity': {'l0': 2572.711181640625, 'l1': 2024.7371826171875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9786412328413285, 'ce_loss_with_ablation': 8.31395149230957, 'ce_loss_with_sae': 2.6276285648345947, 'ce_loss_without_sae': 2.5035250186920166}, 'reconstruction_quality': {'explained_variance': 0.03939472511410713, 'mse': 22.356525421142578, 'cossim': 0.855501115322113}, 'shrinkage': {'l2_norm_in': 46.36265182495117, 'l2_norm_out': 1.4439301490783691, 'l2_ratio': 0.029378045350313187, 'relative_reconstruction_bias': 0.03748383745551109}, 'sparsity': {'l0': 2632.197021484375, 'l1': 2067.232421875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9765094171963736, 'ce_loss_with_ablation': 8.183964729309082, 'ce_loss_with_sae': 2.552109479904175, 'ce_loss_without_sae': 2.4166314601898193}, 'reconstruction_quality': {'explained_variance': 0.04034903272986412, 'mse': 22.23641586303711, 'cossim': 0.8546082377433777}, 'shrinkage': {'l2_norm_in': 46.546913146972656, 'l2_norm_out': 1.448812484741211, 'l2_ratio': 0.02937651239335537, 'relative_reconstruction_bias': 0.03749735280871391}, 'sparsity': {'l0': 2671.46484375, 'l1': 2099.437255859375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9761307220254127, 'ce_loss_with_ablation': 8.27078914642334, 'ce_loss_with_sae': 2.6324853897094727, 'ce_loss_without_sae': 2.494612216949463}, 'reconstruction_quality': {'explained_variance': 0.038786839693784714, 'mse': 22.221017837524414, 'cossim': 0.8573622107505798}, 'shrinkage': {'l2_norm_in': 46.33307647705078, 'l2_norm_out': 1.4464586973190308, 'l2_ratio': 0.02950317971408367, 'relative_reconstruction_bias': 0.03747239336371422}, 'sparsity': {'l0': 2720.051513671875, 'l1': 2119.72314453125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9748549355226795, 'ce_loss_with_ablation': 8.307905197143555, 'ce_loss_with_sae': 2.5853374004364014, 'ce_loss_without_sae': 2.4377315044403076}, 'reconstruction_quality': {'explained_variance': 0.03833115100860596, 'mse': 22.129331588745117, 'cossim': 0.8548074960708618}, 'shrinkage': {'l2_norm_in': 46.37716293334961, 'l2_norm_out': 1.441210389137268, 'l2_ratio': 0.0293662641197443, 'relative_reconstruction_bias': 0.037476424127817154}, 'sparsity': {'l0': 2760.127685546875, 'l1': 2139.065185546875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9777248601521931, 'ce_loss_with_ablation': 8.298147201538086, 'ce_loss_with_sae': 2.5927512645721436, 'ce_loss_without_sae': 2.4627673625946045}, 'reconstruction_quality': {'explained_variance': 0.04519878700375557, 'mse': 22.53004264831543, 'cossim': 0.8619070053100586}, 'shrinkage': {'l2_norm_in': 46.59990692138672, 'l2_norm_out': 1.4634836912155151, 'l2_ratio': 0.029705479741096497, 'relative_reconstruction_bias': 0.03749660402536392}, 'sparsity': {'l0': 2789.676513671875, 'l1': 2176.58837890625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9757773691154674, 'ce_loss_with_ablation': 8.28319263458252, 'ce_loss_with_sae': 2.571791887283325, 'ce_loss_without_sae': 2.4300124645233154}, 'reconstruction_quality': {'explained_variance': 0.042098261415958405, 'mse': 22.4842472076416, 'cossim': 0.8643145561218262}, 'shrinkage': {'l2_norm_in': 46.20121765136719, 'l2_norm_out': 1.456168293952942, 'l2_ratio': 0.029835239052772522, 'relative_reconstruction_bias': 0.03746144846081734}, 'sparsity': {'l0': 2840.100830078125, 'l1': 2204.57568359375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9750714465128248, 'ce_loss_with_ablation': 8.250324249267578, 'ce_loss_with_sae': 2.5906853675842285, 'ce_loss_without_sae': 2.4459917545318604}, 'reconstruction_quality': {'explained_variance': 0.03901456668972969, 'mse': 22.05400848388672, 'cossim': 0.860049843788147}, 'shrinkage': {'l2_norm_in': 46.56402587890625, 'l2_norm_out': 1.4585915803909302, 'l2_ratio': 0.029667872935533524, 'relative_reconstruction_bias': 0.03748769313097}, 'sparsity': {'l0': 2886.926513671875, 'l1': 2237.892333984375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9791298118478909, 'ce_loss_with_ablation': 8.394744873046875, 'ce_loss_with_sae': 2.597576141357422, 'ce_loss_without_sae': 2.4740092754364014}, 'reconstruction_quality': {'explained_variance': 0.037289660423994064, 'mse': 22.05377960205078, 'cossim': 0.8644781112670898}, 'shrinkage': {'l2_norm_in': 46.65742111206055, 'l2_norm_out': 1.4691084623336792, 'l2_ratio': 0.02984217181801796, 'relative_reconstruction_bias': 0.037481989711523056}, 'sparsity': {'l0': 2903.4697265625, 'l1': 2256.03515625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9768571807021981, 'ce_loss_with_ablation': 8.180709838867188, 'ce_loss_with_sae': 2.5576534271240234, 'ce_loss_without_sae': 2.4244370460510254}, 'reconstruction_quality': {'explained_variance': 0.004474376793950796, 'mse': 19.397016525268555, 'cossim': 0.8764480948448181}, 'shrinkage': {'l2_norm_in': 43.826629638671875, 'l2_norm_out': 1.390844702720642, 'l2_ratio': 0.030378038063645363, 'relative_reconstruction_bias': 0.037514738738536835}, 'sparsity': {'l0': 2950.427001953125, 'l1': 2216.564697265625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9794151268803142, 'ce_loss_with_ablation': 7.890441417694092, 'ce_loss_with_sae': 2.5031895637512207, 'ce_loss_without_sae': 2.389962911605835}, 'reconstruction_quality': {'explained_variance': 0.0007530197035521269, 'mse': 18.594141006469727, 'cossim': 0.8786152005195618}, 'shrinkage': {'l2_norm_in': 43.51803970336914, 'l2_norm_out': 1.3841273784637451, 'l2_ratio': 0.030483100563287735, 'relative_reconstruction_bias': 0.03751297667622566}, 'sparsity': {'l0': 2955.6171875, 'l1': 2213.757568359375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9758499189300791, 'ce_loss_with_ablation': 7.853931427001953, 'ce_loss_with_sae': 2.4409117698669434, 'ce_loss_without_sae': 2.3069517612457275}, 'reconstruction_quality': {'explained_variance': -0.0016113845631480217, 'mse': 18.040863037109375, 'cossim': 0.8761606216430664}, 'shrinkage': {'l2_norm_in': 43.0209846496582, 'l2_norm_out': 1.3630577325820923, 'l2_ratio': 0.030360335484147072, 'relative_reconstruction_bias': 0.037547361105680466}, 'sparsity': {'l0': 2996.851806640625, 'l1': 2212.135986328125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9798782082493456, 'ce_loss_with_ablation': 7.938239097595215, 'ce_loss_with_sae': 2.3819754123687744, 'ce_loss_without_sae': 2.2678775787353516}, 'reconstruction_quality': {'explained_variance': 0.003308691782876849, 'mse': 18.639301300048828, 'cossim': 0.8795440793037415}, 'shrinkage': {'l2_norm_in': 43.360958099365234, 'l2_norm_out': 1.3794978857040405, 'l2_ratio': 0.030518269166350365, 'relative_reconstruction_bias': 0.03754578158259392}, 'sparsity': {'l0': 3030.62060546875, 'l1': 2242.248046875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9855883108126859, 'ce_loss_with_ablation': 8.071582794189453, 'ce_loss_with_sae': 2.288607597351074, 'ce_loss_without_sae': 2.2040464878082275}, 'reconstruction_quality': {'explained_variance': 0.053091712296009064, 'mse': 22.68302345275879, 'cossim': 0.8843847513198853}, 'shrinkage': {'l2_norm_in': 46.916316986083984, 'l2_norm_out': 1.5190850496292114, 'l2_ratio': 0.03078310191631317, 'relative_reconstruction_bias': 0.03756313398480415}, 'sparsity': {'l0': 3038.737060546875, 'l1': 2382.719482421875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9832768690329949, 'ce_loss_with_ablation': 7.839266300201416, 'ce_loss_with_sae': 2.400338888168335, 'ce_loss_without_sae': 2.3078360557556152}, 'reconstruction_quality': {'explained_variance': -0.0074716657400131226, 'mse': 17.916664123535156, 'cossim': 0.8691580891609192}, 'shrinkage': {'l2_norm_in': 43.13790512084961, 'l2_norm_out': 1.3549789190292358, 'l2_ratio': 0.030081188306212425, 'relative_reconstruction_bias': 0.03754940629005432}, 'sparsity': {'l0': 3082.467041015625, 'l1': 2262.838623046875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9813928851529315, 'ce_loss_with_ablation': 7.9237236976623535, 'ce_loss_with_sae': 2.436962604522705, 'ce_loss_without_sae': 2.3329341411590576}, 'reconstruction_quality': {'explained_variance': 0.00018111290410161018, 'mse': 18.28717041015625, 'cossim': 0.8803787231445312}, 'shrinkage': {'l2_norm_in': 43.10671615600586, 'l2_norm_out': 1.3713093996047974, 'l2_ratio': 0.030555302277207375, 'relative_reconstruction_bias': 0.03752065822482109}, 'sparsity': {'l0': 3097.028076171875, 'l1': 2277.175048828125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9865915819366194, 'ce_loss_with_ablation': 7.754257678985596, 'ce_loss_with_sae': 2.447126865386963, 'ce_loss_without_sae': 2.374999523162842}, 'reconstruction_quality': {'explained_variance': 0.0017382439691573381, 'mse': 18.30831527709961, 'cossim': 0.8853880763053894}, 'shrinkage': {'l2_norm_in': 43.37139892578125, 'l2_norm_out': 1.3907442092895508, 'l2_ratio': 0.03079701028764248, 'relative_reconstruction_bias': 0.03755796328186989}, 'sparsity': {'l0': 3113.38232421875, 'l1': 2310.669189453125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9807248083085177, 'ce_loss_with_ablation': 7.706046104431152, 'ce_loss_with_sae': 2.4372622966766357, 'ce_loss_without_sae': 2.333709478378296}, 'reconstruction_quality': {'explained_variance': 0.025370169430971146, 'mse': 20.52065086364746, 'cossim': 0.8843251466751099}, 'shrinkage': {'l2_norm_in': 44.95268630981445, 'l2_norm_out': 1.4466770887374878, 'l2_ratio': 0.030803054571151733, 'relative_reconstruction_bias': 0.037537116557359695}, 'sparsity': {'l0': 3153.61767578125, 'l1': 2382.065185546875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9787820504981775, 'ce_loss_with_ablation': 8.2566499710083, 'ce_loss_with_sae': 2.2072181701660156, 'ce_loss_without_sae': 2.0760791301727295}, 'reconstruction_quality': {'explained_variance': 0.05431065708398819, 'mse': 22.852163314819336, 'cossim': 0.8880823254585266}, 'shrinkage': {'l2_norm_in': 46.85638427734375, 'l2_norm_out': 1.5232677459716797, 'l2_ratio': 0.030947137624025345, 'relative_reconstruction_bias': 0.03751254081726074}, 'sparsity': {'l0': 3173.3212890625, 'l1': 2470.204833984375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9799831733494843, 'ce_loss_with_ablation': 8.236321449279785, 'ce_loss_with_sae': 2.2522330284118652, 'ce_loss_without_sae': 2.1300039291381836}, 'reconstruction_quality': {'explained_variance': 0.04771453142166138, 'mse': 22.23713493347168, 'cossim': 0.889692485332489}, 'shrinkage': {'l2_norm_in': 46.56438064575195, 'l2_norm_out': 1.5140594244003296, 'l2_ratio': 0.031014183536171913, 'relative_reconstruction_bias': 0.03756125643849373}, 'sparsity': {'l0': 3181.570068359375, 'l1': 2466.59228515625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9810166062425019, 'ce_loss_with_ablation': 8.337739944458008, 'ce_loss_with_sae': 2.216578960418701, 'ce_loss_without_sae': 2.098129987716675}, 'reconstruction_quality': {'explained_variance': 0.05570920184254646, 'mse': 22.8675537109375, 'cossim': 0.8938280344009399}, 'shrinkage': {'l2_norm_in': 47.10000228881836, 'l2_norm_out': 1.5439198017120361, 'l2_ratio': 0.031246310099959373, 'relative_reconstruction_bias': 0.037545133382081985}, 'sparsity': {'l0': 3202.514404296875, 'l1': 2499.738037109375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}
