/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:304: UserWarning: Dataset is not tokenized. Pre-tokenizing will improve performance and allows for more control over special tokens. See https://jbloomaus.github.io/SAELens/training_saes/#pretokenizing-datasets for more info.
  warnings.warn(
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: alexgulko (gulko-osu) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.8
wandb: Run data is saved locally in /data/yusenp/NLP/KAN-LLaMA/wandb/run-20250327_032907-lkwkzg4a
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run 16384-L1-5-LR-1e-05-Tokens-4.096e+06
wandb: ‚≠êÔ∏è View project at https://wandb.ai/gulko-osu/sae_llama_3_2_1B
wandb: üöÄ View run at https://wandb.ai/gulko-osu/sae_llama_3_2_1B/runs/lkwkzg4a
Using device: cuda
training with gated architecture with 1000 steps
Loaded pretrained model meta-llama/Llama-3.2-1B into HookedTransformer
Creating new SAE
Training SAE:   0%|          | 0/4096000 [00:00<?, ?it/s]
Estimating norm scaling factor:   0%|          | 0/1000 [00:00<?, ?it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.02it/s][A[A

Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 16.63it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:   0%|          | 1/1000 [00:00<06:04,  2.74it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:   1%|          | 9/1000 [00:00<00:48, 20.60it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:   2%|‚ñè         | 17/1000 [00:00<00:32, 30.22it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:   2%|‚ñé         | 25/1000 [00:00<00:27, 36.05it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 36.16it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:   3%|‚ñé         | 33/1000 [00:01<00:32, 30.06it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:   4%|‚ñç         | 41/1000 [00:01<00:27, 34.61it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:   5%|‚ñç         | 49/1000 [00:01<00:24, 38.17it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:   6%|‚ñå         | 57/1000 [00:01<00:22, 41.12it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.99it/s][A[A

Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.19it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.88it/s][A[A

                                                               [A[A
Estimating norm scaling factor:   6%|‚ñã         | 65/1000 [00:02<00:40, 22.90it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.26it/s][A[A

                                                               [A[A
Estimating norm scaling factor:   7%|‚ñã         | 69/1000 [00:02<00:41, 22.66it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.86it/s][A[A

                                                               [A[A
Estimating norm scaling factor:   7%|‚ñã         | 73/1000 [00:02<00:41, 22.18it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.77it/s][A[A

                                                               [A[A
Estimating norm scaling factor:   8%|‚ñä         | 77/1000 [00:02<00:43, 21.36it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.44it/s][A[A

                                                               [A[A
Estimating norm scaling factor:   8%|‚ñä         | 81/1000 [00:03<00:43, 21.34it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.65it/s][A[A

                                                               [A[A
Estimating norm scaling factor:   8%|‚ñä         | 85/1000 [00:03<00:42, 21.73it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.30it/s][A[A

                                                               [A[A
Estimating norm scaling factor:   9%|‚ñâ         | 89/1000 [00:03<00:42, 21.56it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 25.74it/s][A[A

                                                               [A[A
Estimating norm scaling factor:   9%|‚ñâ         | 93/1000 [00:03<00:40, 22.21it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.86it/s][A[A

                                                               [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  8.84it/s][A[A

Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 17.42it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.11it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  10%|‚ñâ         | 97/1000 [00:04<01:07, 13.40it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.46it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  10%|‚ñà         | 101/1000 [00:04<01:01, 14.57it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.73it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  10%|‚ñà         | 105/1000 [00:04<00:56, 15.77it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.60it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  11%|‚ñà         | 109/1000 [00:04<00:53, 16.61it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.65it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  11%|‚ñà‚ñè        | 113/1000 [00:05<00:51, 17.32it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 20.62it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  12%|‚ñà‚ñè        | 117/1000 [00:05<00:48, 18.31it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.11it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  12%|‚ñà‚ñè        | 121/1000 [00:05<00:45, 19.22it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.93it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  12%|‚ñà‚ñé        | 125/1000 [00:05<00:44, 19.55it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 25.40it/s][A[A

                                                               [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 14.89it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 20.31it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  13%|‚ñà‚ñé        | 129/1000 [00:06<01:08, 12.74it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 19.64it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  13%|‚ñà‚ñé        | 133/1000 [00:06<01:00, 14.30it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.57it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  14%|‚ñà‚ñé        | 137/1000 [00:06<00:54, 15.83it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.52it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  14%|‚ñà‚ñç        | 141/1000 [00:06<00:52, 16.47it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 20.53it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  14%|‚ñà‚ñç        | 145/1000 [00:07<00:48, 17.46it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.07it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  15%|‚ñà‚ñç        | 149/1000 [00:07<00:45, 18.64it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.60it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  15%|‚ñà‚ñå        | 153/1000 [00:07<00:44, 19.23it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 19.59it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  16%|‚ñà‚ñå        | 157/1000 [00:07<00:43, 19.32it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 25.67it/s][A[A

                                                               [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  9.51it/s][A[A

Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 19.04it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.80it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  16%|‚ñà‚ñå        | 161/1000 [00:08<01:04, 12.98it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.50it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  16%|‚ñà‚ñã        | 165/1000 [00:08<00:56, 14.68it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.50it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  17%|‚ñà‚ñã        | 169/1000 [00:08<00:51, 16.09it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.78it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  17%|‚ñà‚ñã        | 173/1000 [00:08<00:48, 16.89it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.11it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  18%|‚ñà‚ñä        | 177/1000 [00:08<00:45, 18.15it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.47it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  18%|‚ñà‚ñä        | 181/1000 [00:09<00:42, 19.13it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.14it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  18%|‚ñà‚ñä        | 185/1000 [00:09<00:41, 19.41it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.63it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  19%|‚ñà‚ñâ        | 189/1000 [00:09<00:39, 20.34it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.19it/s][A[A

                                                               [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 14.87it/s][A[A

Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 17.50it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 24.08it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  19%|‚ñà‚ñâ        | 193/1000 [00:10<01:01, 13.02it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.40it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  20%|‚ñà‚ñâ        | 197/1000 [00:10<00:56, 14.33it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.05it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  20%|‚ñà‚ñà        | 201/1000 [00:10<00:51, 15.47it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.83it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  20%|‚ñà‚ñà        | 205/1000 [00:10<00:48, 16.31it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.70it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  21%|‚ñà‚ñà        | 209/1000 [00:10<00:43, 18.34it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  22%|‚ñà‚ñà‚ñè       | 217/1000 [00:11<00:30, 25.84it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:01,  2.43it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  22%|‚ñà‚ñà‚ñé       | 225/1000 [00:11<00:44, 17.33it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  23%|‚ñà‚ñà‚ñé       | 233/1000 [00:11<00:34, 22.56it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  24%|‚ñà‚ñà‚ñç       | 241/1000 [00:12<00:27, 27.44it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  25%|‚ñà‚ñà‚ñç       | 249/1000 [00:12<00:23, 32.10it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 35.57it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  26%|‚ñà‚ñà‚ñå       | 257/1000 [00:12<00:25, 28.78it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  26%|‚ñà‚ñà‚ñã       | 265/1000 [00:12<00:22, 33.03it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  27%|‚ñà‚ñà‚ñã       | 273/1000 [00:12<00:19, 36.72it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  28%|‚ñà‚ñà‚ñä       | 281/1000 [00:13<00:18, 39.92it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 38.37it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  29%|‚ñà‚ñà‚ñâ       | 289/1000 [00:13<00:21, 33.59it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  30%|‚ñà‚ñà‚ñâ       | 297/1000 [00:13<00:18, 37.11it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  30%|‚ñà‚ñà‚ñà       | 302/1000 [00:13<00:18, 38.37it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  31%|‚ñà‚ñà‚ñà       | 309/1000 [00:13<00:17, 39.06it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  31%|‚ñà‚ñà‚ñà‚ñè      | 314/1000 [00:13<00:17, 39.78it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 36.24it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  32%|‚ñà‚ñà‚ñà‚ñè      | 321/1000 [00:14<00:21, 31.16it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  33%|‚ñà‚ñà‚ñà‚ñé      | 329/1000 [00:14<00:18, 35.57it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  34%|‚ñà‚ñà‚ñà‚ñé      | 337/1000 [00:14<00:16, 39.06it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 37.40it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  34%|‚ñà‚ñà‚ñà‚ñç      | 345/1000 [00:14<00:16, 39.79it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:01,  1.98it/s][A[A

Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00,  7.54it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.83it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  35%|‚ñà‚ñà‚ñà‚ñå      | 353/1000 [00:15<00:36, 17.66it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.67it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  36%|‚ñà‚ñà‚ñà‚ñå      | 357/1000 [00:16<00:36, 17.76it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.88it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  36%|‚ñà‚ñà‚ñà‚ñå      | 361/1000 [00:16<00:35, 18.15it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.59it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  36%|‚ñà‚ñà‚ñà‚ñã      | 365/1000 [00:16<00:34, 18.35it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.58it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  37%|‚ñà‚ñà‚ñà‚ñã      | 369/1000 [00:16<00:33, 18.77it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.46it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  37%|‚ñà‚ñà‚ñà‚ñã      | 373/1000 [00:16<00:32, 19.50it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 24.53it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  38%|‚ñà‚ñà‚ñà‚ñä      | 377/1000 [00:16<00:30, 20.33it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.09it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  38%|‚ñà‚ñà‚ñà‚ñä      | 381/1000 [00:17<00:30, 20.31it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 25.69it/s][A[A

                                                               [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 18.84it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 19.97it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  38%|‚ñà‚ñà‚ñà‚ñä      | 385/1000 [00:17<00:44, 13.93it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.77it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  39%|‚ñà‚ñà‚ñà‚ñâ      | 389/1000 [00:17<00:39, 15.47it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 20.76it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  39%|‚ñà‚ñà‚ñà‚ñâ      | 393/1000 [00:18<00:36, 16.50it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 18.93it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  40%|‚ñà‚ñà‚ñà‚ñâ      | 397/1000 [00:18<00:35, 17.03it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.06it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  40%|‚ñà‚ñà‚ñà‚ñà      | 401/1000 [00:18<00:32, 18.24it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.73it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  40%|‚ñà‚ñà‚ñà‚ñà      | 405/1000 [00:18<00:30, 19.38it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.70it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  41%|‚ñà‚ñà‚ñà‚ñà      | 409/1000 [00:18<00:29, 20.08it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.05it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  41%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 413/1000 [00:19<00:28, 20.67it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 25.78it/s][A[A

                                                               [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.30it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.85it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 417/1000 [00:19<00:44, 13.18it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.71it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 421/1000 [00:19<00:40, 14.37it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.76it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  42%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 425/1000 [00:20<00:36, 15.62it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.62it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 429/1000 [00:20<00:34, 16.52it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.45it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 433/1000 [00:20<00:32, 17.66it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.05it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  44%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 437/1000 [00:20<00:30, 18.74it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.14it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 441/1000 [00:20<00:28, 19.61it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.27it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 445/1000 [00:20<00:27, 19.83it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 25.67it/s][A[A

                                                               [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.47it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 20.73it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 449/1000 [00:21<00:41, 13.38it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.67it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 453/1000 [00:21<00:36, 15.01it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.90it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 457/1000 [00:21<00:33, 16.30it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 20.37it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 461/1000 [00:22<00:31, 17.30it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.06it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  46%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 465/1000 [00:22<00:28, 18.50it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.49it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 469/1000 [00:22<00:27, 19.38it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.66it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 473/1000 [00:22<00:26, 20.07it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.06it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 477/1000 [00:22<00:25, 20.68it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.79it/s][A[A

                                                               [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.61it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.10it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 481/1000 [00:23<00:39, 13.14it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.55it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 485/1000 [00:23<00:35, 14.56it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.73it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 489/1000 [00:23<00:32, 15.57it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 20.49it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 493/1000 [00:24<00:30, 16.58it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.75it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 497/1000 [00:24<00:28, 17.77it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.04it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 501/1000 [00:24<00:26, 18.71it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 36.03it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 505/1000 [00:24<00:22, 21.57it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 33.58it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 513/1000 [00:24<00:21, 22.47it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 521/1000 [00:25<00:16, 28.50it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 529/1000 [00:25<00:14, 33.48it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 537/1000 [00:25<00:12, 37.32it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 36.27it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 545/1000 [00:25<00:14, 31.58it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 38.87it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 553/1000 [00:25<00:13, 34.12it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 557/1000 [00:25<00:12, 34.71it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 561/1000 [00:26<00:12, 35.47it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 565/1000 [00:26<00:12, 36.24it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 569/1000 [00:26<00:11, 36.92it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 573/1000 [00:26<00:11, 37.41it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 28.68it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 577/1000 [00:26<00:17, 24.82it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 581/1000 [00:26<00:15, 27.57it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 585/1000 [00:26<00:13, 30.02it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 589/1000 [00:27<00:12, 31.97it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 593/1000 [00:27<00:12, 33.68it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 597/1000 [00:27<00:11, 35.13it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 601/1000 [00:27<00:11, 36.19it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 605/1000 [00:27<00:10, 36.98it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  9.21it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 609/1000 [00:27<00:17, 21.87it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 39.10it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 613/1000 [00:27<00:15, 24.73it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 617/1000 [00:27<00:13, 27.70it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 621/1000 [00:28<00:12, 30.12it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 625/1000 [00:28<00:11, 32.35it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 633/1000 [00:28<00:09, 37.65it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 36.70it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 641/1000 [00:28<00:11, 30.99it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 649/1000 [00:28<00:09, 35.77it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 29.66it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 653/1000 [00:29<00:10, 33.38it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.22it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 657/1000 [00:29<00:11, 29.44it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.08it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 661/1000 [00:29<00:12, 27.59it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.40it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 665/1000 [00:29<00:13, 24.69it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.93it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 669/1000 [00:29<00:14, 23.27it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.36it/s][A[A

                                                               [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  9.31it/s][A[A

Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 18.16it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.65it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 673/1000 [00:30<00:23, 14.14it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.14it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 677/1000 [00:30<00:20, 15.70it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 18.78it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 681/1000 [00:30<00:19, 16.57it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.77it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 685/1000 [00:30<00:18, 17.31it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.98it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 689/1000 [00:31<00:17, 18.21it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.65it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 693/1000 [00:31<00:15, 19.20it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.14it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 697/1000 [00:31<00:15, 19.39it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.71it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 701/1000 [00:31<00:14, 20.01it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.81it/s][A[A

                                                               [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.73it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.30it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 705/1000 [00:32<00:22, 13.14it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.13it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 709/1000 [00:32<00:19, 14.76it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.07it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 713/1000 [00:32<00:17, 16.19it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 20.73it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 717/1000 [00:32<00:16, 17.09it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.67it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 721/1000 [00:33<00:15, 18.15it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.09it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 725/1000 [00:33<00:14, 19.18it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.68it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 729/1000 [00:33<00:13, 19.65it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 19.36it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 733/1000 [00:33<00:13, 19.80it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 25.68it/s][A[A

                                                               [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  9.15it/s][A[A

Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 18.95it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.86it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 737/1000 [00:34<00:20, 13.11it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.62it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 741/1000 [00:34<00:17, 14.80it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.11it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 745/1000 [00:34<00:15, 16.19it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.78it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 749/1000 [00:34<00:14, 17.13it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.05it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 753/1000 [00:34<00:13, 18.39it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.77it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 757/1000 [00:35<00:12, 19.18it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.34it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 761/1000 [00:35<00:12, 19.67it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 24.99it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 765/1000 [00:35<00:11, 20.62it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.10it/s][A[A

                                                               [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  9.99it/s][A[A

Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 17.50it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.88it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 769/1000 [00:36<00:18, 12.75it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.47it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 773/1000 [00:36<00:16, 13.99it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.75it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 777/1000 [00:36<00:14, 15.32it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.62it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 781/1000 [00:36<00:13, 16.28it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 18.86it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 785/1000 [00:36<00:12, 17.24it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 20.95it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 789/1000 [00:37<00:11, 18.16it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 24.30it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 793/1000 [00:37<00:10, 19.14it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.32it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 797/1000 [00:37<00:10, 19.81it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 25.57it/s][A[A

                                                               [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 18.49it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 20.07it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 801/1000 [00:37<00:14, 13.55it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 38.25it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 805/1000 [00:38<00:11, 16.64it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 813/1000 [00:38<00:07, 23.92it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 821/1000 [00:38<00:05, 30.00it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 829/1000 [00:38<00:04, 34.90it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 36.69it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 833/1000 [00:38<00:05, 27.88it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 841/1000 [00:38<00:04, 33.09it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 849/1000 [00:39<00:04, 36.91it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 857/1000 [00:39<00:03, 40.04it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 36.64it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 865/1000 [00:39<00:04, 33.14it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 873/1000 [00:39<00:03, 36.93it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 881/1000 [00:39<00:02, 39.98it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 889/1000 [00:40<00:02, 42.58it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 37.13it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 897/1000 [00:40<00:02, 34.81it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 905/1000 [00:40<00:02, 38.14it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 913/1000 [00:40<00:02, 40.90it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 921/1000 [00:40<00:01, 43.28it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 34.37it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 929/1000 [00:41<00:02, 34.47it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 937/1000 [00:41<00:01, 37.86it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 945/1000 [00:41<00:01, 40.67it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 953/1000 [00:41<00:01, 43.12it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.86it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 961/1000 [00:42<00:01, 31.94it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 969/1000 [00:42<00:00, 35.67it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 977/1000 [00:42<00:00, 38.80it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

                                                       [A[A
Estimating norm scaling factor:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 982/1000 [00:42<00:00, 40.53it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.95it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 987/1000 [00:42<00:00, 36.15it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.78it/s][A[A

                                                               [A[A
Estimating norm scaling factor:  99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 991/1000 [00:42<00:00, 31.70it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 25.67it/s][A[A

                                                               [A[A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(


Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.04it/s][A[A

                                                               [A[A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 20.20it/s][A[A

                                                               [A[A
Estimating norm scaling factor: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 995/1000 [00:43<00:00, 18.06it/s][A

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.58it/s][A[A

                                                               [A[A
Estimating norm scaling factor: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 998/1000 [00:43<00:00, 17.50it/s][AEstimating norm scaling factor: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1000/1000 [00:43<00:00, 22.87it/s]

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 24.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  4.56it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 10.55it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.66it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.98it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.86it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.26it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.86it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.05it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.44it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.12it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 14.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.60it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.25it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.58it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.38it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.82it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  8.57it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 16.97it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.00it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 19.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.52it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.95it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.48it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.86it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.20it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.90it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.96it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.19it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 35.98it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.53it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A100| auxiliary_reconstruction_loss: 21693.54688 | l1_loss: 20.65429 | mse_loss: 51.60097:   0%|          | 0/4096000 [00:54<?, ?it/s]100| auxiliary_reconstruction_loss: 21693.54688 | l1_loss: 20.65429 | mse_loss: 51.60097:   1%|‚ñè         | 51200/4096000 [00:54<1:12:11, 933.91it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 29.92it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.86it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.94it/s][A
                                                               [Asae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.35816677771008476, 'ce_loss_with_ablation': 8.493475914001465, 'ce_loss_with_sae': 6.621574878692627, 'ce_loss_without_sae': 3.267136812210083}, 'reconstruction_quality': {'explained_variance': 0.08325071632862091, 'mse': 25.6020565032959, 'cossim': 0.22685544192790985}, 'shrinkage': {'l2_norm_in': 46.52678298950195, 'l2_norm_out': 0.10632746666669846, 'l2_ratio': 0.00033458034158684313, 'relative_reconstruction_bias': 0.012150577269494534}, 'sparsity': {'l0': 142.7685546875, 'l1': 112.4975814819336}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.27it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 14.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.43it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.86it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.26it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.46it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.61it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.86it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 14.67it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.17it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.63it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.31it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.65it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.26it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.98it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.13it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.07it/s][A
                                                               [A200| auxiliary_reconstruction_loss: 5105.37061 | l1_loss: 30.43403 | mse_loss: 37.12044:   1%|‚ñè         | 51200/4096000 [01:07<1:12:11, 933.91it/s] 200| auxiliary_reconstruction_loss: 5105.37061 | l1_loss: 30.43403 | mse_loss: 37.12044:   2%|‚ñé         | 102400/4096000 [01:07<39:21, 1691.29it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 24.23it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.84it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 14.89it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.28it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.87it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.11it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 12.44it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.33it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.05it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.82it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.47it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.29it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.27it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 38.28it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 25.25it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 24.23it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.60it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.67it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.21it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.09it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.55it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.89it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.03it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.43it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.53it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.46it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 14.84it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.84it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.15it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.29it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.82it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.49it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.29it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.91it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.91it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.81it/s][A
                                                               [A200| auxiliary_reconstruction_loss: 5105.37061 | l1_loss: 30.43403 | mse_loss: 37.12044:   2%|‚ñé         | 102400/4096000 [01:19<39:21, 1691.29it/s]300| auxiliary_reconstruction_loss: 2955.80054 | l1_loss: 104.14738 | mse_loss: 33.54778:   2%|‚ñé         | 102400/4096000 [01:25<39:21, 1691.29it/s]300| auxiliary_reconstruction_loss: 2955.80054 | l1_loss: 104.14738 | mse_loss: 33.54778:   4%|‚ñç         | 153600/4096000 [01:25<31:13, 2104.46it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.4636639401154745, 'ce_loss_with_ablation': 8.493475914001465, 'ce_loss_with_sae': 6.070210933685303, 'ce_loss_without_sae': 3.267136812210083}, 'reconstruction_quality': {'explained_variance': 0.08404211699962616, 'mse': 24.69274139404297, 'cossim': 0.2881642282009125}, 'shrinkage': {'l2_norm_in': 46.52678298950195, 'l2_norm_out': 0.3967474102973938, 'l2_ratio': 0.0006887157796882093, 'relative_reconstruction_bias': 0.02940150909125805}, 'sparsity': {'l0': 114.54219055175781, 'l1': 476.42486572265625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.12it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  5.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.60it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.82it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 35.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 25.02it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.55it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.54it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.50it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.29it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.52it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 25.18it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.54it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.50it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.43it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.57it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.60it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 20.58it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.27it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.46it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.32it/s][A
                                                               [A400| auxiliary_reconstruction_loss: 3073.50879 | l1_loss: 199.24759 | mse_loss: 28.96860:   4%|‚ñç         | 153600/4096000 [01:32<31:13, 2104.46it/s]400| auxiliary_reconstruction_loss: 3073.50879 | l1_loss: 199.24759 | mse_loss: 28.96860:   5%|‚ñå         | 204800/4096000 [01:32<22:11, 2922.34it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.06it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.96it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.84it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.93it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 20.27it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 24.01it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.64it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.43it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.64it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.57it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.19it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.62it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.08it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.54it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.94it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.04it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.87it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.99it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.51it/s][A
                                                               [Asae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.4334863953945726, 'ce_loss_with_ablation': 8.657638549804688, 'ce_loss_with_sae': 6.460413932800293, 'ce_loss_without_sae': 3.5889105796813965}, 'reconstruction_quality': {'explained_variance': 0.06385985761880875, 'mse': 22.235294342041016, 'cossim': 0.31529608368873596}, 'shrinkage': {'l2_norm_in': 44.62173843383789, 'l2_norm_out': 0.5144885182380676, 'l2_ratio': 0.0008782055228948593, 'relative_reconstruction_bias': 0.03754506632685661}, 'sparsity': {'l0': 88.51094055175781, 'l1': 619.905029296875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.18it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  5.11it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 13.92it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.82it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 14.66it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.17it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.44it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.83it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.47it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 20.55it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.82it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.58it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.03it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.44it/s][A400| auxiliary_reconstruction_loss: 3073.50879 | l1_loss: 199.24759 | mse_loss: 28.96860:   5%|‚ñå         | 204800/4096000 [01:49<22:11, 2922.34it/s]
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.43it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.65it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.58it/s][A
                                                               [A500| auxiliary_reconstruction_loss: 1469.37500 | l1_loss: 103.74805 | mse_loss: 32.01264:   5%|‚ñå         | 204800/4096000 [01:50<22:11, 2922.34it/s]500| auxiliary_reconstruction_loss: 1469.37500 | l1_loss: 103.74805 | mse_loss: 32.01264:   6%|‚ñã         | 256000/4096000 [01:50<22:02, 2903.78it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.34it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.62it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.24it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.48it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.41it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 16.15it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.49it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.39it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.89it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:04,  1.36s/it][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:01<00:00,  3.39it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.51it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.60it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.66it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.22it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  4.01it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.03it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.09it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  5.28it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.58it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.88it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.46it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.66it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.32it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.62it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.51it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.29it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 16.09it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.29it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.00it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.89it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.43it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.45it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.86it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.70it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.71it/s][A
                                                               [A600| auxiliary_reconstruction_loss: 1094.11475 | l1_loss: 146.71629 | mse_loss: 26.27768:   6%|‚ñã         | 256000/4096000 [02:07<22:02, 2903.78it/s]600| auxiliary_reconstruction_loss: 1094.11475 | l1_loss: 146.71629 | mse_loss: 26.27768:   8%|‚ñä         | 307200/4096000 [02:07<21:50, 2892.13it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.5725327048152421, 'ce_loss_with_ablation': 8.144485473632812, 'ce_loss_with_sae': 5.371108055114746, 'ce_loss_without_sae': 3.3004348278045654}, 'reconstruction_quality': {'explained_variance': 0.058402158319950104, 'mse': 21.183027267456055, 'cossim': 0.31563836336135864}, 'shrinkage': {'l2_norm_in': 44.21681594848633, 'l2_norm_out': 0.6333475708961487, 'l2_ratio': 0.003385536838322878, 'relative_reconstruction_bias': 0.041170667856931686}, 'sparsity': {'l0': 103.14570617675781, 'l1': 716.5712280273438}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 27.41it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.06it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.62it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.36it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.99it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.96it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.29it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.12it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.90it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.62it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 14.65it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.95it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.82it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.64it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.58it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.65it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.45it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.09it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.21it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.84it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 27.41it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.33it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.66it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.64it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.49it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.26it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.07it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.38it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.96it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.46it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.42it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.55it/s][A600| auxiliary_reconstruction_loss: 1094.11475 | l1_loss: 146.71629 | mse_loss: 26.27768:   8%|‚ñä         | 307200/4096000 [02:19<21:50, 2892.13it/s]
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.23it/s][A
                                                               [A700| auxiliary_reconstruction_loss: 927.08862 | l1_loss: 135.37636 | mse_loss: 25.15770:   8%|‚ñä         | 307200/4096000 [02:19<21:50, 2892.13it/s] 700| auxiliary_reconstruction_loss: 927.08862 | l1_loss: 135.37636 | mse_loss: 25.15770:   9%|‚ñâ         | 358400/4096000 [02:19<19:08, 3253.58it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.37it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.62it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.25it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.41it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.86it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.24it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.22it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.04it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.60it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.90it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.90it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.57it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 16.44it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.24it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.44it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.65it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.02it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.59it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.09it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.70it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.24it/s][A
                                                               [A700| auxiliary_reconstruction_loss: 927.08862 | l1_loss: 135.37636 | mse_loss: 25.15770:   9%|‚ñâ         | 358400/4096000 [02:30<19:08, 3253.58it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.45095883799514297, 'ce_loss_with_ablation': 8.455536842346191, 'ce_loss_with_sae': 6.197534561157227, 'ce_loss_without_sae': 3.448422908782959}, 'reconstruction_quality': {'explained_variance': 0.08853896707296371, 'mse': 23.201765060424805, 'cossim': 0.4143697917461395}, 'shrinkage': {'l2_norm_in': 45.55447006225586, 'l2_norm_out': 0.9595123529434204, 'l2_ratio': 0.011922954581677914, 'relative_reconstruction_bias': 0.04145868495106697}, 'sparsity': {'l0': 161.9619140625, 'l1': 857.1558837890625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.31it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.83it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.04it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.83it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.63it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.33it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.89it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.15it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.65it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.22it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.36it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.62it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.51it/s][A
                                                               [A800| auxiliary_reconstruction_loss: 904.74994 | l1_loss: 187.70561 | mse_loss: 21.35106:   9%|‚ñâ         | 358400/4096000 [02:36<19:08, 3253.58it/s]800| auxiliary_reconstruction_loss: 904.74994 | l1_loss: 187.70561 | mse_loss: 21.35106:  10%|‚ñà         | 409600/4096000 [02:36<19:26, 3159.30it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.15it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.70it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.52it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.70it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.92it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.88it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.57it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.47it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.65it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.00it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.26it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.90it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 24.52it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.84it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.26it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.90it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.12it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.84it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.62it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.37it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.10it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.27it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.58it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.86it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.33it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.55it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.36it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.43it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.45it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.54it/s][A
                                                               [A800| auxiliary_reconstruction_loss: 904.74994 | l1_loss: 187.70561 | mse_loss: 21.35106:  10%|‚ñà         | 409600/4096000 [02:49<19:26, 3159.30it/s]900| auxiliary_reconstruction_loss: 809.75134 | l1_loss: 147.08391 | mse_loss: 23.32084:  10%|‚ñà         | 409600/4096000 [02:49<19:26, 3159.30it/s]900| auxiliary_reconstruction_loss: 809.75134 | l1_loss: 147.08391 | mse_loss: 23.32084:  11%|‚ñà‚ñè        | 460800/4096000 [02:49<17:51, 3391.51it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.4985371898331527, 'ce_loss_with_ablation': 8.455536842346191, 'ce_loss_with_sae': 5.959304332733154, 'ce_loss_without_sae': 3.448422908782959}, 'reconstruction_quality': {'explained_variance': 0.09328364580869675, 'mse': 23.193288803100586, 'cossim': 0.5039986968040466}, 'shrinkage': {'l2_norm_in': 45.55447006225586, 'l2_norm_out': 1.0441423654556274, 'l2_ratio': 0.014698132872581482, 'relative_reconstruction_bias': 0.04133929684758186}, 'sparsity': {'l0': 208.2423858642578, 'l1': 894.1875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.55it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.44it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.40it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.54it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.50it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.47it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.57it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 28.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.09it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.58it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.43it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.51it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.38it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.48it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 28.11it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 27.26it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 37.36it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A1000| auxiliary_reconstruction_loss: 832.05139 | l1_loss: 144.70879 | mse_loss: 23.59089:  11%|‚ñà‚ñè        | 460800/4096000 [02:55<17:51, 3391.51it/s]1000| auxiliary_reconstruction_loss: 832.05139 | l1_loss: 144.70879 | mse_loss: 23.59089:  12%|‚ñà‚ñé        | 512000/4096000 [02:55<14:18, 4175.49it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.84it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.87it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 33.86it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.82it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.85it/s][A
                                                               [Asae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.6284417851469543, 'ce_loss_with_ablation': 8.56460952758789, 'ce_loss_with_sae': 5.386826992034912, 'ce_loss_without_sae': 3.5080034732818604}, 'reconstruction_quality': {'explained_variance': 0.10536707937717438, 'mse': 24.055570602416992, 'cossim': 0.5738636255264282}, 'shrinkage': {'l2_norm_in': 46.43986129760742, 'l2_norm_out': 1.1383217573165894, 'l2_ratio': 0.016924476251006126, 'relative_reconstruction_bias': 0.04125158116221428}, 'sparsity': {'l0': 243.5222625732422, 'l1': 940.3207397460938}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.83it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 38.45it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.43it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A1100| auxiliary_reconstruction_loss: 735.09521 | l1_loss: 175.70456 | mse_loss: 20.10613:  12%|‚ñà‚ñé        | 512000/4096000 [03:03<14:18, 4175.49it/s]1100| auxiliary_reconstruction_loss: 735.09521 | l1_loss: 175.70456 | mse_loss: 20.10613:  14%|‚ñà‚ñç        | 563200/4096000 [03:03<12:45, 4614.25it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.44it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.83it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  8.21it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.14it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.82it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.86it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 36.32it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.52it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.46it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.65it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.64it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.55it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.47it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 27.64it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 35.39it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.56it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.09it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.65it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.04it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.65it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.24it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 18.51it/s][A
                                                               [A1200| auxiliary_reconstruction_loss: 662.87488 | l1_loss: 165.34290 | mse_loss: 19.23415:  14%|‚ñà‚ñç        | 563200/4096000 [03:15<12:45, 4614.25it/s]1200| auxiliary_reconstruction_loss: 662.87488 | l1_loss: 165.34290 | mse_loss: 19.23415:  15%|‚ñà‚ñå        | 614400/4096000 [03:15<12:43, 4561.68it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.7092388338259007, 'ce_loss_with_ablation': 8.56460952758789, 'ce_loss_with_sae': 4.978268146514893, 'ce_loss_without_sae': 3.5080034732818604}, 'reconstruction_quality': {'explained_variance': 0.10932788997888565, 'mse': 24.044513702392578, 'cossim': 0.6286466717720032}, 'shrinkage': {'l2_norm_in': 46.43986129760742, 'l2_norm_out': 1.19720458984375, 'l2_ratio': 0.018842017278075218, 'relative_reconstruction_bias': 0.04127351567149162}, 'sparsity': {'l0': 265.8505859375, 'l1': 949.4610595703125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.40it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.59it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.28it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.48it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.28it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 13.01it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.63it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.51it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.36it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 18.11it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 20.87it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.17it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.47it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 16.06it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.66it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.42it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.82it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.55it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.90it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 14.50it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.22it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.66it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.04it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.65it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  5.20it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  5.19it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.23it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.12it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.04it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.82it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 18.05it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 18.86it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.44it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.38it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.66it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.65it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.98it/s][A
                                                               [A1300| auxiliary_reconstruction_loss: 667.45508 | l1_loss: 186.21414 | mse_loss: 18.12660:  15%|‚ñà‚ñå        | 614400/4096000 [03:26<12:43, 4561.68it/s]1300| auxiliary_reconstruction_loss: 667.45508 | l1_loss: 186.21414 | mse_loss: 18.12660:  16%|‚ñà‚ñã        | 665600/4096000 [03:26<12:32, 4557.83it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 24.01it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.87it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.92it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.06it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.93it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 27.10it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 14.21it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.97it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.91it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.33it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.56it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.32it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.60it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.66it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.62it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.07it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.59it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.48it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.01it/s][A
                                                               [Asae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.8332791763824906, 'ce_loss_with_ablation': 8.493475914001465, 'ce_loss_with_sae': 4.138476371765137, 'ce_loss_without_sae': 3.267136812210083}, 'reconstruction_quality': {'explained_variance': 0.10977935791015625, 'mse': 23.790006637573242, 'cossim': 0.6666620373725891}, 'shrinkage': {'l2_norm_in': 46.52678298950195, 'l2_norm_out': 1.246305227279663, 'l2_ratio': 0.0204748697578907, 'relative_reconstruction_bias': 0.041295375674963}, 'sparsity': {'l0': 291.2548828125, 'l1': 950.4177856445312}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 18.65it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.48it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.57it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.46it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.43it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  5.67it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A1300| auxiliary_reconstruction_loss: 667.45508 | l1_loss: 186.21414 | mse_loss: 18.12660:  16%|‚ñà‚ñã        | 665600/4096000 [03:39<12:32, 4557.83it/s]
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.49it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 17.47it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.01it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.19it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.98it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.86it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.52it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.23it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.27it/s][A
                                                               [A1400| auxiliary_reconstruction_loss: 638.48401 | l1_loss: 157.23608 | mse_loss: 18.91753:  16%|‚ñà‚ñã        | 665600/4096000 [03:42<12:32, 4557.83it/s]1400| auxiliary_reconstruction_loss: 638.48401 | l1_loss: 157.23608 | mse_loss: 18.91753:  18%|‚ñà‚ñä        | 716800/4096000 [03:42<13:50, 4068.90it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.96it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.87it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.89it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 16.96it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.10it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.56it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.27it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 12.36it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.44it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.95it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.31it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.17it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.60it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.11it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.30it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.63it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.53it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.40it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.11it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.24it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.67it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.16it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.37it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.67it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.55it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A1500| auxiliary_reconstruction_loss: 602.36243 | l1_loss: 141.26013 | mse_loss: 18.79263:  18%|‚ñà‚ñä        | 716800/4096000 [03:55<13:50, 4068.90it/s]1500| auxiliary_reconstruction_loss: 602.36243 | l1_loss: 141.26013 | mse_loss: 18.79263:  19%|‚ñà‚ñâ        | 768000/4096000 [03:55<13:48, 4016.77it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.8671661301532262, 'ce_loss_with_ablation': 8.493475914001465, 'ce_loss_with_sae': 3.961371660232544, 'ce_loss_without_sae': 3.267136812210083}, 'reconstruction_quality': {'explained_variance': 0.11278732120990753, 'mse': 23.78359031677246, 'cossim': 0.698502242565155}, 'shrinkage': {'l2_norm_in': 46.52678298950195, 'l2_norm_out': 1.2916072607040405, 'l2_ratio': 0.021942541003227234, 'relative_reconstruction_bias': 0.041279640048742294}, 'sparsity': {'l0': 298.70587158203125, 'l1': 951.6968994140625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.53it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.92it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.01it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.87it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.86it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.47it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 19.94it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.33it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.24it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 14.87it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.82it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.44it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.52it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.64it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.97it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.86it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 18.10it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.88it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.10it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.61it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.48it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.17it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.31it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.07it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.35it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.66it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.36it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.41it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.48it/s][A
                                                               [A1600| auxiliary_reconstruction_loss: 509.79764 | l1_loss: 201.00494 | mse_loss: 14.21992:  19%|‚ñà‚ñâ        | 768000/4096000 [04:06<13:48, 4016.77it/s]1600| auxiliary_reconstruction_loss: 509.79764 | l1_loss: 201.00494 | mse_loss: 14.21992:  20%|‚ñà‚ñà        | 819200/4096000 [04:06<13:07, 4159.79it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.93it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.05it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.35it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 28.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.64it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.54it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.37it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.33it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.39it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.35it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.40it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  5.13it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [Asae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.8811064231784835, 'ce_loss_with_ablation': 8.657638549804688, 'ce_loss_with_sae': 4.191549777984619, 'ce_loss_without_sae': 3.5889105796813965}, 'reconstruction_quality': {'explained_variance': 0.09586962312459946, 'mse': 21.90958595275879, 'cossim': 0.7338939309120178}, 'shrinkage': {'l2_norm_in': 44.62173843383789, 'l2_norm_out': 1.271422266960144, 'l2_ratio': 0.0232845526188612, 'relative_reconstruction_bias': 0.041370488703250885}, 'sparsity': {'l0': 272.17559814453125, 'l1': 884.6463012695312}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.63it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 12.39it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.50it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.10it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.96it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A1600| auxiliary_reconstruction_loss: 509.79764 | l1_loss: 201.00494 | mse_loss: 14.21992:  20%|‚ñà‚ñà        | 819200/4096000 [04:19<13:07, 4159.79it/s]
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.66it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.94it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.10it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.60it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.03it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.51it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.91it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.65it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.64it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 19.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.88it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.06it/s][A
                                                               [A1700| auxiliary_reconstruction_loss: 570.57642 | l1_loss: 218.46779 | mse_loss: 13.95643:  20%|‚ñà‚ñà        | 819200/4096000 [04:23<13:07, 4159.79it/s]1700| auxiliary_reconstruction_loss: 570.57642 | l1_loss: 218.46779 | mse_loss: 13.95643:  21%|‚ñà‚ñà‚ñè       | 870400/4096000 [04:23<14:13, 3778.79it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 18.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.04it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.43it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.61it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.33it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.82it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.94it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.62it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 27.97it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.58it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.46it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.39it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.34it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.48it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.45it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.50it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.44it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 27.08it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.84it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.84it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 36.41it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.27it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 16.45it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.61it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.18it/s][A
                                                               [A1800| auxiliary_reconstruction_loss: 552.40393 | l1_loss: 192.86975 | mse_loss: 14.61507:  21%|‚ñà‚ñà‚ñè       | 870400/4096000 [04:36<14:13, 3778.79it/s]1800| auxiliary_reconstruction_loss: 552.40393 | l1_loss: 192.86975 | mse_loss: 14.61507:  22%|‚ñà‚ñà‚ñé       | 921600/4096000 [04:36<14:00, 3776.58it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9166545793385883, 'ce_loss_with_ablation': 8.144485473632812, 'ce_loss_with_sae': 3.7041642665863037, 'ce_loss_without_sae': 3.3004348278045654}, 'reconstruction_quality': {'explained_variance': 0.08765576034784317, 'mse': 21.105016708374023, 'cossim': 0.7207379937171936}, 'shrinkage': {'l2_norm_in': 44.21681594848633, 'l2_norm_out': 1.2332127094268799, 'l2_ratio': 0.022855842486023903, 'relative_reconstruction_bias': 0.04126742482185364}, 'sparsity': {'l0': 298.3072204589844, 'l1': 852.1795043945312}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 27.02it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.42it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.12it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.88it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.37it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.94it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.96it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.01it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.89it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.94it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.64it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 14.37it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.56it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.59it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.54it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.20it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.66it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.16it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.62it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.52it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 33.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.46it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 37.26it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 27.02it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.88it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 37.39it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A1900| auxiliary_reconstruction_loss: 483.48795 | l1_loss: 211.84473 | mse_loss: 13.27464:  22%|‚ñà‚ñà‚ñé       | 921600/4096000 [04:46<14:00, 3776.58it/s]1900| auxiliary_reconstruction_loss: 483.48795 | l1_loss: 211.84473 | mse_loss: 13.27464:  24%|‚ñà‚ñà‚ñç       | 972800/4096000 [04:46<12:29, 4167.42it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.89it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.89it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 37.14it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.82it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.81it/s][A
                                                               [Asae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.8699464101321448, 'ce_loss_with_ablation': 8.455536842346191, 'ce_loss_with_sae': 4.099616050720215, 'ce_loss_without_sae': 3.448422908782959}, 'reconstruction_quality': {'explained_variance': 0.11613553017377853, 'mse': 23.13559913635254, 'cossim': 0.7768653035163879}, 'shrinkage': {'l2_norm_in': 45.55447006225586, 'l2_norm_out': 1.3784480094909668, 'l2_ratio': 0.02564532868564129, 'relative_reconstruction_bias': 0.04137982800602913}, 'sparsity': {'l0': 266.42462158203125, 'l1': 923.0075073242188}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.36it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 12.54it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.88it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.08it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.82it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.82it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.90it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.86it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.27it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 14.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 18.95it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.86it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.70it/s][A1900| auxiliary_reconstruction_loss: 483.48795 | l1_loss: 211.84473 | mse_loss: 13.27464:  24%|‚ñà‚ñà‚ñç       | 972800/4096000 [04:59<12:29, 4167.42it/s]
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.26it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.70it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.17it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.92it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.10it/s][A
                                                               [A2000| auxiliary_reconstruction_loss: 497.08307 | l1_loss: 231.67249 | mse_loss: 12.16370:  24%|‚ñà‚ñà‚ñç       | 972800/4096000 [05:00<12:29, 4167.42it/s]2000| auxiliary_reconstruction_loss: 497.08307 | l1_loss: 231.67249 | mse_loss: 12.16370:  25%|‚ñà‚ñà‚ñå       | 1024000/4096000 [05:00<12:52, 3976.58it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.49it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.28it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.01it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.32it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 16.14it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.20it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  4.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 17.94it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.61it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.57it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.06it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.61it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.86it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.44it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 25.33it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  9.93it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 18.20it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.42it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.52it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.58it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.29it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.46it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.06it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.17it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.82it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.54it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.94it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.34it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.99it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.39it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.91it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.03it/s][A
                                                               [A2100| auxiliary_reconstruction_loss: 475.01013 | l1_loss: 200.63205 | mse_loss: 13.38479:  25%|‚ñà‚ñà‚ñå       | 1024000/4096000 [05:16<12:52, 3976.58it/s]2100| auxiliary_reconstruction_loss: 475.01013 | l1_loss: 200.63205 | mse_loss: 13.38479:  26%|‚ñà‚ñà‚ñã       | 1075200/4096000 [05:16<13:44, 3663.24it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.8830123271076089, 'ce_loss_with_ablation': 8.455536842346191, 'ce_loss_with_sae': 4.034193515777588, 'ce_loss_without_sae': 3.448422908782959}, 'reconstruction_quality': {'explained_variance': 0.11773023754358292, 'mse': 23.1339168548584, 'cossim': 0.7902361750602722}, 'shrinkage': {'l2_norm_in': 45.55447006225586, 'l2_norm_out': 1.4007937908172607, 'l2_ratio': 0.026379069313406944, 'relative_reconstruction_bias': 0.04133530333638191}, 'sparsity': {'l0': 260.3193359375, 'l1': 920.1039428710938}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.85it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 38.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.34it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:01,  2.04it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00,  7.84it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.63it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.83it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.89it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.21it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.84it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.50it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.02it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.87it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.95it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.02it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.91it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.04it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.58it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.98it/s][A
                                                               [A2200| auxiliary_reconstruction_loss: 466.86948 | l1_loss: 227.13600 | mse_loss: 12.54013:  26%|‚ñà‚ñà‚ñã       | 1075200/4096000 [05:25<13:44, 3663.24it/s]2200| auxiliary_reconstruction_loss: 466.86948 | l1_loss: 227.13600 | mse_loss: 12.54013:  28%|‚ñà‚ñà‚ñä       | 1126400/4096000 [05:25<11:56, 4147.07it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 25.99it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.64it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.66it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.58it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.36it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.59it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.52it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 24.64it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.34it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.37it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.66it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.47it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.55it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.15it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.19it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.82it/s][A
                                                               [Asae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9079423241412833, 'ce_loss_with_ablation': 8.56460952758789, 'ce_loss_with_sae': 3.9735028743743896, 'ce_loss_without_sae': 3.5080034732818604}, 'reconstruction_quality': {'explained_variance': 0.1256377100944519, 'mse': 24.006349563598633, 'cossim': 0.7924918532371521}, 'shrinkage': {'l2_norm_in': 46.43986129760742, 'l2_norm_out': 1.4393064975738525, 'l2_ratio': 0.026628151535987854, 'relative_reconstruction_bias': 0.04125228151679039}, 'sparsity': {'l0': 259.0287170410156, 'l1': 944.9278564453125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.26it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 14.88it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.48it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.29it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.65it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.60it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.56it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.51it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.63it/s][A
                                                               [A2200| auxiliary_reconstruction_loss: 466.86948 | l1_loss: 227.13600 | mse_loss: 12.54013:  28%|‚ñà‚ñà‚ñä       | 1126400/4096000 [05:39<11:56, 4147.07it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.38it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.19it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 24.22it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.84it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.52it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.92it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.24it/s][A
                                                               [A2300| auxiliary_reconstruction_loss: 434.95987 | l1_loss: 207.82982 | mse_loss: 12.25253:  28%|‚ñà‚ñà‚ñä       | 1126400/4096000 [05:42<11:56, 4147.07it/s]2300| auxiliary_reconstruction_loss: 434.95987 | l1_loss: 207.82982 | mse_loss: 12.25253:  29%|‚ñà‚ñà‚ñâ       | 1177600/4096000 [05:42<12:59, 3746.03it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.05it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.66it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.26it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 17.54it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.92it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.51it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.83it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.49it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.63it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.21it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.82it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.92it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.11it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.04it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.70it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.04it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 25.60it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.28it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.02it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.90it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.20it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.04it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  5.49it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 14.41it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.62it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.65it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.50it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.92it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.82it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.10it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.64it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.11it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.09it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.99it/s][A
                                                               [A2400| auxiliary_reconstruction_loss: 440.22198 | l1_loss: 187.11397 | mse_loss: 12.86346:  29%|‚ñà‚ñà‚ñâ       | 1177600/4096000 [05:58<12:59, 3746.03it/s]2400| auxiliary_reconstruction_loss: 440.22198 | l1_loss: 187.11397 | mse_loss: 12.86346:  30%|‚ñà‚ñà‚ñà       | 1228800/4096000 [05:58<13:27, 3548.82it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9144377444929717, 'ce_loss_with_ablation': 8.56460952758789, 'ce_loss_with_sae': 3.9406580924987793, 'ce_loss_without_sae': 3.5080034732818604}, 'reconstruction_quality': {'explained_variance': 0.12679098546504974, 'mse': 24.00347900390625, 'cossim': 0.8017884492874146}, 'shrinkage': {'l2_norm_in': 46.43986129760742, 'l2_norm_out': 1.456374168395996, 'l2_ratio': 0.027164150029420853, 'relative_reconstruction_bias': 0.041255418211221695}, 'sparsity': {'l0': 250.47715759277344, 'l1': 942.1267700195312}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.29it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.82it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.05it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.43it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.66it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.32it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.65it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.42it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.00it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.98it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.59it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.17it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 14.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.23it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.61it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.50it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.58it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.82it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 18.03it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.61it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.70it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.42it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.62it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.41it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.70it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.53it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.30it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.96it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.01it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 16.13it/s][A
                                                               [A2400| auxiliary_reconstruction_loss: 440.22198 | l1_loss: 187.11397 | mse_loss: 12.86346:  30%|‚ñà‚ñà‚ñà       | 1228800/4096000 [06:09<13:27, 3548.82it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.55it/s][A
                                                               [A2500| auxiliary_reconstruction_loss: 458.05020 | l1_loss: 224.89577 | mse_loss: 11.63499:  30%|‚ñà‚ñà‚ñà       | 1228800/4096000 [06:09<13:27, 3548.82it/s]2500| auxiliary_reconstruction_loss: 458.05020 | l1_loss: 224.89577 | mse_loss: 11.63499:  31%|‚ñà‚ñà‚ñà‚ñè      | 1280000/4096000 [06:09<12:23, 3785.68it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.91it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.24it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.98it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.35it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.61it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.40it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.60it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.01it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.55it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.25it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.19it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.00it/s][A
                                                               [A2500| auxiliary_reconstruction_loss: 458.05020 | l1_loss: 224.89577 | mse_loss: 11.63499:  31%|‚ñà‚ñà‚ñà‚ñè      | 1280000/4096000 [06:20<12:23, 3785.68it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9399683087178853, 'ce_loss_with_ablation': 8.493475914001465, 'ce_loss_with_sae': 3.5808827877044678, 'ce_loss_without_sae': 3.267136812210083}, 'reconstruction_quality': {'explained_variance': 0.12422257661819458, 'mse': 23.75241470336914, 'cossim': 0.802868664264679}, 'shrinkage': {'l2_norm_in': 46.52678298950195, 'l2_norm_out': 1.4622061252593994, 'l2_ratio': 0.027286341413855553, 'relative_reconstruction_bias': 0.041359491646289825}, 'sparsity': {'l0': 254.4267578125, 'l1': 938.6217041015625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.51it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.34it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.94it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.94it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.90it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.63it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.84it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.88it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.82it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.65it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.67it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.46it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.05it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.32it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.60it/s][A
                                                               [A2600| auxiliary_reconstruction_loss: 450.66937 | l1_loss: 190.07520 | mse_loss: 12.97076:  31%|‚ñà‚ñà‚ñà‚ñè      | 1280000/4096000 [06:26<12:23, 3785.68it/s]2600| auxiliary_reconstruction_loss: 450.66937 | l1_loss: 190.07520 | mse_loss: 12.97076:  32%|‚ñà‚ñà‚ñà‚ñé      | 1331200/4096000 [06:26<13:07, 3512.83it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.89it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.86it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 14.65it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.66it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.00it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.19it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.05it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.48it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.70it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.02it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.99it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.12it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.52it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.93it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.48it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.23it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 24.11it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.58it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.56it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.07it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.86it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.93it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.29it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.59it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.46it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.59it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.61it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.50it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A2600| auxiliary_reconstruction_loss: 450.66937 | l1_loss: 190.07520 | mse_loss: 12.97076:  32%|‚ñà‚ñà‚ñà‚ñé      | 1331200/4096000 [06:39<13:07, 3512.83it/s]2700| auxiliary_reconstruction_loss: 459.37830 | l1_loss: 229.82954 | mse_loss: 12.16721:  32%|‚ñà‚ñà‚ñà‚ñé      | 1331200/4096000 [06:40<13:07, 3512.83it/s]2700| auxiliary_reconstruction_loss: 459.37830 | l1_loss: 229.82954 | mse_loss: 12.16721:  34%|‚ñà‚ñà‚ñà‚ñç      | 1382400/4096000 [06:40<12:32, 3605.71it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9443903990058782, 'ce_loss_with_ablation': 8.493475914001465, 'ce_loss_with_sae': 3.5577714443206787, 'ce_loss_without_sae': 3.267136812210083}, 'reconstruction_quality': {'explained_variance': 0.12511935830116272, 'mse': 23.746374130249023, 'cossim': 0.8101009726524353}, 'shrinkage': {'l2_norm_in': 46.52678298950195, 'l2_norm_out': 1.4766699075698853, 'l2_ratio': 0.02769424393773079, 'relative_reconstruction_bias': 0.0414440743625164}, 'sparsity': {'l0': 246.4453125, 'l1': 938.1140747070312}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.82it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 35.64it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.59it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.83it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 35.46it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.82it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.85it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 37.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.37it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.14it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A2800| auxiliary_reconstruction_loss: 369.58612 | l1_loss: 207.70035 | mse_loss: 10.43835:  34%|‚ñà‚ñà‚ñà‚ñç      | 1382400/4096000 [06:45<12:32, 3605.71it/s]2800| auxiliary_reconstruction_loss: 369.58612 | l1_loss: 207.70035 | mse_loss: 10.43835:  35%|‚ñà‚ñà‚ñà‚ñå      | 1433600/4096000 [06:45<10:03, 4409.00it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.84it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:01,  1.56it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.82it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.84it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 37.88it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [Asae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9499086679423773, 'ce_loss_with_ablation': 8.657638549804688, 'ce_loss_with_sae': 3.8428099155426025, 'ce_loss_without_sae': 3.5889105796813965}, 'reconstruction_quality': {'explained_variance': 0.10758435726165771, 'mse': 21.879819869995117, 'cossim': 0.8314691781997681}, 'shrinkage': {'l2_norm_in': 44.62173843383789, 'l2_norm_out': 1.4389902353286743, 'l2_ratio': 0.028536835685372353, 'relative_reconstruction_bias': 0.041441723704338074}, 'sparsity': {'l0': 207.77207946777344, 'l1': 869.087890625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 25.99it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.96it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.70it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 37.43it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.82it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.59it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.49it/s][A
                                                               [A2900| auxiliary_reconstruction_loss: 423.16516 | l1_loss: 247.12857 | mse_loss: 10.44930:  35%|‚ñà‚ñà‚ñà‚ñå      | 1433600/4096000 [06:55<10:03, 4409.00it/s]2900| auxiliary_reconstruction_loss: 423.16516 | l1_loss: 247.12857 | mse_loss: 10.44930:  36%|‚ñà‚ñà‚ñà‚ñã      | 1484800/4096000 [06:55<09:18, 4671.52it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 36.50it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.12it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.44it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.58it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.19it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.83it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 38.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.66it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.64it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.64it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.68it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 37.35it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.55it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.64it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.62it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.12it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.06it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.99it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.10it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.63it/s][A
                                                               [A3000| auxiliary_reconstruction_loss: 406.99509 | l1_loss: 198.55405 | mse_loss: 11.62668:  36%|‚ñà‚ñà‚ñà‚ñã      | 1484800/4096000 [07:06<09:18, 4671.52it/s]3000| auxiliary_reconstruction_loss: 406.99509 | l1_loss: 198.55405 | mse_loss: 11.62668:  38%|‚ñà‚ñà‚ñà‚ñä      | 1536000/4096000 [07:06<09:21, 4562.15it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.961103577073094, 'ce_loss_with_ablation': 8.144485473632812, 'ce_loss_with_sae': 3.4888510704040527, 'ce_loss_without_sae': 3.3004348278045654}, 'reconstruction_quality': {'explained_variance': 0.09738332033157349, 'mse': 21.08591651916504, 'cossim': 0.8045634627342224}, 'shrinkage': {'l2_norm_in': 44.21681594848633, 'l2_norm_out': 1.3703696727752686, 'l2_ratio': 0.027217242866754532, 'relative_reconstruction_bias': 0.041180938482284546}, 'sparsity': {'l0': 234.49082946777344, 'l1': 834.7316284179688}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.56it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.13it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 14.47it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 20.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.26it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.41it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.60it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.02it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.22it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.27it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.48it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.05it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.53it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.60it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.40it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.39it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.41it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 13.72it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.50it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 20.35it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.29it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  7.84it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.63it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.09it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.18it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.43it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.48it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.32it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  4.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.61it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 12.02it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 19.07it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.53it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.70it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 17.05it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 17.23it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.61it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.01it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.27it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.39it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.63it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.87it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.61it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.11it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.36it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.27it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.83it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  5.40it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 11.67it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A3000| auxiliary_reconstruction_loss: 406.99509 | l1_loss: 198.55405 | mse_loss: 11.62668:  38%|‚ñà‚ñà‚ñà‚ñä      | 1536000/4096000 [07:19<09:21, 4562.15it/s]
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 13.06it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 19.71it/s][A
                                                               [A3100| auxiliary_reconstruction_loss: 370.41220 | l1_loss: 256.98218 | mse_loss: 8.89959:  38%|‚ñà‚ñà‚ñà‚ñä      | 1536000/4096000 [07:19<09:21, 4562.15it/s] 3100| auxiliary_reconstruction_loss: 370.41220 | l1_loss: 256.98218 | mse_loss: 8.89959:  39%|‚ñà‚ñà‚ñà‚ñâ      | 1587200/4096000 [07:19<09:36, 4353.72it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.47it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.62it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.32it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.50it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.32it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.04it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.62it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.33it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.59it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.64it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 14.56it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.08it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.44it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.54it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.32it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.52it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.26it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.26it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.46it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.66it/s][A
                                                               [A3100| auxiliary_reconstruction_loss: 370.41220 | l1_loss: 256.98218 | mse_loss: 8.89959:  39%|‚ñà‚ñà‚ñà‚ñâ      | 1587200/4096000 [07:30<09:36, 4353.72it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9258325104500386, 'ce_loss_with_ablation': 8.455536842346191, 'ce_loss_with_sae': 3.8197879791259766, 'ce_loss_without_sae': 3.448422908782959}, 'reconstruction_quality': {'explained_variance': 0.1246427446603775, 'mse': 23.11604118347168, 'cossim': 0.8431650996208191}, 'shrinkage': {'l2_norm_in': 45.55447006225586, 'l2_norm_out': 1.5007683038711548, 'l2_ratio': 0.02950054407119751, 'relative_reconstruction_bias': 0.041378673166036606}, 'sparsity': {'l0': 206.66172790527344, 'l1': 903.5888671875}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 14.39it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.65it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.26it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  7.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.29it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.38it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.40it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.57it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.52it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 18.67it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 18.01it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 18.48it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.26it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.41it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.63it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.10it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.31it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.53it/s][A
                                                               [A3200| auxiliary_reconstruction_loss: 322.70096 | l1_loss: 251.01407 | mse_loss: 8.28888:  39%|‚ñà‚ñà‚ñà‚ñâ      | 1587200/4096000 [07:37<09:36, 4353.72it/s]3200| auxiliary_reconstruction_loss: 322.70096 | l1_loss: 251.01407 | mse_loss: 8.28888:  40%|‚ñà‚ñà‚ñà‚ñà      | 1638400/4096000 [07:37<10:42, 3827.17it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 18.05it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.62it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.76it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:01,  2.52it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.61it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.51it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.53it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.58it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.59it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.62it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.66it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 36.67it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.59it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.54it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.62it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.59it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.23it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.42it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.58it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.97it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.02it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 12.33it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.51it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.63it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.21it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 18.11it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 19.38it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.41it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.56it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.31it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.02it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.51it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.26it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.49it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.92it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.29it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.30it/s][A
                                                               [A3200| auxiliary_reconstruction_loss: 322.70096 | l1_loss: 251.01407 | mse_loss: 8.28888:  40%|‚ñà‚ñà‚ñà‚ñà      | 1638400/4096000 [07:49<10:42, 3827.17it/s]3300| auxiliary_reconstruction_loss: 365.38922 | l1_loss: 232.38174 | mse_loss: 9.62640:  40%|‚ñà‚ñà‚ñà‚ñà      | 1638400/4096000 [07:54<10:42, 3827.17it/s]3300| auxiliary_reconstruction_loss: 365.38922 | l1_loss: 232.38174 | mse_loss: 9.62640:  41%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 1689600/4096000 [07:54<11:20, 3538.76it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9283267777255166, 'ce_loss_with_ablation': 8.455536842346191, 'ce_loss_with_sae': 3.8072988986968994, 'ce_loss_without_sae': 3.448422908782959}, 'reconstruction_quality': {'explained_variance': 0.12516465783119202, 'mse': 23.115190505981445, 'cossim': 0.8464849591255188}, 'shrinkage': {'l2_norm_in': 45.55447006225586, 'l2_norm_out': 1.5085691213607788, 'l2_ratio': 0.029745830222964287, 'relative_reconstruction_bias': 0.04137356951832771}, 'sparsity': {'l0': 203.1960906982422, 'l1': 901.5}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 18.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 18.38it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.32it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.39it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.42it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  4.05it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.63it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 34.95it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 25.99it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 37.17it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.35it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.39it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.33it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.40it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.36it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.41it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.38it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.03it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 11.70it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  5.82it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 11.07it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 14.71it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 17.19it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.59it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.27it/s][A
                                                               [A3400| auxiliary_reconstruction_loss: 354.05646 | l1_loss: 231.19794 | mse_loss: 9.74451:  41%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 1689600/4096000 [08:01<11:20, 3538.76it/s]3400| auxiliary_reconstruction_loss: 354.05646 | l1_loss: 231.19794 | mse_loss: 9.74451:  42%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 1740800/4096000 [08:01<09:30, 4127.59it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 19.92it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.18it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  7.98it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.59it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.26it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.52it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.03it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.43it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.61it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.57it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 17.50it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.62it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 14.37it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.38it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 14.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 16.96it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.65it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.35it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.54it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.88it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.19it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.02it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.62it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.56it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.54it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.02it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.32it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.27it/s][A
                                                               [Asae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9421802397224605, 'ce_loss_with_ablation': 8.56460952758789, 'ce_loss_with_sae': 3.80037522315979, 'ce_loss_without_sae': 3.5080034732818604}, 'reconstruction_quality': {'explained_variance': 0.13214917480945587, 'mse': 23.987571716308594, 'cossim': 0.8425431251525879}, 'shrinkage': {'l2_norm_in': 46.43986129760742, 'l2_norm_out': 1.5364971160888672, 'l2_ratio': 0.029605228453874588, 'relative_reconstruction_bias': 0.04132631793618202}, 'sparsity': {'l0': 202.7521514892578, 'l1': 926.9651489257812}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.65it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.33it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.38it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.51it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.41it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.40it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.38it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.38it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.35it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A3500| auxiliary_reconstruction_loss: 348.25513 | l1_loss: 226.05318 | mse_loss: 9.24801:  42%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 1740800/4096000 [08:16<09:30, 4127.59it/s]3500| auxiliary_reconstruction_loss: 348.25513 | l1_loss: 226.05318 | mse_loss: 9.24801:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 1792000/4096000 [08:16<09:46, 3929.83it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.82it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 14.81it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.61it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 20.32it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  5.60it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 10.46it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.97it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.18it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.13it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.59it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.47it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.28it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.40it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.16it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.17it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 25.83it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.25it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.02it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 16.05it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.82it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.28it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.06it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.57it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.33it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.62it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.97it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.29it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.49it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.61it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.39it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.69it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 12.35it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.06it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 18.15it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 18.90it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 19.44it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.27it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.36it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.51it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.36it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.51it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.23it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.28it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.41it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.27it/s][A
                                                               [A3500| auxiliary_reconstruction_loss: 348.25513 | l1_loss: 226.05318 | mse_loss: 9.24801:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 1792000/4096000 [08:29<09:46, 3929.83it/s]3600| auxiliary_reconstruction_loss: 372.20697 | l1_loss: 203.12849 | mse_loss: 10.74984:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 1792000/4096000 [08:31<09:46, 3929.83it/s]3600| auxiliary_reconstruction_loss: 372.20697 | l1_loss: 203.12849 | mse_loss: 10.74984:  45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 1843200/4096000 [08:31<10:00, 3750.37it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9442393710992575, 'ce_loss_with_ablation': 8.56460952758789, 'ce_loss_with_sae': 3.7899630069732666, 'ce_loss_without_sae': 3.5080034732818604}, 'reconstruction_quality': {'explained_variance': 0.13261139392852783, 'mse': 23.987934112548828, 'cossim': 0.8456980586051941}, 'shrinkage': {'l2_norm_in': 46.43986129760742, 'l2_norm_out': 1.542991042137146, 'l2_ratio': 0.0298187043517828, 'relative_reconstruction_bias': 0.04129603132605553}, 'sparsity': {'l0': 198.65977478027344, 'l1': 924.4808959960938}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.82it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 17.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 17.93it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.51it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.87it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  5.27it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 10.38it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.54it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.89it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.60it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.05it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.49it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.50it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.25it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.20it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 13.07it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 20.34it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.25it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.64it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.33it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.66it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.38it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.12it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.70it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.42it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.32it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.57it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.66it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.57it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.62it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.18it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 16.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.58it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 17.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.40it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 12.49it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.26it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.16it/s][A
                                                               [A3700| auxiliary_reconstruction_loss: 371.29449 | l1_loss: 250.55742 | mse_loss: 9.10495:  45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 1843200/4096000 [08:42<10:00, 3750.37it/s] 3700| auxiliary_reconstruction_loss: 371.29449 | l1_loss: 250.55742 | mse_loss: 9.10495:  46%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 1894400/4096000 [08:42<09:16, 3954.14it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 14.91it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.44it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.65it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.88it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.18it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.39it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.82it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 37.51it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.62it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.51it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.82it/s][A
                                                               [Asae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9605323332506875, 'ce_loss_with_ablation': 8.493475914001465, 'ce_loss_with_sae': 3.4734082221984863, 'ce_loss_without_sae': 3.267136812210083}, 'reconstruction_quality': {'explained_variance': 0.12943175435066223, 'mse': 23.739675521850586, 'cossim': 0.8426805734634399}, 'shrinkage': {'l2_norm_in': 46.52678298950195, 'l2_norm_out': 1.5394006967544556, 'l2_ratio': 0.02964578941464424, 'relative_reconstruction_bias': 0.04136550799012184}, 'sparsity': {'l0': 203.17442321777344, 'l1': 921.1658325195312}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  5.28it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 10.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.11it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.64it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.61it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.55it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.43it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.40it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 18.59it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 19.24it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.28it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.45it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 18.36it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.59it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.97it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.24it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.32it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.39it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.62it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.60it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.82it/s][A
                                                               [A3800| auxiliary_reconstruction_loss: 353.01758 | l1_loss: 218.39394 | mse_loss: 9.93636:  46%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 1894400/4096000 [08:56<09:16, 3954.14it/s]3800| auxiliary_reconstruction_loss: 353.01758 | l1_loss: 218.39394 | mse_loss: 9.93636:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 1945600/4096000 [08:56<09:10, 3904.56it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.04it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.14it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:01,  2.58it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00,  8.54it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.70it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 17.97it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.66it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.07it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.20it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 13.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.28it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  7.82it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.70it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.95it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.17it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.22it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 36.93it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.85it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 35.47it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.41it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.82it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A3800| auxiliary_reconstruction_loss: 353.01758 | l1_loss: 218.39394 | mse_loss: 9.93636:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 1945600/4096000 [09:09<09:10, 3904.56it/s]3900| auxiliary_reconstruction_loss: 377.01923 | l1_loss: 248.84418 | mse_loss: 9.82637:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 1945600/4096000 [09:09<09:10, 3904.56it/s]3900| auxiliary_reconstruction_loss: 377.01923 | l1_loss: 248.84418 | mse_loss: 9.82637:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 1996800/4096000 [09:09<09:04, 3855.13it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.961735844701313, 'ce_loss_with_ablation': 8.493475914001465, 'ce_loss_with_sae': 3.467118263244629, 'ce_loss_without_sae': 3.267136812210083}, 'reconstruction_quality': {'explained_variance': 0.12985621392726898, 'mse': 23.741514205932617, 'cossim': 0.8455604910850525}, 'shrinkage': {'l2_norm_in': 46.52678298950195, 'l2_norm_out': 1.54498291015625, 'l2_ratio': 0.029842466115951538, 'relative_reconstruction_bias': 0.04130720719695091}, 'sparsity': {'l0': 199.4005889892578, 'l1': 918.6140747070312}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.04it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.21it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.93it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.52it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.97it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.31it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.05it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 12.40it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 13.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 19.96it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.39it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.08it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.66it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.97it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  5.27it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 11.15it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.40it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.17it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.93it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.54it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.30it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.20it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.57it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.65it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.59it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 14.18it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.59it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.07it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.47it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.48it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.88it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.31it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.26it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.00it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.26it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A3900| auxiliary_reconstruction_loss: 377.01923 | l1_loss: 248.84418 | mse_loss: 9.82637:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 1996800/4096000 [09:20<09:04, 3855.13it/s]
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 12.96it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 18.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 19.12it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.31it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.46it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.21it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 12.32it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.37it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.64it/s][A
                                                               [A4000| auxiliary_reconstruction_loss: 332.83618 | l1_loss: 235.00122 | mse_loss: 8.21100:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 1996800/4096000 [09:22<09:04, 3855.13it/s]4000| auxiliary_reconstruction_loss: 332.83618 | l1_loss: 235.00122 | mse_loss: 8.21100:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2048000/4096000 [09:22<08:42, 3918.21it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.62it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.64it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.03it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.33it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.92it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.58it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.08it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 16.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.41it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.30it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 17.38it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.46it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.24it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.18it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.40it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.99it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.41it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.04it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.49it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.34it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.64it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.00it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.42it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 37.32it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [Asae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9681914954365016, 'ce_loss_with_ablation': 8.657638549804688, 'ce_loss_with_sae': 3.7501392364501953, 'ce_loss_without_sae': 3.5889105796813965}, 'reconstruction_quality': {'explained_variance': 0.11211355030536652, 'mse': 21.874460220336914, 'cossim': 0.8615531325340271}, 'shrinkage': {'l2_norm_in': 44.62173843383789, 'l2_norm_out': 1.5027577877044678, 'l2_ratio': 0.030560864135622978, 'relative_reconstruction_bias': 0.04134143888950348}, 'sparsity': {'l0': 168.6277313232422, 'l1': 850.2701416015625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.91it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.81it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 37.31it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.95it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.03it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.05it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.10it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 24.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.33it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.12it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.10it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00,  9.83it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.43it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.40it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 14.00it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 14.94it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 16.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.26it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.11it/s][A
                                                               [A4100| auxiliary_reconstruction_loss: 335.83636 | l1_loss: 251.66458 | mse_loss: 8.45582:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2048000/4096000 [09:36<08:42, 3918.21it/s]4100| auxiliary_reconstruction_loss: 335.83636 | l1_loss: 251.66458 | mse_loss: 8.45582:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 2099200/4096000 [09:36<08:40, 3834.50it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.21it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 17.59it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.17it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.34it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.24it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  7.96it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  5.27it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 13.36it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.34it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.06it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.27it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.53it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.53it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.57it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  9.76it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 13.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.61it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 16.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.23it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.45it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.22it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  7.89it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.16it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.24it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.25it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.58it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.32it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.02it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.24it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.46it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.43it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.41it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 14.40it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 14.97it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.97it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 16.86it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.25it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.28it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.47it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.32it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.14it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.26it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  5.92it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 11.07it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.27it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.34it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.54it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.44it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.23it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00,  9.90it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.44it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.52it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:01,  2.46it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  6.86it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.51it/s][A4100| auxiliary_reconstruction_loss: 335.83636 | l1_loss: 251.66458 | mse_loss: 8.45582:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 2099200/4096000 [09:49<08:40, 3834.50it/s]
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 17.44it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.45it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.09it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.22it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.17it/s][A
                                                               [A4200| auxiliary_reconstruction_loss: 332.23187 | l1_loss: 218.32822 | mse_loss: 9.33351:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 2099200/4096000 [09:57<08:40, 3834.50it/s]4200| auxiliary_reconstruction_loss: 332.23187 | l1_loss: 218.32822 | mse_loss: 9.33351:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 2150400/4096000 [09:57<09:50, 3297.06it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9715379722652792, 'ce_loss_with_ablation': 8.144485473632812, 'ce_loss_with_sae': 3.4383063316345215, 'ce_loss_without_sae': 3.3004348278045654}, 'reconstruction_quality': {'explained_variance': 0.10147092491388321, 'mse': 21.073232650756836, 'cossim': 0.8336274027824402}, 'shrinkage': {'l2_norm_in': 44.21681594848633, 'l2_norm_out': 1.4303416013717651, 'l2_ratio': 0.029031598940491676, 'relative_reconstruction_bias': 0.04126227647066116}, 'sparsity': {'l0': 194.43496704101562, 'l1': 820.9781494140625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 19.36it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.32it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.64it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.51it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 16.47it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.24it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.30it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.49it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.36it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.19it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.13it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.24it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  7.91it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.29it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.39it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.32it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.06it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.29it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.03it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  5.96it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 11.60it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 13.15it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.60it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 17.61it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.25it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.48it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.22it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  7.91it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.17it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.25it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.24it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.00it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.25it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.27it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.33it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.04it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 19.22it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.41it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.49it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 12.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.63it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 16.84it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.22it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.42it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.31it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.02it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.17it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.23it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.23it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  7.95it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.25it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.52it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A4200| auxiliary_reconstruction_loss: 332.23187 | l1_loss: 218.32822 | mse_loss: 9.33351:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 2150400/4096000 [10:09<09:50, 3297.06it/s]
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.36it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.07it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  5.42it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 11.29it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.42it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.39it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  9.81it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 13.84it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.54it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 16.90it/s][A
                                                               [A4300| auxiliary_reconstruction_loss: 306.37064 | l1_loss: 225.73691 | mse_loss: 8.19846:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 2150400/4096000 [10:11<09:50, 3297.06it/s]4300| auxiliary_reconstruction_loss: 306.37064 | l1_loss: 225.73691 | mse_loss: 8.19846:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 2201600/4096000 [10:11<09:19, 3382.92it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 18.28it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.24it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  7.92it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.16it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00,  9.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.24it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.00it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.24it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.30it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.97it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 17.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.23it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.82it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 37.39it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.60it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [Asae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.944701433116849, 'ce_loss_with_ablation': 8.455536842346191, 'ce_loss_with_sae': 3.725309133529663, 'ce_loss_without_sae': 3.448422908782959}, 'reconstruction_quality': {'explained_variance': 0.12814302742481232, 'mse': 23.10753059387207, 'cossim': 0.8666641116142273}, 'shrinkage': {'l2_norm_in': 45.55447006225586, 'l2_norm_out': 1.551658034324646, 'l2_ratio': 0.03106778860092163, 'relative_reconstruction_bias': 0.041390009224414825}, 'sparsity': {'l0': 175.1824188232422, 'l1': 887.2136840820312}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 27.11it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 27.10it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.54it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.38it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.39it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.60it/s][A
                                                               [A4400| auxiliary_reconstruction_loss: 311.81720 | l1_loss: 254.69189 | mse_loss: 7.31772:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 2201600/4096000 [10:22<09:19, 3382.92it/s]4400| auxiliary_reconstruction_loss: 311.81720 | l1_loss: 254.69189 | mse_loss: 7.31772:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 2252800/4096000 [10:22<08:20, 3680.38it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 27.43it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 37.91it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.66it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 37.96it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.82it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.82it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 27.06it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.95it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 35.35it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A4500| auxiliary_reconstruction_loss: 318.04321 | l1_loss: 243.85529 | mse_loss: 8.37223:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 2252800/4096000 [10:30<08:20, 3680.38it/s]4500| auxiliary_reconstruction_loss: 318.04321 | l1_loss: 243.85529 | mse_loss: 8.37223:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 2304000/4096000 [10:30<07:11, 4152.91it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9458343122382847, 'ce_loss_with_ablation': 8.455536842346191, 'ce_loss_with_sae': 3.7196366786956787, 'ce_loss_without_sae': 3.448422908782959}, 'reconstruction_quality': {'explained_variance': 0.12841510772705078, 'mse': 23.104398727416992, 'cossim': 0.8683032393455505}, 'shrinkage': {'l2_norm_in': 45.55447006225586, 'l2_norm_out': 1.5565279722213745, 'l2_ratio': 0.031191755086183548, 'relative_reconstruction_bias': 0.04144575074315071}, 'sparsity': {'l0': 172.8302764892578, 'l1': 886.6310424804688}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.83it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 36.30it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.62it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.37it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.66it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.62it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.23it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 28.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.54it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.56it/s][A
                                                               [A4600| auxiliary_reconstruction_loss: 350.61957 | l1_loss: 277.36923 | mse_loss: 8.07361:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 2304000/4096000 [10:36<07:11, 4152.91it/s]4600| auxiliary_reconstruction_loss: 350.61957 | l1_loss: 277.36923 | mse_loss: 8.07361:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 2355200/4096000 [10:36<05:53, 4925.11it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 39.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.50it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.56it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.95it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.81it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  5.20it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.87it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.92it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.62it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.89it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 18.31it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.97it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.81it/s][A
                                                               [Asae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9544993826425013, 'ce_loss_with_ablation': 8.56460952758789, 'ce_loss_with_sae': 3.73808217048645, 'ce_loss_without_sae': 3.5080034732818604}, 'reconstruction_quality': {'explained_variance': 0.13512957096099854, 'mse': 23.979373931884766, 'cossim': 0.8631078600883484}, 'shrinkage': {'l2_norm_in': 46.43986129760742, 'l2_norm_out': 1.5807780027389526, 'l2_ratio': 0.030947744846343994, 'relative_reconstruction_bias': 0.04135243967175484}, 'sparsity': {'l0': 174.5701141357422, 'l1': 911.2514038085938}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.47it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 14.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.26it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.94it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.99it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.84it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.54it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.10it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.01it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.43it/s][A
                                                               [A4600| auxiliary_reconstruction_loss: 350.61957 | l1_loss: 277.36923 | mse_loss: 8.07361:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 2355200/4096000 [10:49<05:53, 4925.11it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 18.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.14it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.58it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.16it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.45it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.22it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.87it/s][A
                                                               [A4700| auxiliary_reconstruction_loss: 296.67200 | l1_loss: 206.05685 | mse_loss: 8.68966:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 2355200/4096000 [10:51<05:53, 4925.11it/s]4700| auxiliary_reconstruction_loss: 296.67200 | l1_loss: 206.05685 | mse_loss: 8.68966:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 2406400/4096000 [10:51<06:22, 4420.80it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 36.04it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.93it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.25it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.65it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.36it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.67it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.67it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.18it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.65it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.53it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.50it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.30it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.36it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 24.93it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.45it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.52it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.64it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.29it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.70it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.99it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.16it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.07it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.98it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.57it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.95it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.84it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.39it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.11it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A4800| auxiliary_reconstruction_loss: 315.07083 | l1_loss: 208.45131 | mse_loss: 9.15159:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 2406400/4096000 [11:07<06:22, 4420.80it/s]4800| auxiliary_reconstruction_loss: 315.07083 | l1_loss: 208.45131 | mse_loss: 9.15159:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 2457600/4096000 [11:07<06:51, 3978.02it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.955448463414702, 'ce_loss_with_ablation': 8.56460952758789, 'ce_loss_with_sae': 3.733283042907715, 'ce_loss_without_sae': 3.5080034732818604}, 'reconstruction_quality': {'explained_variance': 0.13537488877773285, 'mse': 23.97882080078125, 'cossim': 0.8646659255027771}, 'shrinkage': {'l2_norm_in': 46.43986129760742, 'l2_norm_out': 1.5844134092330933, 'l2_ratio': 0.03105979971587658, 'relative_reconstruction_bias': 0.041352611035108566}, 'sparsity': {'l0': 171.76699829101562, 'l1': 909.69775390625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.84it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  4.95it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.52it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.65it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  8.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.24it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.58it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.07it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.33it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 27.48it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.27it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 18.51it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.21it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.22it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.56it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.65it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.64it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 29.93it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.62it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.63it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.63it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.46it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.56it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.60it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.69it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 37.44it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 25.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A4900| auxiliary_reconstruction_loss: 337.85608 | l1_loss: 232.25635 | mse_loss: 8.50411:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 2457600/4096000 [11:16<06:51, 3978.02it/s]4900| auxiliary_reconstruction_loss: 337.85608 | l1_loss: 232.25635 | mse_loss: 8.50411:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 2508800/4096000 [11:16<06:06, 4329.31it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.51it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.94it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.37it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.88it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.24it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.63it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.06it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.62it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.41it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.25it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.62it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.67it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.66it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.21it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.62it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.20it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.59it/s][A
                                                               [Asae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9682688015590633, 'ce_loss_with_ablation': 8.493475914001465, 'ce_loss_with_sae': 3.4329748153686523, 'ce_loss_without_sae': 3.267136812210083}, 'reconstruction_quality': {'explained_variance': 0.1319885402917862, 'mse': 23.734846115112305, 'cossim': 0.8601101040840149}, 'shrinkage': {'l2_norm_in': 46.52678298950195, 'l2_norm_out': 1.5771995782852173, 'l2_ratio': 0.030800629407167435, 'relative_reconstruction_bias': 0.041345324367284775}, 'sparsity': {'l0': 178.8839874267578, 'l1': 906.95458984375}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 27.00it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.59it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.69it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A4900| auxiliary_reconstruction_loss: 337.85608 | l1_loss: 232.25635 | mse_loss: 8.50411:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 2508800/4096000 [11:29<06:06, 4329.31it/s]
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  5.14it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.63it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.64it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A5000| auxiliary_reconstruction_loss: 324.90286 | l1_loss: 207.74792 | mse_loss: 9.17668:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 2508800/4096000 [11:30<06:06, 4329.31it/s]5000| auxiliary_reconstruction_loss: 324.90286 | l1_loss: 207.74792 | mse_loss: 9.17668:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 2560000/4096000 [11:30<06:16, 4079.89it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.84it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 36.34it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.58it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 17.86it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.63it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.98it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.64it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.43it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.66it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.44it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.98it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.17it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.53it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.51it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.47it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.54it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.27it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.44it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.96it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.93it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.24it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.80it/s][A
                                                               [A5100| auxiliary_reconstruction_loss: 351.86194 | l1_loss: 222.14703 | mse_loss: 9.85144:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 2560000/4096000 [11:44<06:16, 4079.89it/s]5100| auxiliary_reconstruction_loss: 351.86194 | l1_loss: 222.14703 | mse_loss: 9.85144:  64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 2611200/4096000 [11:44<06:15, 3951.57it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9689778523693533, 'ce_loss_with_ablation': 8.493475914001465, 'ce_loss_with_sae': 3.4292690753936768, 'ce_loss_without_sae': 3.267136812210083}, 'reconstruction_quality': {'explained_variance': 0.1322038620710373, 'mse': 23.736278533935547, 'cossim': 0.861417293548584}, 'shrinkage': {'l2_norm_in': 46.52678298950195, 'l2_norm_out': 1.5798892974853516, 'l2_ratio': 0.030901288613677025, 'relative_reconstruction_bias': 0.0413048230111599}, 'sparsity': {'l0': 176.5124969482422, 'l1': 904.7247924804688}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.81it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  4.01it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.54it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.92it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 16.02it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.24it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.02it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.70it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.67it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.63it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.04it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.51it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.70it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.03it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.17it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.06it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.62it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.48it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.91it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.34it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.20it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.37it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.26it/s][A
                                                               [A5200| auxiliary_reconstruction_loss: 262.28296 | l1_loss: 221.27151 | mse_loss: 7.36968:  64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 2611200/4096000 [11:54<06:15, 3951.57it/s]5200| auxiliary_reconstruction_loss: 262.28296 | l1_loss: 221.27151 | mse_loss: 7.36968:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 2662400/4096000 [11:54<05:33, 4293.69it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.08it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.11it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.36it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.83it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 35.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [Asae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9742662038084485, 'ce_loss_with_ablation': 8.657638549804688, 'ce_loss_with_sae': 3.719348192214966, 'ce_loss_without_sae': 3.5889105796813965}, 'reconstruction_quality': {'explained_variance': 0.1143164187669754, 'mse': 21.871421813964844, 'cossim': 0.8749485015869141}, 'shrinkage': {'l2_norm_in': 44.62173843383789, 'l2_norm_out': 1.5339874029159546, 'l2_ratio': 0.03154144808650017, 'relative_reconstruction_bias': 0.041304122656583786}, 'sparsity': {'l0': 149.25527954101562, 'l1': 836.4515991210938}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 27.15it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  9.83it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 18.13it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 18.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.19it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.66it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.45it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.10it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.46it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.00it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.65it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.96it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.46it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.95it/s][A
                                                               [A5300| auxiliary_reconstruction_loss: 288.43973 | l1_loss: 285.38608 | mse_loss: 6.84149:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 2662400/4096000 [12:06<05:33, 4293.69it/s]5300| auxiliary_reconstruction_loss: 288.43973 | l1_loss: 285.38608 | mse_loss: 6.84149:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 2713600/4096000 [12:06<05:28, 4211.69it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 24.16it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.61it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.18it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.01it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.36it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 16.31it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.82it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.09it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.98it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.52it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.66it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.47it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.20it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.08it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 37.59it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.56it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.44it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.46it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 28.96it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.39it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.35it/s][A
                                                               [A5300| auxiliary_reconstruction_loss: 288.43973 | l1_loss: 285.38608 | mse_loss: 6.84149:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 2713600/4096000 [12:19<05:28, 4211.69it/s]5400| auxiliary_reconstruction_loss: 324.64301 | l1_loss: 241.79460 | mse_loss: 8.22363:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 2713600/4096000 [12:20<05:28, 4211.69it/s]5400| auxiliary_reconstruction_loss: 324.64301 | l1_loss: 241.79460 | mse_loss: 8.22363:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 2764800/4096000 [12:20<05:26, 4083.17it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9758355649567925, 'ce_loss_with_ablation': 8.144485473632812, 'ce_loss_with_sae': 3.4174885749816895, 'ce_loss_without_sae': 3.3004348278045654}, 'reconstruction_quality': {'explained_variance': 0.10356780141592026, 'mse': 21.069534301757812, 'cossim': 0.8472476005554199}, 'shrinkage': {'l2_norm_in': 44.21681594848633, 'l2_norm_out': 1.4604761600494385, 'l2_ratio': 0.02996346913278103, 'relative_reconstruction_bias': 0.04123936966061592}, 'sparsity': {'l0': 174.6369171142578, 'l1': 808.5009765625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 27.00it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.13it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.12it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.86it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.91it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.38it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.88it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.27it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.83it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.26it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.39it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.56it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.15it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.64it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.66it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.43it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.63it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.21it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.24it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.19it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  5.99it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 24.54it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.31it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.96it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.67it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.42it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.04it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.01it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.57it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.37it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.45it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.93it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.44it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.42it/s][A
                                                               [A5500| auxiliary_reconstruction_loss: 282.42514 | l1_loss: 225.21590 | mse_loss: 7.38241:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 2764800/4096000 [12:31<05:26, 4083.17it/s]5500| auxiliary_reconstruction_loss: 282.42514 | l1_loss: 225.21590 | mse_loss: 7.38241:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 2816000/4096000 [12:31<05:06, 4180.54it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 20.99it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.60it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.24it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.82it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.36it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 24.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.32it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.64it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  4.18it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 18.39it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.60it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.56it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.50it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.46it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.15it/s][A
                                                               [Asae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9531509819507862, 'ce_loss_with_ablation': 8.455536842346191, 'ce_loss_with_sae': 3.6830012798309326, 'ce_loss_without_sae': 3.448422908782959}, 'reconstruction_quality': {'explained_variance': 0.12986154854297638, 'mse': 23.1040096282959, 'cossim': 0.8771206140518188}, 'shrinkage': {'l2_norm_in': 45.55447006225586, 'l2_norm_out': 1.576769232749939, 'l2_ratio': 0.03184295818209648, 'relative_reconstruction_bias': 0.04138554260134697}, 'sparsity': {'l0': 159.73281860351562, 'l1': 874.6229858398438}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.22it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 14.48it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.36it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.54it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.54it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.47it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.17it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.01it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.10it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.61it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.81it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 18.27it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 24.14it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.37it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  4.62it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.70it/s][A
                                                               [A5600| auxiliary_reconstruction_loss: 264.93314 | l1_loss: 237.85538 | mse_loss: 7.00917:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 2816000/4096000 [12:48<05:06, 4180.54it/s]5600| auxiliary_reconstruction_loss: 264.93314 | l1_loss: 237.85538 | mse_loss: 7.00917:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 2867200/4096000 [12:48<05:25, 3776.41it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 27.39it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.22it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.82it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 36.54it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.02it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.11it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 36.38it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.84it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  5.43it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 13.94it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.37it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.26it/s][A
                                                               [A5600| auxiliary_reconstruction_loss: 264.93314 | l1_loss: 237.85538 | mse_loss: 7.00917:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 2867200/4096000 [12:59<05:25, 3776.41it/s]5700| auxiliary_reconstruction_loss: 298.03186 | l1_loss: 216.50987 | mse_loss: 8.01165:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 2867200/4096000 [13:00<05:25, 3776.41it/s]5700| auxiliary_reconstruction_loss: 298.03186 | l1_loss: 216.50987 | mse_loss: 8.01165:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 2918400/4096000 [13:00<05:04, 3862.65it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9540635896021581, 'ce_loss_with_ablation': 8.455536842346191, 'ce_loss_with_sae': 3.678431749343872, 'ce_loss_without_sae': 3.448422908782959}, 'reconstruction_quality': {'explained_variance': 0.12999917566776276, 'mse': 23.103239059448242, 'cossim': 0.8778058290481567}, 'shrinkage': {'l2_norm_in': 45.55447006225586, 'l2_norm_out': 1.579062581062317, 'l2_ratio': 0.031909871846437454, 'relative_reconstruction_bias': 0.04139631614089012}, 'sparsity': {'l0': 158.7121124267578, 'l1': 873.4435424804688}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 24.34it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.82it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.39it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.70it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.61it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.92it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.26it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.17it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.39it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.89it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.84it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.87it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.61it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.40it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.53it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.82it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.27it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.13it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.83it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 25.36it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 14.87it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.51it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.56it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.17it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.58it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.00it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.06it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.60it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.98it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.78it/s][A
                                                               [A5800| auxiliary_reconstruction_loss: 265.08643 | l1_loss: 202.88239 | mse_loss: 7.83533:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 2918400/4096000 [13:12<05:04, 3862.65it/s]5800| auxiliary_reconstruction_loss: 265.08643 | l1_loss: 202.88239 | mse_loss: 7.83533:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 2969600/4096000 [13:12<04:38, 4039.33it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.35it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.35it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.64it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.92it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.10it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.90it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.25it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 14.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 20.96it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.22it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.43it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.60it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.11it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.04it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.91it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.97it/s][A
                                                               [Asae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9602463451384635, 'ce_loss_with_ablation': 8.56460952758789, 'ce_loss_with_sae': 3.709022045135498, 'ce_loss_without_sae': 3.5080034732818604}, 'reconstruction_quality': {'explained_variance': 0.136613667011261, 'mse': 23.975791931152344, 'cossim': 0.8724151849746704}, 'shrinkage': {'l2_norm_in': 46.43986129760742, 'l2_norm_out': 1.6029999256134033, 'l2_ratio': 0.03162524476647377, 'relative_reconstruction_bias': 0.04135715961456299}, 'sparsity': {'l0': 160.5173797607422, 'l1': 899.2201538085938}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.43it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 14.91it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.59it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.93it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.64it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.83it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.26it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.82it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.14it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.51it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 25.94it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.56it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.05it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.29it/s][A
                                                               [A5800| auxiliary_reconstruction_loss: 265.08643 | l1_loss: 202.88239 | mse_loss: 7.83533:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 2969600/4096000 [13:29<04:38, 4039.33it/s]5900| auxiliary_reconstruction_loss: 286.42999 | l1_loss: 191.58109 | mse_loss: 8.49554:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 2969600/4096000 [13:29<04:38, 4039.33it/s]5900| auxiliary_reconstruction_loss: 286.42999 | l1_loss: 191.58109 | mse_loss: 8.49554:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 3020800/4096000 [13:29<04:52, 3669.69it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 24.99it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.88it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.00it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.14it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.65it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 16.27it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.56it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.36it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.07it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.02it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.32it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.67it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.10it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.64it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.61it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.62it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.03it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.97it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.93it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.28it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.64it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.89it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.57it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.52it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.15it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.82it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.00it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A5900| auxiliary_reconstruction_loss: 286.42999 | l1_loss: 191.58109 | mse_loss: 8.49554:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 3020800/4096000 [13:40<04:52, 3669.69it/s]
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.94it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.52it/s][A
                                                               [A6000| auxiliary_reconstruction_loss: 329.66199 | l1_loss: 218.34286 | mse_loss: 9.13841:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 3020800/4096000 [13:44<04:52, 3669.69it/s]6000| auxiliary_reconstruction_loss: 329.66199 | l1_loss: 218.34286 | mse_loss: 9.13841:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3072000/4096000 [13:44<04:45, 3589.57it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9606050145921935, 'ce_loss_with_ablation': 8.56460952758789, 'ce_loss_with_sae': 3.7072083950042725, 'ce_loss_without_sae': 3.5080034732818604}, 'reconstruction_quality': {'explained_variance': 0.1367470771074295, 'mse': 23.97601890563965, 'cossim': 0.8732447028160095}, 'shrinkage': {'l2_norm_in': 46.43986129760742, 'l2_norm_out': 1.6047852039337158, 'l2_ratio': 0.031685970723629, 'relative_reconstruction_bias': 0.041346605867147446}, 'sparsity': {'l0': 158.99258422851562, 'l1': 897.9541015625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.63it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 36.31it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.66it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.82it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 29.12it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.67it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 34.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.33it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A6100| auxiliary_reconstruction_loss: 290.86407 | l1_loss: 240.77396 | mse_loss: 7.78217:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3072000/4096000 [13:49<04:45, 3589.57it/s]6100| auxiliary_reconstruction_loss: 290.86407 | l1_loss: 240.77396 | mse_loss: 7.78217:  76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 3123200/4096000 [13:49<03:41, 4393.47it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 35.61it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [Asae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9719641866158961, 'ce_loss_with_ablation': 8.493475914001465, 'ce_loss_with_sae': 3.413661479949951, 'ce_loss_without_sae': 3.267136812210083}, 'reconstruction_quality': {'explained_variance': 0.13327686488628387, 'mse': 23.729711532592773, 'cossim': 0.8682786822319031}, 'shrinkage': {'l2_norm_in': 46.52678298950195, 'l2_norm_out': 1.5971750020980835, 'l2_ratio': 0.0313861221075058, 'relative_reconstruction_bias': 0.04138903692364693}, 'sparsity': {'l0': 165.99278259277344, 'l1': 896.5166015625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.84it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 35.59it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.06it/s][A
                                                               [A6200| auxiliary_reconstruction_loss: 310.35297 | l1_loss: 258.27234 | mse_loss: 7.66172:  76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 3123200/4096000 [13:58<03:41, 4393.47it/s]6200| auxiliary_reconstruction_loss: 310.35297 | l1_loss: 258.27234 | mse_loss: 7.66172:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 3174400/4096000 [13:58<03:12, 4784.06it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.83it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 35.53it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.64it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 37.60it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.02it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.51it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.30it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.67it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.82it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 36.24it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.33it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.43it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.59it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.63it/s][A
                                                               [A6300| auxiliary_reconstruction_loss: 338.33829 | l1_loss: 203.07925 | mse_loss: 9.68660:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 3174400/4096000 [14:07<03:12, 4784.06it/s]6300| auxiliary_reconstruction_loss: 338.33829 | l1_loss: 203.07925 | mse_loss: 9.68660:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 3225600/4096000 [14:07<02:53, 5009.23it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9722187843494243, 'ce_loss_with_ablation': 8.493475914001465, 'ce_loss_with_sae': 3.4123308658599854, 'ce_loss_without_sae': 3.267136812210083}, 'reconstruction_quality': {'explained_variance': 0.13337184488773346, 'mse': 23.728647232055664, 'cossim': 0.8687383532524109}, 'shrinkage': {'l2_norm_in': 46.52678298950195, 'l2_norm_out': 1.5990289449691772, 'l2_ratio': 0.031433746218681335, 'relative_reconstruction_bias': 0.04140854626893997}, 'sparsity': {'l0': 165.80137634277344, 'l1': 896.1337890625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  4.16it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.06it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.82it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.55it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.59it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.27it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.87it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.47it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.56it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.32it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 14.47it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.65it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.52it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.60it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.62it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.65it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.03it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.48it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.62it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 20.66it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.34it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.56it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.84it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.98it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.31it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.96it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 18.32it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.36it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.18it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.48it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.64it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.32it/s][A
                                                               [A6400| auxiliary_reconstruction_loss: 278.96542 | l1_loss: 234.02917 | mse_loss: 7.54825:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 3225600/4096000 [14:18<02:53, 5009.23it/s]6400| auxiliary_reconstruction_loss: 278.96542 | l1_loss: 234.02917 | mse_loss: 7.54825:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 3276800/4096000 [14:18<02:47, 4882.48it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 24.59it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  4.84it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.39it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.62it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.61it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.65it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:01,  2.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00,  9.46it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 20.35it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.37it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.52it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.17it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.51it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.12it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.31it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.64it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.44it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.32it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.64it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.43it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.64it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 14.47it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 19.55it/s][A
                                                               [A6400| auxiliary_reconstruction_loss: 278.96542 | l1_loss: 234.02917 | mse_loss: 7.54825:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 3276800/4096000 [14:29<02:47, 4882.48it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9767533878280806, 'ce_loss_with_ablation': 8.657638549804688, 'ce_loss_with_sae': 3.7067413330078125, 'ce_loss_without_sae': 3.5889105796813965}, 'reconstruction_quality': {'explained_variance': 0.11536865681409836, 'mse': 21.867902755737305, 'cossim': 0.8809278607368469}, 'shrinkage': {'l2_norm_in': 44.62173843383789, 'l2_norm_out': 1.5496810674667358, 'l2_ratio': 0.03201630339026451, 'relative_reconstruction_bias': 0.0413362942636013}, 'sparsity': {'l0': 139.4443359375, 'l1': 827.9547119140625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.40it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:02,  1.12it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  4.42it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 13.08it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.52it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.70it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 10.98it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.23it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.48it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.49it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.86it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.67it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 18.04it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.99it/s][A
                                                               [A6500| auxiliary_reconstruction_loss: 311.34888 | l1_loss: 214.76718 | mse_loss: 8.58385:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 3276800/4096000 [14:38<02:47, 4882.48it/s]6500| auxiliary_reconstruction_loss: 311.34888 | l1_loss: 214.76718 | mse_loss: 8.58385:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 3328000/4096000 [14:38<03:19, 3847.73it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.49it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.70it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.67it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.36it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 16.60it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.63it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.49it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.01it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.02it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.33it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.40it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.29it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.88it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.95it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.57it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.65it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.35it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.29it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.64it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.55it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.45it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.53it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.64it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 36.07it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.34it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.60it/s][A
                                                               [A6500| auxiliary_reconstruction_loss: 311.34888 | l1_loss: 214.76718 | mse_loss: 8.58385:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 3328000/4096000 [14:49<03:19, 3847.73it/s]6600| auxiliary_reconstruction_loss: 308.07901 | l1_loss: 270.01010 | mse_loss: 7.40745:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 3328000/4096000 [14:51<03:19, 3847.73it/s]6600| auxiliary_reconstruction_loss: 308.07901 | l1_loss: 270.01010 | mse_loss: 7.40745:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 3379200/4096000 [14:51<03:05, 3855.33it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9777077021734205, 'ce_loss_with_ablation': 8.144485473632812, 'ce_loss_with_sae': 3.4084198474884033, 'ce_loss_without_sae': 3.3004348278045654}, 'reconstruction_quality': {'explained_variance': 0.10457298904657364, 'mse': 21.06638526916504, 'cossim': 0.8532950282096863}, 'shrinkage': {'l2_norm_in': 44.21681594848633, 'l2_norm_out': 1.475580096244812, 'l2_ratio': 0.03041933849453926, 'relative_reconstruction_bias': 0.04126226529479027}, 'sparsity': {'l0': 165.5447235107422, 'l1': 801.4625244140625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.35it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.07it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.27it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.47it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.14it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.84it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.91it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.89it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.90it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.63it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.26it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 18.29it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.83it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.49it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.61it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.58it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.36it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.82it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.13it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.23it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.49it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.65it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.19it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.16it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.30it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.06it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.22it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.45it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.55it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 29.49it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A6700| auxiliary_reconstruction_loss: 269.02594 | l1_loss: 217.04202 | mse_loss: 7.41822:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 3379200/4096000 [15:03<03:05, 3855.33it/s]6700| auxiliary_reconstruction_loss: 269.02594 | l1_loss: 217.04202 | mse_loss: 7.41822:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 3430400/4096000 [15:03<02:46, 4007.17it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.64it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.62it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.58it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 38.35it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [Asae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9569098817324099, 'ce_loss_with_ablation': 8.455536842346191, 'ce_loss_with_sae': 3.664180040359497, 'ce_loss_without_sae': 3.448422908782959}, 'reconstruction_quality': {'explained_variance': 0.13070671260356903, 'mse': 23.103256225585938, 'cossim': 0.8820085525512695}, 'shrinkage': {'l2_norm_in': 45.55447006225586, 'l2_norm_out': 1.5888738632202148, 'l2_ratio': 0.032227613031864166, 'relative_reconstruction_bias': 0.04136389121413231}, 'sparsity': {'l0': 152.0349578857422, 'l1': 866.6275634765625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.10it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.33it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.15it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.83it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.89it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.41it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.45it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.70it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.01it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.47it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.01it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.84it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.88it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.60it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.23it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.87it/s][A
                                                               [A6800| auxiliary_reconstruction_loss: 264.83148 | l1_loss: 283.37961 | mse_loss: 5.63018:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 3430400/4096000 [15:16<02:46, 4007.17it/s]6800| auxiliary_reconstruction_loss: 264.83148 | l1_loss: 283.37961 | mse_loss: 5.63018:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 3481600/4096000 [15:16<02:34, 3971.95it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.25it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.52it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.49it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.88it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.23it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.47it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.67it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.45it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.91it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.88it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 36.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.61it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.64it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.93it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.89it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.82it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 36.21it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A6800| auxiliary_reconstruction_loss: 264.83148 | l1_loss: 283.37961 | mse_loss: 5.63018:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 3481600/4096000 [15:29<02:34, 3971.95it/s]6900| auxiliary_reconstruction_loss: 264.70850 | l1_loss: 197.33565 | mse_loss: 7.94577:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 3481600/4096000 [15:29<02:34, 3971.95it/s]6900| auxiliary_reconstruction_loss: 264.70850 | l1_loss: 197.33565 | mse_loss: 7.94577:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 3532800/4096000 [15:29<02:22, 3949.91it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9571760549960626, 'ce_loss_with_ablation': 8.455536842346191, 'ce_loss_with_sae': 3.6628472805023193, 'ce_loss_without_sae': 3.448422908782959}, 'reconstruction_quality': {'explained_variance': 0.13077209889888763, 'mse': 23.100627899169922, 'cossim': 0.8823164105415344}, 'shrinkage': {'l2_norm_in': 45.55447006225586, 'l2_norm_out': 1.590733528137207, 'l2_ratio': 0.032259728759527206, 'relative_reconstruction_bias': 0.041417982429265976}, 'sparsity': {'l0': 152.3035125732422, 'l1': 866.8837890625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.94it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.63it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.35it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.84it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.82it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.26it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.46it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.04it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.84it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.59it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.32it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.41it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.45it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.94it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.22it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.52it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.07it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.53it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.37it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 25.32it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.84it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.23it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.83it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.90it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.47it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.64it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.56it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 33.86it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.70it/s][A
                                                               [A7000| auxiliary_reconstruction_loss: 329.97522 | l1_loss: 246.79077 | mse_loss: 8.19941:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 3532800/4096000 [15:39<02:22, 3949.91it/s]7000| auxiliary_reconstruction_loss: 329.97522 | l1_loss: 246.79077 | mse_loss: 8.19941:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 3584000/4096000 [15:39<02:00, 4255.64it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 36.19it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.61it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 17.55it/s][A
                                                               [Asae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9627750897345521, 'ce_loss_with_ablation': 8.56460952758789, 'ce_loss_with_sae': 3.696235179901123, 'ce_loss_without_sae': 3.5080034732818604}, 'reconstruction_quality': {'explained_variance': 0.1373426914215088, 'mse': 23.97272300720215, 'cossim': 0.8768033981323242}, 'shrinkage': {'l2_norm_in': 46.43986129760742, 'l2_norm_out': 1.6143516302108765, 'l2_ratio': 0.03195934370160103, 'relative_reconstruction_bias': 0.04138807952404022}, 'sparsity': {'l0': 154.02989196777344, 'l1': 892.7604370117188}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.48it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 14.38it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.57it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.54it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.58it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.40it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.82it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.66it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.54it/s][A7000| auxiliary_reconstruction_loss: 329.97522 | l1_loss: 246.79077 | mse_loss: 8.19941:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 3584000/4096000 [15:50<02:00, 4255.64it/s]
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.55it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.20it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.70it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.19it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.20it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.01it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.65it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.49it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.36it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.91it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.13it/s][A
                                                               [A7100| auxiliary_reconstruction_loss: 294.39703 | l1_loss: 224.73167 | mse_loss: 8.25671:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 3584000/4096000 [15:53<02:00, 4255.64it/s]7100| auxiliary_reconstruction_loss: 294.39703 | l1_loss: 224.73167 | mse_loss: 8.25671:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 3635200/4096000 [15:53<01:54, 4024.65it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 25.24it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.65it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 18.04it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.06it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.42it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.50it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  4.13it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.93it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.24it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.48it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 25.38it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.58it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.92it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.27it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.47it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.12it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.18it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.90it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.06it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.63it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.70it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.66it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.95it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.28it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  9.05it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 17.86it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.59it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.99it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.54it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.70it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.02it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.48it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.11it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.86it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.79it/s][A
                                                               [A7100| auxiliary_reconstruction_loss: 294.39703 | l1_loss: 224.73167 | mse_loss: 8.25671:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 3635200/4096000 [16:09<01:54, 4024.65it/s]7200| auxiliary_reconstruction_loss: 298.28519 | l1_loss: 244.36331 | mse_loss: 7.61384:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 3635200/4096000 [16:10<01:54, 4024.65it/s]7200| auxiliary_reconstruction_loss: 298.28519 | l1_loss: 244.36331 | mse_loss: 7.61384:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 3686400/4096000 [16:10<01:50, 3696.63it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9630312552586897, 'ce_loss_with_ablation': 8.56460952758789, 'ce_loss_with_sae': 3.6949398517608643, 'ce_loss_without_sae': 3.5080034732818604}, 'reconstruction_quality': {'explained_variance': 0.13739578425884247, 'mse': 23.97328758239746, 'cossim': 0.8770999908447266}, 'shrinkage': {'l2_norm_in': 46.43986129760742, 'l2_norm_out': 1.6149696111679077, 'l2_ratio': 0.03198431059718132, 'relative_reconstruction_bias': 0.041374653577804565}, 'sparsity': {'l0': 153.35781860351562, 'l1': 892.1959228515625}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.78it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 37.38it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.82it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.83it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.84it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.21it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  4.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 13.12it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.65it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.29it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.66it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.07it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.37it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.37it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 20.12it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.01it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.34it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.65it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.31it/s][A
                                                               [A7300| auxiliary_reconstruction_loss: 302.60104 | l1_loss: 233.69743 | mse_loss: 7.87536:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 3686400/4096000 [16:17<01:50, 3696.63it/s]7300| auxiliary_reconstruction_loss: 302.60104 | l1_loss: 233.69743 | mse_loss: 7.87536:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 3737600/4096000 [16:17<01:24, 4247.68it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 24.01it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.82it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.27it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.70it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.98it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.70it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.89it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.66it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.59it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 25.67it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 14.49it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.00it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.39it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.63it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.14it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.10it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.65it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.75it/s][A
                                                               [A7300| auxiliary_reconstruction_loss: 302.60104 | l1_loss: 233.69743 | mse_loss: 7.87536:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 3737600/4096000 [16:29<01:24, 4247.68it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9736066407993667, 'ce_loss_with_ablation': 8.493475914001465, 'ce_loss_with_sae': 3.4050774574279785, 'ce_loss_without_sae': 3.267136812210083}, 'reconstruction_quality': {'explained_variance': 0.13387466967105865, 'mse': 23.728471755981445, 'cossim': 0.8718973398208618}, 'shrinkage': {'l2_norm_in': 46.52678298950195, 'l2_norm_out': 1.606177568435669, 'l2_ratio': 0.031660180538892746, 'relative_reconstruction_bias': 0.04138846695423126}, 'sparsity': {'l0': 160.517578125, 'l1': 890.9060668945312}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.31it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.42it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.82it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.86it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.13it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.41it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.86it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.37it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  8.25it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 17.40it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 18.18it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00,  9.21it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.92it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.64it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.48it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.61it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.02it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.72it/s][A
                                                               [A7400| auxiliary_reconstruction_loss: 287.74371 | l1_loss: 235.26297 | mse_loss: 7.87150:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 3737600/4096000 [16:34<01:24, 4247.68it/s]7400| auxiliary_reconstruction_loss: 287.74371 | l1_loss: 235.26297 | mse_loss: 7.87150:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 3788800/4096000 [16:34<01:21, 3789.19it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.32it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.56it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 17.43it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.00it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.88it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.19it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 14.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.71it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.19it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.90it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.88it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.97it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.78it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.67it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.53it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 17.21it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 18.58it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.26it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.12it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.18it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.96it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.17it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.91it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.44it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.01it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.50it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.30it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.50it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.56it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.04it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.11it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.31it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.99it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.61it/s][A
                                                               [A7400| auxiliary_reconstruction_loss: 287.74371 | l1_loss: 235.26297 | mse_loss: 7.87150:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 3788800/4096000 [16:49<01:21, 3789.19it/s]7500| auxiliary_reconstruction_loss: 325.44235 | l1_loss: 255.60883 | mse_loss: 8.05099:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 3788800/4096000 [16:51<01:21, 3789.19it/s]7500| auxiliary_reconstruction_loss: 325.44235 | l1_loss: 255.60883 | mse_loss: 8.05099:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 3840000/4096000 [16:51<01:11, 3575.74it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9737101039170233, 'ce_loss_with_ablation': 8.493475914001465, 'ce_loss_with_sae': 3.404536724090576, 'ce_loss_without_sae': 3.267136812210083}, 'reconstruction_quality': {'explained_variance': 0.13392996788024902, 'mse': 23.728334426879883, 'cossim': 0.872180163860321}, 'shrinkage': {'l2_norm_in': 46.52678298950195, 'l2_norm_out': 1.607115387916565, 'l2_ratio': 0.03168722987174988, 'relative_reconstruction_bias': 0.04138939455151558}, 'sparsity': {'l0': 160.58828735351562, 'l1': 890.6146850585938}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 19.93it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.72it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.58it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.63it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.49it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.34it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.82it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.55it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.68it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.91it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.26it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 14.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.87it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.55it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.05it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.36it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.61it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.57it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.92it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.84it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.53it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.96it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.73it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.93it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.89it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.95it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.00it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.53it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.82it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.00it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.12it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.37it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.63it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.37it/s][A
                                                               [A7600| auxiliary_reconstruction_loss: 259.65302 | l1_loss: 247.80901 | mse_loss: 6.77854:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 3840000/4096000 [17:02<01:11, 3575.74it/s]7600| auxiliary_reconstruction_loss: 259.65302 | l1_loss: 247.80901 | mse_loss: 6.77854:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 3891200/4096000 [17:02<00:53, 3807.08it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.67it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.21it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.93it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.33it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.63it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.81it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 13.92it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.88it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.08it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.64it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.11it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.70it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.21it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.86it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.57it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.86it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.92it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.01it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.55it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.12it/s][A
                                                               [Asae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9778393818263269, 'ce_loss_with_ablation': 8.657638549804688, 'ce_loss_with_sae': 3.7012367248535156, 'ce_loss_without_sae': 3.5889105796813965}, 'reconstruction_quality': {'explained_variance': 0.11589781194925308, 'mse': 21.867115020751953, 'cossim': 0.883802056312561}, 'shrinkage': {'l2_norm_in': 44.62173843383789, 'l2_norm_out': 1.5573205947875977, 'l2_ratio': 0.032256629317998886, 'relative_reconstruction_bias': 0.04133104160428047}, 'sparsity': {'l0': 135.7236328125, 'l1': 823.0050048828125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.53it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.22it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.77it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.58it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.03it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.67it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.49it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.79it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.09it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 24.42it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.85it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.92it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.19it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A7600| auxiliary_reconstruction_loss: 259.65302 | l1_loss: 247.80901 | mse_loss: 6.77854:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 3891200/4096000 [17:19<00:53, 3807.08it/s]
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:01,  2.28it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00,  8.52it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 22.05it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.48it/s][A
                                                               [A7700| auxiliary_reconstruction_loss: 309.77939 | l1_loss: 261.30017 | mse_loss: 7.42419:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 3891200/4096000 [17:20<00:53, 3807.08it/s]7700| auxiliary_reconstruction_loss: 309.77939 | l1_loss: 261.30017 | mse_loss: 7.42419:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 3942400/4096000 [17:20<00:44, 3448.68it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 23.51it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.08it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.89it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  6.41it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 15.89it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.80it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.88it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.76it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.82it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.82it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 16.62it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.92it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.69it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.89it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.63it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.08it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.74it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.19it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 21.88it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.56it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.70it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.99it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.68it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 11.61it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.75it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:00<00:00, 15.49it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 20.40it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.83it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 12.04it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  3.67it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.92it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.86it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.82it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 37.49it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A7800| auxiliary_reconstruction_loss: 289.61798 | l1_loss: 250.36293 | mse_loss: 7.30864:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 3942400/4096000 [17:33<00:44, 3448.68it/s]7800| auxiliary_reconstruction_loss: 289.61798 | l1_loss: 250.36293 | mse_loss: 7.30864:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 3993600/4096000 [17:33<00:28, 3623.90it/s]sae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.978569179621764, 'ce_loss_with_ablation': 8.144485473632812, 'ce_loss_with_sae': 3.4042468070983887, 'ce_loss_without_sae': 3.3004348278045654}, 'reconstruction_quality': {'explained_variance': 0.10508228838443756, 'mse': 21.064924240112305, 'cossim': 0.8562227487564087}, 'shrinkage': {'l2_norm_in': 44.21681594848633, 'l2_norm_out': 1.4832342863082886, 'l2_ratio': 0.030651668086647987, 'relative_reconstruction_bias': 0.04127270728349686}, 'sparsity': {'l0': 161.4972686767578, 'l1': 797.126220703125}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 38.18it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.85it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.82it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 27.29it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 34.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.61it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.83it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 36.26it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.74it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.77it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 26.98it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 38.26it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A7900| auxiliary_reconstruction_loss: 269.95831 | l1_loss: 247.50009 | mse_loss: 7.08049:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 3993600/4096000 [17:38<00:28, 3623.90it/s]7900| auxiliary_reconstruction_loss: 269.95831 | l1_loss: 247.50009 | mse_loss: 7.08049:  99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 4044800/4096000 [17:38<00:11, 4413.29it/s]
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.71it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.72it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.85it/s][A
                                                               [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 28.30it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.73it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.78it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.79it/s][A
                                                               [Asae_trainer.py:348 {'model_performance_preservation': {'ce_loss_score': 0.9586072957758256, 'ce_loss_with_ablation': 8.455536842346191, 'ce_loss_with_sae': 3.6556808948516846, 'ce_loss_without_sae': 3.448422908782959}, 'reconstruction_quality': {'explained_variance': 0.1311298906803131, 'mse': 23.100770950317383, 'cossim': 0.8843545913696289}, 'shrinkage': {'l2_norm_in': 45.55447006225586, 'l2_norm_out': 1.595664381980896, 'l2_ratio': 0.03242183476686478, 'relative_reconstruction_bias': 0.04139929637312889}, 'sparsity': {'l0': 148.31582641601562, 'l1': 862.7948608398438}, 'token_stats': {'total_tokens_eval_reconstruction': 5120, 'total_tokens_eval_sparsity_variance': 5120}}

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:00<00:00, 27.23it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.47it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.69it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.81it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.03it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.65it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A/data/yusenp/NLP/KAN-LLaMA/sae_lens/training/activations_store.py:741: UserWarning: All samples in the training dataset have been exhausted, we are now beginning a new epoch with the same samples.
  warnings.warn(

Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 37.97it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
                                                       [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.75it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.76it/s][A
                                                               [A
Refilling buffer:   0%|          | 0/4 [00:00<?, ?it/s][A
Refilling buffer:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:00,  7.80it/s][A
                                                               [A8000| auxiliary_reconstruction_loss: 245.51534 | l1_loss: 205.11539 | mse_loss: 7.19415:  99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 4044800/4096000 [17:47<00:11, 4413.29it/s]8000| auxiliary_reconstruction_loss: 245.51534 | l1_loss: 205.11539 | mse_loss: 7.19415: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4096000/4096000 [17:47<00:00, 4795.07it/s]8000| auxiliary_reconstruction_loss: 245.51534 | l1_loss: 205.11539 | mse_loss: 7.19415: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4096000/4096000 [17:48<00:00, 3832.54it/s]
wandb: uploading artifact sae_meta-llama__Llama-3.2-1B_blocks.0.hook_mlp_out_16384; uploading artifact sae_meta-llama__Llama-3.2-1B_blocks.0.hook_mlp_out_16384_log_feature_sparsity
wandb: uploading artifact sae_meta-llama__Llama-3.2-1B_blocks.0.hook_mlp_out_16384
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:       details/current_l1_coefficient ‚ñÅ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:        details/current_learning_rate ‚ñÖ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñá‚ñá‚ñá‚ñá‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÖ‚ñÖ‚ñÖ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ
wandb:            details/n_training_tokens ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà
wandb: losses/auxiliary_reconstruction_loss ‚ñà‚ñÉ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                       losses/l1_loss ‚ñà‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÉ‚ñÑ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÉ‚ñÑ‚ñÑ‚ñÖ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÉ‚ñÑ‚ñÑ
wandb:                      losses/mse_loss ‚ñà‚ñá‚ñÜ‚ñÖ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                  losses/overall_loss ‚ñà‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                   losses/raw_l1_loss ‚ñÇ‚ñÅ‚ñÉ‚ñÉ‚ñÖ‚ñÖ‚ñÇ‚ñÜ‚ñÜ‚ñá‚ñá‚ñÜ‚ñÜ‚ñá‚ñÜ‚ñá‚ñÜ‚ñá‚ñÜ‚ñá‚ñÜ‚ñá‚ñá‚ñÜ‚ñà‚ñá‚ñà‚ñà‚ñá‚ñÜ‚ñá‚ñá‚ñá‚ñà‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà
wandb:           metrics/explained_variance ‚ñÅ‚ñÇ‚ñÅ‚ñÉ‚ñÉ‚ñÖ‚ñÑ‚ñÖ‚ñÜ‚ñá‚ñÜ‚ñá‚ñá‚ñÜ‚ñá‚ñá‚ñà‚ñà‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñá‚ñá‚ñà‚ñà‚ñà‚ñá‚ñà‚ñà‚ñá
wandb:       metrics/explained_variance_std ‚ñà‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                           metrics/l0 ‚ñà‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:  metrics/mean_log10_feature_sparsity ‚ñà‚ñÉ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                  sparsity/below_1e-5 ‚ñÅ‚ñÑ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:                  sparsity/below_1e-6 ‚ñÅ‚ñÇ‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:               sparsity/dead_features ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÜ‚ñÜ‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:     sparsity/mean_passes_since_fired ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà
wandb: 
wandb: Run summary:
wandb:       details/current_l1_coefficient 5
wandb:        details/current_learning_rate 0.0
wandb:            details/n_training_tokens 4085760
wandb: losses/auxiliary_reconstruction_loss 344.32489
wandb:                       losses/l1_loss 47.97049
wandb:                      losses/mse_loss 9.23532
wandb:                  losses/overall_loss 593.41266
wandb:                   losses/raw_l1_loss 239.85246
wandb:           metrics/explained_variance 0.73521
wandb:       metrics/explained_variance_std 0.18356
wandb:                           metrics/l0 175.04688
wandb:  metrics/mean_log10_feature_sparsity -4.07736
wandb:                  sparsity/below_1e-5 4117
wandb:                  sparsity/below_1e-6 4101
wandb:               sparsity/dead_features 4101
wandb:     sparsity/mean_passes_since_fired 1644.36243
wandb: 
wandb: üöÄ View run 16384-L1-5-LR-1e-05-Tokens-4.096e+06 at: https://wandb.ai/gulko-osu/sae_llama_3_2_1B/runs/lkwkzg4a
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/gulko-osu/sae_llama_3_2_1B
wandb: Synced 5 W&B file(s), 0 media file(s), 21 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20250327_032907-lkwkzg4a/logs
training done!
